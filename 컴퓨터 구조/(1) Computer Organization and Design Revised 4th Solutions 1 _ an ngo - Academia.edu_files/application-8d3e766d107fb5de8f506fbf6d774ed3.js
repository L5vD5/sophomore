var $r={};$r.__data={api_v0_premium_stripe_webhooks:["api",["v0","premium_stripe_webhooks"]],api_v0:["api",["v0","analytics","targeted",":action"]],api_v0_scribd_events:["api",["v0","scribd_events"]],record_invalid_extension_api_v0_attachments:["api",["v0","attachments","record_invalid_extension"]],parsed_attributes_api_v0_attachment:["api",["v0","attachments",":id","parsed_attributes"]],publishing_survey_api_v0_attachment:["api",["v0","attachments",":id","publishing_survey"]],api_v0_attachments:["api",["v0","attachments"]],api_v0_attachment:["api",["v0","attachments",":id"]],api_v0_work_authorship:["api",["v0","works",":work_id","authorship"]],api_v0_work_attachments:["api",["v0","works",":work_id","attachments"]],new_api_v0_work_attachment:["api",["v0","works",":work_id","attachments","new"]],edit_api_v0_work_attachment:["api",["v0","works",":work_id","attachments",":id","edit"]],api_v0_work_attachment:["api",["v0","works",":work_id","attachments",":id"]],api_v0_work_urls:["api",["v0","works",":work_id","urls"]],api_v0_work_url:["api",["v0","works",":work_id","urls",":id"]],api_v0_works_views:["api",["v0","works","views"]],api_v0_works_percentiles:["api",["v0","works","percentiles"]],api_v0_works_certification_counts:["api",["v0","works","certification_counts"]],set_order_api_v0_works:["api",["v0","works","set_order"]],api_v0_work_requests:["api",["v0","works",":work_id","requests"]],set_order_api_v0_work_co_author_tags:["api",["v0","works",":work_id","co_author_tags","set_order"]],api_v0_work_co_author_tags:["api",["v0","works",":work_id","co_author_tags"]],api_v0_work_co_author_tag:["api",["v0","works",":work_id","co_author_tags",":id"]],api_v0_work_research_interest_reject_suggestion:["api",["v0","works",":work_id","research_interests",":research_interest_id","reject_suggestion"]],api_v0_work_classification:["api",["v0","works",":work_id","classification"]],other_works_by_author_api_v0_work_related_works:["api",["v0","works",":work_id","related_works","other_works_by_author"]],related_works_api_v0_work_related_works:["api",["v0","works",":work_id","related_works","related_works"]],api_v0_work_related_works:["api",["v0","works",":work_id","related_works"]],validate_url_api_v0_works:["api",["v0","works","validate_url"]],should_display_captcha_api_v0_works:["api",["v0","works","should_display_captcha"]],verify_captcha_response_api_v0_works:["api",["v0","works","verify_captcha_response"]],html_api_v0_work:["api",["v0","works",":id","html"]],academia_select_answer_api_v0_work:["api",["v0","works",":id","academia_select_answer"]],academia_select_charge_api_v0_work:["api",["v0","works",":id","academia_select_charge"]],api_v0_works:["api",["v0","works"]],new_api_v0_work:["api",["v0","works","new"]],edit_api_v0_work:["api",["v0","works",":id","edit"]],api_v0_work:["api",["v0","works",":id"]],validate_api_v0_sections:["api",["v0","sections","validate"]],set_order_api_v0_sections:["api",["v0","sections","set_order"]],api_v0_section:["api",["v0","sections",":id"]],count_api_v0_interest_followers:["api",["v0","interests",":interest_id","followers","count"]],api_v0_interest_followers:["api",["v0","interests",":interest_id","followers"]],count_api_v0_interest_works:["api",["v0","interests",":interest_id","works","count"]],api_v0_interest_works:["api",["v0","interests",":interest_id","works"]],api_v0_user_details:["api",["v0","users",":user_id","details"]],api_v0_user_followers:["api",["v0","users",":user_id","followers"]],api_v0_user_following_index:["api",["v0","users",":user_id","following"]],set_api_v0_user_preferences:["api",["v0","users",":user_id","preferences","set"]],api_v0_user_preferences:["api",["v0","users",":user_id","preferences"]],api_v0_user_coauthors:["api",["v0","users",":user_id","coauthors"]],api_v0_user_blocks:["api",["v0","users",":user_id","blocks"]],api_v0_user_requests:["api",["v0","users",":user_id","requests"]],api_v0_user_social_profiles:["api",["v0","users",":user_id","social_profiles"]],new_api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles","new"]],edit_api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles",":id","edit"]],api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles",":id"]],hits_api_v0_user_stats:["api",["v0","users",":user_id","stats","hits"]],downloads_api_v0_user_stats:["api",["v0","users",":user_id","stats","downloads"]],read_events_api_v0_user_stats:["api",["v0","users",":user_id","stats","read_events"]],unread_reader_message_count_api_v0_user_stats:["api",["v0","users",":user_id","stats","unread_reader_message_count"]],freebie_message_api_v0_user_stats:["api",["v0","users",":user_id","stats","freebie_message"]],freebie_read_events_api_v0_user_stats:["api",["v0","users",":user_id","stats","freebie_read_events"]],new_freebie_endpoint_api_v0_user_stats:["api",["v0","users",":user_id","stats","new_freebie_endpoint"]],unread_read_event_count_api_v0_user_stats:["api",["v0","users",":user_id","stats","unread_read_event_count"]],works_api_v0_user_stats:["api",["v0","users",":user_id","stats","works"]],thirty_day_percentiles_api_v0_user_stats:["api",["v0","users",":user_id","stats","thirty_day_percentiles"]],all_time_hits_by_country_api_v0_user_stats:["api",["v0","users",":user_id","stats","all_time_hits_by_country"]],all_time_referer_hit_counts_api_v0_user_stats:["api",["v0","users",":user_id","stats","all_time_referer_hit_counts"]],reader_research_interests_api_v0_user_stats:["api",["v0","users",":user_id","stats","reader_research_interests"]],api_v0_user_stats:["api",["v0","users",":user_id","stats"]],count_api_v0_user_works:["api",["v0","users",":user_id","works","count"]],api_v0_user_works:["api",["v0","users",":user_id","works"]],api_v0_user:["api",["v0","user"]],api_v0_discussion_invitees_with_brain_trust:["api",["v0","discussion_invitees_with_brain_trust"]],api_v0_is_discussion_promotion_qualified:["api",["v0","is_discussion_promotion_qualified"]],api_v0_facebook_contacts_fresh:["api",["v0","facebook_contacts_fresh"]],api_v0_twitter_contacts_fresh:["api",["v0","twitter_contacts_fresh"]],api_v0_imported_google_contacts:["api",["v0","imported_google_contacts"]],invite_users_api_v0_discussion:["api",["v0","discussions",":id","invite_users"]],nag_for_first_comment_api_v0_discussion:["api",["v0","discussions",":id","nag_for_first_comment"]],pending_participants_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","pending_participants"]],leave_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","leave"]],approve_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","approve"]],reject_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","reject"]],block_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","block"]],api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations"]],like_api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id","like"]],unlike_api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id","unlike"]],delete_for_user_api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id","delete_for_user"]],api_v0_discussion_discussion_comments:["api",["v0","discussions",":discussion_id","discussion_comments"]],api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id"]],api_v0_discussions:["api",["v0","discussions"]],api_v0_discussion:["api",["v0","discussions",":id"]],api_v0_certifications_certifications:["api",["v0","certifications","certifications"]],api_v0_certifications_certification:["api",["v0","certifications","certifications",":id"]],api_v0_certifications_work_certifications:["api",["v0","certifications","work_certifications"]],api_v0_certifications_certifier_nominations:["api",["v0","certifications","certifier_nominations"]],api_v0_certifications_ranks_author_rank:["api",["v0","certifications","ranks","author_ranks",":id"]],api_v0_certifications_ranks_paper_ranks:["api",["v0","certifications","ranks","paper_ranks"]],api_v0_certifications_ranks_paper_rank:["api",["v0","certifications","ranks","paper_ranks",":id"]],api_v0_premium_premium_status_index:["api",["v0","premium","premium_status"]],api_v0_premium_premium_status:["api",["v0","premium","premium_status",":id"]],api_v0_premium_waitlist_entries:["api",["v0","premium","waitlist_entries"]],unread_count_api_v0_notifications:["api",["v0","notifications","unread_count"]],mark_read_api_v0_notifications:["api",["v0","notifications","mark_read"]],mark_analytics_read_api_v0_notifications:["api",["v0","notifications","mark_analytics_read"]],api_v0_notifications:["api",["v0","notifications"]],api_v0_profiles_works:["api",["v0","profiles","works"]],api_v0_profiles_user_relation_index:["api",["v0","profiles","user_relation"]],api_v0_profiles_user_relation_stats:["api",["v0","profiles","user_relation_stats"]],api_v0_profiles_get_name:["api",["v0","profiles","get_name"]],api_v0_profiles_update_name:["api",["v0","profiles","update_name"]],api_v0_profiles_get_affiliations:["api",["v0","profiles","get_affiliations"]],api_v0_profiles_get_sections:["api",["v0","profiles","get_sections"]],api_v0_profiles_get_biography:["api",["v0","profiles","get_biography"]],api_v0_profiles_update_about:["api",["v0","profiles","update_about"]],api_v0_profiles_update_supervisors:["api",["v0","profiles","update_supervisors"]],api_v0_profiles_upload_bibtex:["api",["v0","profiles","upload_bibtex"]],add_api_v0_taggings:["api",["v0","taggings","add"]],remove_api_v0_taggings:["api",["v0","taggings","remove"]],set_order_api_v0_taggings:["api",["v0","taggings","set_order"]],api_v0_taggings:["api",["v0","taggings"]],api_v0_suggestions_following_index:["api",["v0","suggestions","following"]],api_v0_suggestions_following:["api",["v0","suggestions","following",":id"]],api_v0_suggestions_interests:["api",["v0","suggestions","interests"]],api_v0_suggestions_interest:["api",["v0","suggestions","interests",":id"]],api_v0_suggestions_certifications:["api",["v0","suggestions","certifications"]],api_v0_suggestions_certification:["api",["v0","suggestions","certifications",":id"]],api_v0_suggestions_histories:["api",["v0","suggestions","histories"]],by_works_api_v0_suggestions_coauthors:["api",["v0","suggestions","coauthors","by_works"]],batch_create_api_v0_suggestions_coauthors:["api",["v0","suggestions","coauthors","batch_create"]],api_v0_suggestions_coauthors:["api",["v0","suggestions","coauthors"]],api_v0_suggestions_coauthor:["api",["v0","suggestions","coauthors",":id"]],api_v0_suggestions_discussions:["api",["v0","suggestions","discussions"]],clusters_api_v0_suggestions_works:["api",["v0","suggestions","works","clusters"]],by_coauthor_api_v0_suggestions_works:["api",["v0","suggestions","works","by_coauthor"]],trending_api_v0_suggestions_works:["api",["v0","suggestions","works","trending"]],api_v0_suggestions_works:["api",["v0","suggestions","works"]],randomized_last_api_v0_suggestions_jobs:["api",["v0","suggestions","jobs","randomized_last"]],api_v0_suggestions_jobs:["api",["v0","suggestions","jobs"]],api_v0_suggestions_affiliation:["api",["v0","suggestions","affiliation"]],api_v0_paper_claims:["api",["v0","paper_claims"]],api_v0_registration_followees:["api",["v0","registration","followees"]],api_v0_registration_interests:["api",["v0","registration","interests"]],api_v0_registration_colleagues:["api",["v0","registration","colleagues"]],api_v0_search_advanced:["api",["v0","search","advanced"]],recipient_api_v0_messages:["api",["v0","messages","recipient"]],api_v0_messages:["api",["v0","messages"]],api_v0_active_support_notifications:["api",["v0","server_notifications"]],api_v0_feature_flags:["api",["v0","feature_flags"]],find_api_v0_bookmarks:["api",["v0","bookmarks","find"]],api_v0_bookmarks:["api",["v0","bookmarks"]],api_v0_bookmark:["api",["v0","bookmarks",":id"]],api_v0_news_index:["api",["v0","news"]],api_v0_social_distance:["api",["v0","social_distance"]],record_view_api_v0_sales:["api",["v0","sales","record_view"]],record_click_api_v0_sales:["api",["v0","sales","record_click"]],api_v0_sales:["api",["v0","sales"]],api_v0_set_password:["api",["v0","set_password"]],api_v0_reader_message_like_message:["api",["v0","reader_messages",":reader_message_id","like_message"]],mark_all_as_read_api_v0_reader_messages:["api",["v0","reader_messages","mark_all_as_read"]],api_v0_reader_messages:["api",["v0","reader_messages"]],api_v0_mark_read_events_as_read:["api",["v0","mark_read_events_as_read"]],api_v0_tasks:["api",["v0","tasks"]],v0_update_affiliation:["www",["profiles","v0","update_affiliation"]],v0_delete_affiliation:["www",["profiles","v0","delete_affiliation"]],record_split:["www",["record_split"]],finish_split:["www",["finish_split"]],notifications:["www",["Notifications"]],Papers_Upload:["www",["Papers","Upload"]],Papers_Upload_Multi:["www",["Papers","Upload","Multi"]],unflag_user_reports:["www",["reports","unflag_user"]],auto_classify_user_reports:["www",["reports","auto_classify_user"]],extra_data_reports:["www",["reports","extra_data"]],reports:["www",["reports"]],partial_create_registrations:["www",["registrations","partial_create"]],registrations:["www",["registrations"]],registration_path_coauthor_single_page:["www",["AcceptCoauthorTag"]],registration_path_oauth_authorize:["www",["Email"]],registration_path_oauth_callback:["www",["OAuthCallback"]],friend_finder_google:["www",["FriendFinder","Google"]],friend_finder_google_contacts:["www",["FriendFinder","GoogleContacts"]],friend_finder_google_connect:["www",["FriendFinder","GoogleConnect"]],friend_finder_google_select_whom_to_follow:["www",["FriendFinder","Google","Follow"]],friend_finder_google_select_whom_to_follow_post:["www",["FriendFinder","Google","Follow"]],friend_finder_facebook:["www",["FriendFinder","Facebook"]],friend_finder_facebook_contacts:["www",["FriendFinder","FacebookContacts"]],friend_finder_twitter:["www",["FriendFinder","Twitter"]],friend_finder_twitter_contacts:["www",["FriendFinder","TwitterContacts"]],friend_finder_twitter_connect_successful:["www",["FriendFinder","TwitterConnectSuccess"]],friend_finder_connect:["www",["FriendFinder","Connect"]],friend_finder_yahoo:["www",["FriendFinder","Yahoo"]],friend_finder_Yahoo:["www",["FriendFinder","Yahoo"]],friend_finder_oauth_callback:["www",["FriendFinder","OAuthCallback"]],friend_finder_yahoo_select_whom_to_follow:["www",["FriendFinder","Yahoo","Follow"]],friend_finder_Yahoo_Follow:["www",["FriendFinder","Yahoo","Follow"]],friend_finder_index:["www",["FriendFinder"]],upgrade:["www",["upgrade"]],jobs:["www",["Jobs"]],new_job:["www",["Jobs","new"]],readers:["www",["readers"]],attachment_csv_preview:["www",["attachments",":attachment_id","csv_preview"]],edit_certifications_permissions:["www",["recommendations","eligibility"]],certifications_permissions:["www",["recommendations","permissions"]],certifications_manual_curation:["www",["recommendations","manual_curation"]],certifications_suggestions:["www",["recommendations","suggestions"]],certifications:["www",["recommendations","suggestions",":id"]],certifications_nominations:["www",["recommendations","nominations"]],analytics_csv:["www",[":page_name","Analytics","csv"]],generate_new_csv:["www",[":page_name","Analytics","csv"]],download_csv:["www",[":page_name","Analytics","csv","download",":analytics_csv_export_id"]],last_n_day_analytics:["www",[":page_name","Analytics","LastDays"]],analytics_dashboard:["www",[":page_name","Analytics"]],sidebar_new_profile_activity:["www",[":page_name","Activity","sidebar"]],new_profile_activity:["www",[":page_name","Activity"]],email_new_profile_contact_details:["www",[":page_name","contact_details","email"]],new_profile_curriculum_vitae:["www",[":page_name","CurriculumVitae"]],new_profile_profile_picture:["www",[":page_name","ProfilePicture"]],new_profile_supervisors:["www",[":page_name","supervisors"]],bio_new_profile_about_box:["www",[":page_name","about_box","bio"]],supervisors_new_profile_about_box:["www",[":page_name","about_box","supervisors"]],new_profile_post_edit:["www",[":page_name","Posts",":post_id","edit"]],show_new_profile_post:["www",[":page_name","Posts",":id"]],new_profile_posts:["www",[":page_name","Posts"]],new_new_profile_post:["www",[":page_name","Posts","new"]],new_profile_post:["www",[":page_name","Posts",":id"]],new_profile_followers:["www",[":page_name","Followers"]],new_profile_following:["www",[":page_name","Following"]],new_profile_coauthors:["www",[":page_name","Coauthors"]],update_affiliation_new_profile:["www",[":page_name","update_affiliation"]],delete_affiliation_new_profile:["www",[":page_name","delete_affiliation"]],np_blog_post_post_redirect_new_profile:["www",[":page_name","Blog",":id",":slug"]],np_blog_post_no_slug_post_redirect_new_profile:["www",[":page_name","Blog",":id"]],status_updates_slug_post_redirect_new_profile:["www",[":page_name","StatusUpdates",":id",":slug"]],books_works_redirect_new_profile:["www",[":page_name","Books",":id"]],papers_works_redirect_new_profile:["www",[":page_name","Papers",":id"]],talks_works_redirect_new_profile:["www",[":page_name","Talks",":id"]],teachings_works_redirect_new_profile:["www",[":page_name","Teaching",":id"]],new_profile_works:["www",[":page_name",":section_name"]],new_profile:["www",[":page_name"]]},$r.__absolute=function(e,t){var n,t=t||{},i=this.__data[e][0],o=t.subdomain||i;return delete t.subdomain,n=this.__relative(e,t),t.host?"//"+t.host+n:"//"+o+"."+$app_host+n},$r.__relative=function(e,t){var n,i=this.__data[e][1],t=t||{},o=[],r=[],s="/";return $.each(i,function(n,i){var r;if(0==i.indexOf(":")){if(r=i.slice(1),!t[r])throw new Error("Failed to provide component "+i+" for "+e+"!");o.push(t[r]),delete t[r]}else o.push(i)}),o.length>0&&(s+=o.join("/")),t.format&&(s=s+"."+t.format,delete t.format),t.anchor&&(n=t.anchor,delete t.anchor),$.each(t,function(e,t){r.push(e+"="+t)}),r.length>0&&(s=s+"?"+r.join("&")),n&&(s=s+"#"+n),s},$.each($r.__data,function(e){$r[e+"_url"]=function(t){return $r.__absolute(e,t)},$r[e+"_path"]=function(t){return $r.__relative(e,t)}}),function(){var e,t,n,i;window.$h||(window.$h={}),window.$h.commaizeInt=function(e){var t;return null==e?e:(t=e.toString().split("."),t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join("."))},window.$h.numberAndNoun=function(e,t){return $h.commaizeInt(e)+" "+$h.pluralize(e,t)},window.$h.aOrNumberAndNoun=function(e,t){var n;return n=$h.pluralize(e,t),1===e?$h.aOrAn(t)+" "+n:$h.commaizeInt(e)+" "+n},t=[[/(s)yllabi$/i,"$1yllabi"],[/(s)yllabus$/i,"$1yllabi"],[/(z)ombies$/i,"$1ombies"],[/(z)ombie$/i,"$1ombies"],[/(m)oves$/i,"$1oves"],[/(m)ove$/i,"$1oves"],[/(s)exes$/i,"$1exes"],[/(s)ex$/i,"$1exes"],[/(c)hildren$/i,"$1hildren"],[/(c)hild$/i,"$1hildren"],[/(m)en$/i,"$1en"],[/(m)an$/i,"$1en"],[/(p)eople$/i,"$1eople"],[/(p)erson$/i,"$1eople"],[/(quiz)$/i,"$1zes"],[/^(oxen)$/i,"$1"],[/^(ox)$/i,"$1en"],[/^(m|l)ice$/i,"$1ice"],[/^(m|l)ouse$/i,"$1ice"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1\\2ves"],[/sis$/i,"ses"],[/([ti])a$/i,"$1a"],[/([ti])um$/i,"$1a"],[/(buffal|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)i$/i,"$1i"],[/(octop|vir)us$/i,"$1i"],[/^(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/,"s"]],window.$h.pluralize=function(e,n){var i,o;return i=function(e){var n,i,o,r,s,a;for(n=i=0,o=t.length;o>=0?o>=i:i>=o;n=o>=0?++i:--i)if(r=t[n],s=r[0],a=r[1],e.match(s))return e.replace(s,a);return e},o=_.isString(n)?{singular:n,plural:i(n)}:n,1===e?o.singular:o.plural},window.$h.aOrAn=function(e){return e&&"aeiouAEIOU".indexOf(e[0])>=0?"an":"a"},window.$h.format_text=function(e){return e=e.replace(/\r\n?/,"\n"),e=$.trim(e),0===e.length?e:e.replace(/\n\n+/g,"</p><p>").replace(/\n/,"<br />")},window.$h.humanFileSize=function(e,t){var n,i,o;for(null==t&&(t=0),n=1024,o=["B","KB","MB","GB"],i=0;e>=n;)e/=n,i++;return e.toFixed(t)+" "+o[i]},window.$h.isBlank=function(e){return!e||0===$.trim(e).length},n=/^[a-z0-9$!#%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9$!#%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,i=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,window.$h.validEmail=function(e,t){var o;return null==t&&(t={}),o=t.strict?i:n,!(!e||!o.test(e))},window.$h.toStrongListOfItems=function(e){var t;return t=_.map(e,function(e){return"<strong>"+String(e)+"</strong>"}),t.length>=2&&(t[t.length-1]="and "+t[t.length-1]),t.join(t.length>=3?", ":" ")},window.$h.linkify=function(e,t){var n;return null==t&&(t={}),"_blank"===t.target?(n=function(e,t){return t?'<a href="'+t+'" title="'+t+'" target="_blank">'+e+"</a>":e},window.linkify(e,{callback:n})):window.linkify(e)},window.$h.timeAgoInWords=function(e,t){return null==t&&(t={}),window.$h.distanceOfTimeInWords(new Date,e,t)},window.$h.distanceOfTimeInWords=function(e,t,n){var i,o,r,s,a,c,u,l,d,p,h,_,f,m;return null==n&&(n={}),u=60,c=24*u,l=30*c,d=365*c,h=n.shortened,s=e.getTime(),_=t.getTime(),r=Math.round(Math.abs(s-_)/1e3),o=Math.round(r/60),30>r?h?"< 1 min":"less than a minute":60>r?h?"1 min":"1 minute":45>o?(f=h?"min":"minute",$h.numberAndNoun(o,f)):c>o?(a=Math.round(o/u),f=h?"hr":"hour",$h.numberAndNoun(a,f)):l>o?(i=Math.round(o/c),$h.numberAndNoun(i,"day")):d>o?(p=Math.round(o/l),f=h?"mo":"month",$h.numberAndNoun(p,f)):(m=Math.round(o/d),f=h?"yr":"year",$h.numberAndNoun(m,f))},window.$h.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},window.$h.titleize=function(e){return _(e.split(/\s+/)).map(function(e){return window.$h.capitalize(e)}).join(" ")},e=["none","one","two","three","four","five","six","seven","eight","nine"],window.$h.numberWord=function(t){return e[t]||t}}.call(this),function(){Aedu.AttachmentUploader=function(){function e(e){null==e&&(e={}),this.options=_.extend({},this.defaultOptions(),e)}return e.prototype.upload=function(e){var t,n;return t=$.Deferred(),n=this.validateFile(e),n?_.defer(function(){return t.reject({error:n})}):this.uploadFile(e,t),t.promise()},e.prototype.uploadFile=function(e,t){var n,i;return n=new FormData,n.append("files[]",e),i=$.ajax({url:this.attachmentUrl(),data:n,processData:!1,contentType:!1,type:"POST",xhr:function(){var e;return e=new window.XMLHttpRequest,e.upload.addEventListener("progress",function(e){return e.lengthComputable?t.notify(e.loaded/e.total):void 0},!1),e}}),i.done(t.resolve),i.fail(t.reject)},e.prototype.defaultOptions=function(){return{maxSize:104857600,maxFileNameLength:125,fileTypes:["pdf","txt","ps","rtf","epub","odt","odp","ods","odg","odf","sxw","sxc","sxi","sxd","doc","ppt","pps","xls","docx","pptx","ppsx","xlsx","tif","tiff","csv","tsv"],source:"multi"}},e.prototype.attachmentUrl=function(){return $r.api_v0_attachments_path({source:this.options.source,subdomain_param:"api"})},e.prototype.validateFile=function(e){return this.validateSize(e)||this.validateType(e)||this.validateName(e)},e.prototype.validateSize=function(e){return e.size>this.options.maxSize?"size-too-large":void 0},e.prototype.validateType=function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.options.fileTypes,t)?void 0:"invalid-type"},e.prototype.validateName=function(e){return e.name.length>this.options.maxFileNameLength?"file-name-too-long":void 0},e.documentTitleFromFilename=function(e){return e=e.replace(/(\.[a-z]+)*$/g,""),e=this._splitUpFilenameWords(e),e=e.replace(/\s+/g," "),e=e.replace(/^[0-9 ]+/,""),e=e.replace(/[0-9 ]+$/,""),e=e.charAt(0).toUpperCase()+e.slice(1)},e._splitUpFilenameWords=function(e){return e=e.replace(/_/g," "),e.match(/-.*-/)&&(e=e.replace(/-/g," ")),e.indexOf(" ")<0&&(e=e.replace(/([a-z])([A-Z])/g,"$1 $2")),e},e}()}.call(this),function(){var e=[].slice;this.$a={is_logged_in:function(){return"undefined"!=typeof $current_user&&null!==$current_user&&!$current_user.unconfirmed},is_owner:function(){return"undefined"!=typeof $viewed_user&&null!==$viewed_user?$viewed_user.is_current_user():void 0},is_admin:function(){return"undefined"!=typeof $current_user&&null!==$current_user?$current_user.admin:void 0},admin_log:function(){return this.is_admin()&&"undefined"!=typeof console&&null!==console&&null!=console.log&&null!=console.log.apply?console.log.apply(console,Array.prototype.slice.call(arguments)):void 0},log:function(){return this.admin_log.apply(this,arguments)},admin_error:function(){return this.is_admin()&&"undefined"!=typeof console&&null!==console&&null!=console.error&&null!=console.error.apply?console.error.apply(console,Array.prototype.slice.call(arguments)):void 0},error:function(){return this.admin_error.apply(this,arguments)},annotate_out_links:function(e,t){return $(e+" a.outlink").each(function(){return $(this).attr("data-properties",t)})},query_param:function(e){var t,n,i,o;return i=$a.decompose_url(window.location.href),o=i[0],n=i[1],t=_.filter(n,function(t){return t[0]===e}),0===t.length?null:1===t.length?t[0][1]:_.map(t,function(e){return e[1]})},decompose_url:function(t){var n,i,o,r,s,a,c,u;return c=t.split("#"),t=c[0],o=2<=c.length?e.call(c,1):[],i=o.join("#"),n=_.chain(i.split("&")).compact().map(function(e){return e.split("=")}).value(),u=t.split("?"),t=u[0],a=2<=u.length?e.call(u,1):[],s=a.join("?"),r=_.chain(s.split("&")).compact().map(function(e){return e.split("=")}).value(),[t,r,n]},build_url:function(e,t,n){var i,o,r;return r=this.decompose_url(e),e=r[0],o=r[1],i=r[2],t&&(o=o.concat(t)),n&&(i=i.concat(n)),o.length>0&&(e=e+"?"+_(o).map(function(e){return e.join("=")}).join("&")),i.length>0&&(e=e+"#"+_(i).map(function(e){return e.join("=")}).join("&")),e},ie6:function(){return $.browser.msie&&$.browser.version.match(/^6/)},ie7:function(){return $.browser.msie&&$.browser.version.match(/^7/)},ie8:function(){return $.browser.msie&&$.browser.version.match(/^8/)},ie9:function(){return $.browser.msie&&$.browser.version.match(/^9/)},whenFirst:function(){var e,t,n,i,o;for(i=[].slice.call(arguments,0),o=new $.Deferred,e=0,t=i.length;t>e;e++)n=i[e],n.then(function(){return o.resolve(arguments)});return o},errors_array:function(e){var t,n,i,o;return _.flatten(function(){var r;r=[];for(n in e)o=e[n],r.push(function(){var e,r,s;for(s=[],e=0,r=o.length;r>e;e++)i=o[e],"base"===n?s.push(i):(t=n[0].toUpperCase()+n.slice(1),s.push(t+" "+i));return s}());return r}())},is_mobile:function(){var e;return e=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},is_element_in_viewport:function(e){var t;return t=e.getBoundingClientRect(),t&&t.bottom>=0&&t.right>=0&&t.top<=$(window).height()&&t.left<=$(window).width()},track_single_request:function(e){var t;return t={path:"/",domain:"."+$domain,expires:this.seconds_from_now(30)},e._from_url=window.location.href,$.cookie("single_request_tracker",JSON.stringify(e),t)},track_single_request_with_source:function(e,t){return null==t&&(t={}),t.source_id=e,this.track_single_request({internal_trackable_click:t})},days_from_now:function(e){return this.seconds_from_now(86400*e)},seconds_from_now:function(e){var t;return t=new Date,t.setTime(t.getTime()+1e3*e),t},check_mutation_support:function(){var e;return null==this._supports_mutations&&(null!=window.MutationObserver||null!=window.WebKitMutationObserver?this._supports_mutations=!0:(this._supports_mutations=!1,e=$("<div></div>"),$(e).observe("added",function(e){return function(){return e._supports_mutations=!0}}(this)),e.append($("<div></div>")))),this._supports_mutations},each_current_and_future:function(e,t){var n,i;return n="academia.debounce."+GlobalIncrementor.next(),i=function(){var e;return e=$(this),e.data(n)?void 0:(e.data(n,!0),t(e))},$(document).ready(function(t){return function(){var n;return $(e).each(i),t.check_mutation_support()?$("body").observe("added",e,i):(n=_.debounce(function(){return $(e).each(i)},50),$(document).ajaxComplete(n),setInterval(n,1e3))}}(this))},valIgnoringPlaceholder:function(e){var t,n;return n=e.val(),t=e.attr("placeholder"),n===t?"":$.trim(n)},randomNum:function(e,t){return null==t&&(t=0),Math.floor(Math.random()*(e-t)+t)},isLeftMouseButtonDown:function(e){return e||(e=window.event),1===e.buttons},fileUploadErrorString:function(e){var t,n,i;return t=_.pick(e,"errorThrown","total","loaded","bitrate"),t.status=null!=(n=e.jqXHR)?n.status:void 0,(null!=(i=e.files)?i.length:void 0)&&(t.filename=e.files[0].name),JSON.stringify(t)}},this.$a.check_mutation_support()}.call(this),function(){var e;e=0,this.GlobalIncrementor={next:function(){return++e}}}.call(this),window.$h=$h||{},_.extend(window.$h,{singularize:function(e){return e.match(/(x|z|ch|sh|ss)es$/)?e.substring(0,e.length-2):e.match(/s$/)?e.substring(0,e.length-1):e},abbreviateNumber:function(e){var t=e;if(e>=1e3){for(var n=["","K","M","B","T"],i=Math.floor((""+e).length/3),o="",r=2;r>=1;r--){o=parseFloat((0!=i?e/Math.pow(1e3,i):e).toPrecision(r));var s=(o+"").replace(/[^a-zA-Z 0-9]+/g,"");if(s.length<=2)break}o%1!=0&&(o=o.toFixed(1)),t=o+n[i]}return t},decodeHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0].nodeValue},encodeHTML:function(e){return $("<div/>").text(e).html()},truncate:function(e,t){return e.length>t?e.slice(0,t-3)+"...":e},to_sentence:function(e){switch(e.length){case 0:return"";case 1:return""+e[0];case 2:return""+e[0]+" and "+e[1];default:return""+e.slice(0,-1).join(", ")+" and "+e.slice(-1)}}}),function(){Aedu.Broccoli=function(){function e(e){var t;return null==e&&(e={}),this.defaultCollection=e.defaultCollection,this.defaultCollection?(t=_.clone(e.defaultFeatures)||{},_.defaults(t,this.DEFAULT_FEATURES),$a.log("[Broccoli Instantiated]:",this),void this.enable(t)):void $a.error("[Broccoli Error]: must set defaultCollection on instantiation")}return e.prototype.DEFAULT_FEATURES={listenForClicks:!0,listenForHashChange:!1},e.prototype.disable=function(){return $(document).off("click.broccoli","[data-broccoli-component]"),$a.log("[Broccoli Features] listenForClicks disabled:",this)},e.prototype.enable=function(e){return null==e&&(e={}),this._enabledFeatures||(this._enabledFeatures={}),e.listenForHashChange&&!this._enabledFeatures.listenForHashChange&&(this.notifyPageViewed(),this._listenForHashChange()),e.listenForClicks&&!this._enabledFeatures.listenForClicks&&this._listenForClicks(),_.extend(this._enabledFeatures,e)},e.prototype.notifyPageViewed=function(e,t){return null==e&&(e={}),null==t&&(t=this.defaultCollection),this.notify("page-viewed",_.extend(e,{url:window.location.toString()}),t)},e.prototype.notifyComponentClicked=function(e,t,n){var i,o,r,s;
if(null==t&&(t={}),null==n&&(n=this.defaultCollection),i=$(e),0===i.length)return void $a.error("[Broccoli Error]: invalid domElement in notifyComponentClicked");if(o=i.attr("data-broccoli-component"),!o)return void $a.error("[Broccoli Error]: invalid component in notifyComponentClicked");n=i.attr("data-broccoli-collection")||n;try{return r=JSON.parse(i.attr("data-broccoli-data")||"{}")}catch(a){return s=a,r={},$a.error("[Broccoli Error] Unable to parse data for "+o)}finally{this.notify(o+"__clicked",_.extend(t,r),n)}},e.prototype.notify=function(e,t,n){return null==t&&(t={}),null==n&&(n=this.defaultCollection),t=_.extend(t,{event:e,user_id:"undefined"!=typeof $current_user&&null!==$current_user?$current_user.id:void 0,auvid:$auvid}),this._getNotifier(n).notify(t),$a.log("[Broccoli Notify]:",t,this)},e.prototype._getNotifier=function(e){return this._notifiers||(this._notifiers={}),this._notifiers[e]||(this._notifiers[e]=new c.Server.Notification(e)),this._notifiers[e]},e.prototype._listenForClicks=function(){return $(document).on("click.broccoli","[data-broccoli-component]",function(e){return function(t){return e.notifyComponentClicked(t.currentTarget)}}(this)),$a.log("[Broccoli Features] listenForClicks enabled:",this)},e.prototype._listenForHashChange=function(){return $(window).on("hashchange.broccoli",function(e){return function(){return e.notifyPageViewed()}}(this)),$a.log("[Broccoli Features] listenForHashChange enabled:",this)},e}()}.call(this),function(){Academia.track_click=function(e,t,n){$.ajax({type:"POST",url:"/out_link",data:{url:e,properties:t},async:!!n})},$(document).on("click","a.outlink",function(){var e=$(this);return Academia.track_click(e.attr("href"),e.data("properties"),!1),!0})}(),function(){Academia.set_gmtoffset=function(e){var t={minutes:(new Date).getTimezoneOffset()};"undefined"!=typeof $current_user?$.post(e,t):$.get(e,t)}}();var Kale=function(){"use strict";function e(e){null!=e&&(e.listenForClicks===!0&&s(),e.listenForHashChange===!0&&o())}function t(e){if(e=e||{},!e.eventData)return void f.error("[Kale] Must pass in data to notify");var t=_.extend({},u(),e.eventData);l({collectionName:e.collectionName,eventData:t})}function n(e){return e?e.collectionName?e.notifier?(p=p||{},void(p[e.collectionName]=e.notifier)):void f.error("[Kale] Must pass in notifier in options hash for setNotifierForCollection"):void f.error("[Kale] Must pass in collectionName in options hash for setNotifierForCollection"):void f.error("[Kale] Cannot call setNotifierForCollection with no arguments")}function i(e){return e&&e.log&&e.error?void(f=e):void console.error("[Kale] Must pass in a valid context for setLogger")}function o(){h=h||{},h.listenForHashChange||(h.listenForHashChange=!0,$(window).on("hashchange",r),f.log("[Kale] listenForHashChange enabled"))}function r(e){e=e||{};var t=_.extend(u(),{event:"page-viewed",url:window.location.toString()});l({collectionName:"kale_page_views",eventData:t})}function s(){h=h||{},h.listenForClicks||(h.listenForClicks=!0,$(document).on("click","[data-kale-component]",function(e){a({domElement:e.currentTarget})}),f.log("[Kale] listenForClicks enabled"))}function a(e){e=e||{};var t=$(e.domElement);if(0===t.length)return void f.error("[Kale] domElement does not exist",e.domElement);var n=t.attr("data-kale-component");if(!n||""===n)return void f.error("[Kale] Must set a non-empty component name for data-kale-component");var i=t.attr("data-kale-collection");if(!i)return void f.error("[Kale] Must set a collection for data-kale-collection");var o=t.attr("data-kale-data")||null;if(o)try{o=JSON.parse(o||"{}")}catch(r){f.error("[Kale] Unable to parse JSON from data-kale-data")}o=_.extend({component:n,componentAction:"clicked"},u(),o),l({collectionName:i,eventData:o})}function u(){var e={user_id:null,auvid:null};return Aedu.User.current&&(e.user_id=Aedu.User.current.id),"undefined"!=typeof $auvid&&null!==$auvid&&(e.auvid=$auvid),e}function l(e){e=e||{},d(e.collectionName).notify(e.eventData),f.log("[Kale Event]:",e.collectionName,e.eventData)}function d(e){return p=p||{},p[e]||(p[e]=new c.Server.Notification(e)),p[e]}var p,h,f=$a;return s(),{enableFeatures:e,notify:t,setNotifierForCollection:n,getNotifierForCollection:d,setLogger:i}}(),$auvid;!function(){var e={record_hit_if_not_recorded:function(){Aedu.hit_data||this.record_hit({referrer:document.referrer,request_id:$request_id})},record_hit:function(e){$.ajax({type:"POST",url:"/record_hit",data:e}).done(function(e){Aedu.hit_data=e,e.auvid!=$auvid&&$a.log("Unexpected auvid mismatch: client="+$auvid+" & server="+e.auvid)})},set_auvid:function(){var e="auvid",t=$.cookie(e);if(null==t){var n=Math.random(),i=btoa(""+$start_time+":"+n);$.cookie(e,i,{path:"/",expires:30,domain:"."+$domain}),$auvid=i}else $auvid=t},page_loaded:function(){this.set_auvid(),this.record_hit_if_not_recorded(),$.cookie("from_cache","")}};$(document).ready(function(){e.page_loaded()})}(),function(){var e;(e=this.c).Server||(e.Server={}),c.Server.Notification=function(){function e(e,t){this.name=e,this.options=null!=t?t:{}}return e.prototype.notify=function(e){return null==e&&(e={}),jQuery.ajax({url:$r.api_v0_active_support_notifications_path({subdomain_param:"api"}),contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:jQuery.extend(e,{name:this.name}),type:"POST",statusCode:{401:function(t){return function(){return t.options._second_try?void 0:new c.Server.Notification(t.name,jQuery.extend(t.options,{_second_try:!0})).notify(e)}}(this)}})},e}()}.call(this),function(){var e=[].slice;Academia.Split={startAndRecord:function(){var t,n,i,o;return t=arguments[0],n=2<=arguments.length?e.call(arguments,1):[],o=this.clientCookieName(t),i=$.cookie(o),null!=i?i:(i=this.parseSplitTestDescription(n),$.cookie(o,i,{domain:$domain,path:"/",expires:365}),this.recordSplit(t,!1,n),i)},isSplitGroupMember:function(e,t){var n,i;return i=$a.query_param(e),null!=i?i===t:(n=this.clientCookieName(e),$.cookie(n)===t)},parseSplitTestDescription:function(e){var t,n,i,o,r,s,a,c,u,l,d,p;if(!$.isArray(e[0]))return a=e.length,u=Math.floor(Math.random()*a),d=e[u];for(a=0,p=[],n=0,d="",i=0,r=e.length;r>i;i++)t=e[i],a+=t[1],p.push([t[0],t[1]+n]),n+=t[1];for(c=Math.floor(Math.random()*a),o=0,s=p.length;s>o;o++)if(l=p[o],c<l[1])return l[0]},recordSplit:function(e,t,n){var i;return(i=$.cookie(this.clientCookieName(e)))?$.post("/record_split",{ab_test_name:e,test:i,options:n,finish:t}):void 0},endSplit:function(e){return $.cookie(this.clientCookieName(e),null,{domain:$domain,path:"/"})},clientCookieName:function(e){return"split_"+e}}}.call(this),function(){this.Aedu.FollowResearchInterestApi=function(){function e(){}return e.prototype.follow_ri=function(e){return this._post_follow_ri(e,$r.add_api_v0_taggings_path).done(function(e){var t;return null!=(t=c.User.current)?t.record_interest_of(e.research_interest):void 0})},e.prototype.unfollow_ri=function(e){return this._post_follow_ri(e,$r.remove_api_v0_taggings_path).done(function(){var t;return null!=(t=c.User.current)?t.record_uninterest_of(e):void 0})},e.prototype._post_follow_ri=function(e,t){return $.ajax({type:"POST",url:t({subdomain_param:"api",tag_type:"ResearchInterest",target_type:"User",target_id:$current_user.id}),data:{tag:{id:e}}})},e}(),window.FollowRI=new Aedu.FollowResearchInterestApi}.call(this),function(){this.c.FollowUserApi=function(){function e(){}return e.prototype.followUser=function(e,t,n){return this._postFollow(e,"POST",t,n).done(function(){var t;return null!=(t=c.User.current)?t.record_follow_of(e):void 0})},e.prototype.unfollowUser=function(e){return this._postFollow(e,"DELETE").done(function(){var t;return null!=(t=c.User.current)?t.record_unfollow_of(e):void 0})},e.prototype._postFollow=function(e,t,n,i){var o;return o={_method:t},null!=n&&(o.source=n),null!=i&&(o.source_details=i),$.ajax({url:$r.api_v0_user_following_index_path({user_id:e,subdomain_param:"api"}),type:"POST",data:o})},e.prototype.blockUser=function(e){return this._postBlock(e,"POST")},e.prototype.unblockUser=function(e){return this._postBlock(e,"DELETE")},e.prototype._postBlock=function(e,t){return $.ajax({url:$r.api_v0_user_blocks_path({user_id:e,subdomain_param:"api"}),type:"POST",data:{_method:t}})},e.prototype.showSignupToFollow=function(e,t){var n,i,o;return n=1/24/60*30,$.cookie("follow",e,{path:"/",domain:"."+$domain,expires:n}),i="//"+$app_host+"/signup_wall",o=[["user_source","follow"]],$w.boxover({iframe:$a.build_url(i,o),title:"Please sign up to follow "+t,onclose:function(){return $.removeCookie("follow",{path:"/",domain:"."+$domain})}})},e.prototype.showFollowPopover=function(){var e,t;if(!($a.ie6()||$a.ie7()||$a.ie8()||$a.is_mobile()||(e=$.cookie("saw_follow_popover")||0,t=(new Date).getTime()/1e3,e>t-864e3)))return $(".profile-pop-over").show(),$("#overlay_background").show(),$.cookie("saw_follow_popover",t,{domain:$domain,path:"/"})},e.prototype.hideFollowPopover=function(){return $(".profile-pop-over").hide(),$("#overlay_background").hide(),$("body").removeClass("top_popover")},e}(),window.Follow=new c.FollowUserApi}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.ResearchInterest=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.loadFollowersCount=function(){return this._loadAsyncAttr("followers_count",$r.api_v0_interest_followers_url({interest_id:this.id}),function(e){return e.count})},n.prototype.loadWorksCount=function(){return this._loadAsyncAttr("works_count",$r.api_v0_interest_works_url({interest_id:this.id}),function(e){return e.count})},n.prototype._loadAsyncAttr=function(e,t,n){var i,o;return this._async_attr_promises||(this._async_attr_promises={}),(i=this._async_attr_promises)[e]||(i[e]=$.ajax({url:t,dataType:"jsonp"})),o=new $.Deferred,this._async_attr_promises[e].done(function(e){return o.resolve(n(e))}),o},n}(Backbone.Model)}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};this.c||(this.c={}),this.c.User=function(){function t(e){this.set_attrs(e)}return t.users={},t.set_current=function(e){return this.current=this.from_json(e)},t.set_viewed=function(e){return this.viewed=this.from_json(e)},t.from_json=function(e){var n;if("string"==typeof e&&(e=JSON.parse(e)),n=e.id,null==n)throw"id is required";return n in this.users?this.users[n].set_attrs(e):this.users[n]=new t(e)},t.prototype.set_attrs=function(e){if(_.extend(this,e),null==this.first_name||null==this.last_name)throw"first and last name are required";if(this.display_name=this.first_name+" "+this.last_name,null==this.domain_name||null==this.page_name)throw"subdomain and page are required";return this.url=$r.new_profile_url({subdomain:this.domain_name,page_name:this.page_name}),null!=this.followee_ids&&$.isArray(this.followee_ids)&&(this.followee_ids=_(this.followee_ids).reduce(function(e,t){return e[t]=!0,e},{})),this},t.prototype.is_affiliated=function(){return"independent"!==this.domain_name},t.prototype.update_url=function(e){var t;return this.url=e,t=e.replace(/https?:\/\//,"").split("."+$app_host+"/"),this.domain_name=t[0],this.page_name=t[1],t},t.prototype.affiliation=function(){return{category:this.is_affiliated()?"university":"independent",department:this.department,position:{id:this.position_id,name:4!==this.position_id?this.position:void 0},custom_position:{name:4===this.position_id?this.position:void 0},is_primary:!0,toString:function(){return this.department?[this.department.university.name,this.position.name||this.custom_position.name,this.department.name].join(", "):"Independent Researcher"}}},t.prototype.has_teaching_position=function(){var e;return 1===(e=this.position_id)||2===e||3===e||6===e||9===e},t.prototype.has_research_interests=function(){return null!=this.interests?this.interests.length>0:void 0},t.prototype.has_interest=function(e){return null!=this.interests?_(this.interests).some(function(t){return t.id===e}):void 0},t.prototype.record_interest_of=function(e){return c.User.current.interests.push(e)},t.prototype.record_uninterest_of=function(e){return c.User.current.interests=_.reject(c.User.current.interests,function(t){return t.id===e})},t.prototype.has_rollout_feature=function(t){return this.active_rollout_features?e.call(this.active_rollout_features,t)>=0:!1},t.prototype.is_analytics_visible=function(){return this.is_analytics_public||this.is_current_user()},t.prototype.message_me_path=function(){return"/Messages?recipient="+this.id},t.prototype.follows=function(e){return null!=this.followee_ids?e in this.followee_ids:void 0},t.prototype.record_follow_of=function(e){return null!=this.followee_ids?this.followee_ids[e]=!0:void 0},t.prototype.record_unfollow_of=function(e){return null!=this.followee_ids?delete this.followee_ids[e]:void 0},t.prototype.is_current_user=function(){var e;return(null!=(e=this.constructor.current)?e.id:void 0)===this.id},t.prototype.is_viewed_user=function(){var e;return(null!=(e=this.constructor.viewed)?e.id:void 0)===this.id},t.prototype.load_followers_count=function(){return this._load_async_attr("followers_count",$r.api_v0_user_followers_url({user_id:this.id,limit:0}),function(e){return e.meta.count})},t.prototype.load_works_count=function(){return this._load_async_attr("works_count",$r.count_api_v0_user_works_url({user_id:this.id}),function(e){return e.count})},t.prototype.load_views_counts=function(){return this._load_async_attr("views_counts",$r.api_v0_user_stats_url({user_id:this.id}),function(e){return e})},t.prototype._load_async_attr=function(e,t,n){var i,o;return this._async_attr_promises||(this._async_attr_promises={}),(i=this._async_attr_promises)[e]||(i[e]=$.ajax({url:t,dataType:"jsonp"})),o=new $.Deferred,this._async_attr_promises[e].done(function(e){return o.resolve(n(e))}),o},t}(),"undefined"!=typeof $current_user&&null!==$current_user&&this.c.User.set_current($current_user)}.call(this),function(){var e;this.Aedu||(this.Aedu={}),(e=this.Aedu).Behaviors||(e.Behaviors={})}.call(this),function(){var e;e=function(e){var t,n,i,o;return t=document.createElement("a"),t.href=e,n=t.hostname,o="."+$domain,i=n.lastIndexOf(o),i>0&&i===n.length-o.length},$.ajaxPrefilter(function(t,n,i){return!t.crossDomain||e(t.url)?$.rails.CSRFProtection(i):void 0})}.call(this),function(){var e={page_loaded:function(e){$("meta[name=csrf-token]").attr("content")===e&&$.post("/csrf_meta",function(e){$("meta[name=csrf-token]").attr("content",e),$("input[name=authenticity_token]").val(e)})}};$(document).ready(function(){"undefined"!=typeof $authenticity_token_placeholder&&e.page_loaded($authenticity_token_placeholder)})}(),function(){$(document).ready(function(){return $(".first-focus").focus(),$("body").observe("added",".first-focus",function(){return $(this).focus()})})}.call(this),function(){var e;e=function(e){var t;return t=e.parents("*[data-hover-menu]").find(".hover_menu_row"),t.removeClass("hovered"),e.addClass("hovered")},$(document).on("hover","*[data-hover-menu]",function(e){var t;return t=$(e.currentTarget),"mouseenter"===e.type?(t.data("hover-menu-on",!0),t.find(".hover_menu").fadeIn(100)):(t.data("hover-menu-on",!1),_.delay(function(){return t.data("hover-menu-on")?void 0:t.find(".hover_menu").fadeOut(100)},200))}),$(document).on("hover","*[data-hover-menu=first]",function(t){var n;return n=$(t.target),n.is(".hover_menu")||n.parents().is(".hover_menu")?void 0:e($($(t.currentTarget).find(".hover_menu_row").get(0)))}),$(document).on("hover","*[data-hover-menu] .hover_menu_row",function(t){return"mouseenter"===t.type?e($(t.currentTarget)):void 0})}.call(this),function(){$a.each_current_and_future(".load_async",function(e){var t;return t=e.data("url"),t?$.ajax({url:t}).done(function(t){return e.html(t).show()}):void 0})}.call(this),function(){var e,t;e=function(e,t,n,i){return t.length>1&&(t=JSON.parse(t)),e.trigger("ajax:success",[t,n,i]),null!=(null!=t?t.redirect:void 0)?document.location=t.redirect:void 0},t=function(t,n){return null==n&&(n={}),$.ajax({url:t.attr("href"),type:"POST",data:n,success:function(n,i,o){return e(t,n,i,o)}})},$(document).on("confirm","a[data-method='delete']",function(e){var n,i;return n=$(e.currentTarget),i=n.data("confirm")||"Are you sure?",$w.confirm(i,{nextTo:n},function(){return t(n,{_method:"DELETE"})}),!1}),$(document).on("confirm","a[data-method='post']",function(e){var n,i;return n=$(e.currentTarget),i=n.data("confirm"),i?$w.confirm(i,{nextTo:n},function(){return t(n)}):t(n),!1})}.call(this),function(){var e;e=function(e){var t,n,i;return t=e.closest(e.data("container")),i=t.find(e.data("show")),n=t.find(e.data("hide")),{show:i,hide:n}},$(document).on("click","a[data-more-link-behavior=true]",function(e){var t;return e.preventDefault(),t=$(e.target),t.trigger("show_more")}),$(document).on("show_more","*",function(t){var n,i,o;return t.stopPropagation(),i=e($(t.target)),o=i.show,n=i.hide,n.addClass("hidden"),n.hide(),o.removeClass("hidden"),o.show()}),$(document).on("show_less","*",function(t){var n,i,o;return t.stopPropagation(),i=e($(t.target)),o=i.show,n=i.hide,o.addClass("hidden"),o.hide(),n.removeClass("hidden"),n.show()})}.call(this),function(){$(document).on("resize_boxy",function(){return function(e,t){var n;return n=_.find(Widgets.Base.open_widgets||[],function(e){return"BoxOver"===e.widget_name}),null!=t&&null!=n?n.set_height(t):void 0}}(this))}.call(this),function(){Aedu.Behaviors.ScrollScope=function(){var e;return e=!1,{enable:function(t){return e||$(document).scrollScope(),e=!0,t.attr("data-scroll-scope",!0)}}}()}.call(this),$(function(){$("input[type=checkbox].select_all").each(function(e,t){var n=null;if($(t.className.split(" ")).each(function(e,t){0===t.indexOf("select_all_group_")&&(n=t)}),n){var i=$("input[type=checkbox]."+n).not(t);$(t).change(function(){i.each(function(e,n){n.checked=t.checked})}),i.change(function(){var e=!0;i.each(function(t,n){e=e&&n.checked}),t.checked=e})}})}),function(){$(document).on("focus click","textarea.autoexpand_on_focus",function(){return $(this).autosize()})}.call(this),function(){var e=function(e){var t=e.attr("maxlength");t&&t>0&&e.keydown(function(){e.val().length>t&&e.val(e.val().substring(0,t))})};$a.each_current_and_future("textarea",e)}(),function(){$a.each_current_and_future("time.js-time-ago",function(e){return e.timeago()})}.call(this),function(){$a.each_current_and_future(".js-tooltip",function(e){return e.tooltip()})}.call(this),function(){this.$w||(this.$w={}),this.Widgets||(this.Widgets={})}.call(this),Widgets.Base={parent:null,open_widgets:[],inherit:function(e){var t=$x.extend($x.object(this),e);return t.parent=this,t},create:function(e){var t=$x.object(this);return t.init(e),t},target_element:null,init:function(e){this.target_element=e.nextTo;var t=e.down||10,n=e.along||0,i=$(this.target_element).offset();this.offset={left:i.left+n,top:i.top+t}},dom_element:null,j_element:null,definition:function(){return["div.base-widget"]},build:function(){this.dom_element=JSML.transform(this.definition()),this.j_element=$(this.dom_element),this.j_element.hide()},insert:function(){document.body.appendChild(this.dom_element)},remove:function(){var e=this.dom_element;e?e.parentNode.removeChild(e):$a.log("el wasn't defined")},position:function(){this.target_element&&this.j_element.css({position:"absolute",left:this.offset.left,top:this.offset.top})},show:function(){this.prepare(),this.j_element.show(),this.add_to_open_widgets()},fadeIn:function(){this.prepare(),this.j_element.fadeIn(),this.add_to_open_widgets()},hide:function(){$("#overlay_background").hide(),this.j_element.hide(),this.cleanup(),this.remove_from_open_widgets(),"function"==typeof this.after_hide_callback&&this.after_hide_callback()},fadeOut:function(){var e=this;this.j_element.fadeOut(function(){e.cleanup(),e.remove_from_open_widgets(),"function"==typeof e.after_hide_callback&&e.after_hide_callback()})},shake:function(e){e="undefined"!=typeof e?e:"5px";var t=this;t.j_element.animate({marginLeft:"-"+e},100,function(){t.j_element.animate({marginLeft:e},100,function(){t.j_element.animate({marginLeft:"0px"},100)})})},hide_all:function(){for(var e=Widgets.Base.open_widgets.slice(),t=0;t<e.length;t++)e[t].hide()},add_to_open_widgets:function(){Widgets.Base.open_widgets.push(this)},remove_from_open_widgets:function(){var e=Widgets.Base.open_widgets.indexOf(this);e>=0&&Widgets.Base.open_widgets.splice(e)},prepare:function(){this.insert(),this.position()},cleanup:function(){this.j_element.html(""),this.remove()},flash:function(e,t){"undefined"==typeof t&&(t={});var n=t.fadeInMS||100,i=t.visibleMS||400,o=t.fadeOutMS||400,r=this;r.prepare(),r.j_element.fadeIn(n,function(){setTimeout(function(){r.j_element.fadeOut(o,function(){r.cleanup(),e&&e()})},i)})},bind_fade_to_events:function(){var e=this,t=$.map(arguments,function(e){return"string"==typeof e[0]?$(e[0]):e[0]}),n=$.map(arguments,function(e){return e[1]}),i=function(){$.each(t,function(e,t){t.unbind(n[e],i)}),"none"!==e.j_element.css("display")&&e.fadeOut()};$.each(t,function(e,t){t.bind(n[e],i)})}},+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.tooltip"),r="object"==typeof t&&t;(o||"destroy"!=t)&&(o||i.data("bs.tooltip",o=new n(this,r)),"string"==typeof t&&o[t]())})}var n=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};n.VERSION="3.2.0",n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var o=this.options.trigger.split(" "),r=o.length;r--;){var s=o[r];if("click"==s)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",c="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},n.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show()},n.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},n.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var n=e.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!n)return;var i=this,o=this.tip(),r=this.getUID(this.type);this.setContent(),o.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,c=a.test(s);c&&(s=s.replace(a,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element);var u=this.getPosition(),l=o[0].offsetWidth,d=o[0].offsetHeight;if(c){var p=s,h=this.$element.parent(),_=this.getPosition(h);s="bottom"==s&&u.top+u.height+d-_.scroll>_.height?"top":"top"==s&&u.top-_.scroll-d<0?"bottom":"right"==s&&u.right+l>_.width?"left":"left"==s&&u.left-l<_.left?"right":s,o.removeClass(p).addClass(s)}var f=this.getCalculatedOffset(s,u,l,d);this.applyPlacement(f,s);var m=function(){i.$element.trigger("shown.bs."+i.type),i.hoverState=null};e.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",m).emulateTransitionEnd(150):m()}},n.prototype.applyPlacement=function(t,n){var i=this.tip(),o=i[0].offsetWidth,r=i[0].offsetHeight,s=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),t.top=t.top+s,t.left=t.left+a,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var c=i[0].offsetWidth,u=i[0].offsetHeight;"top"==n&&u!=r&&(t.top=t.top+r-u);var l=this.getViewportAdjustedDelta(n,t,c,u);l.left?t.left+=l.left:t.top+=l.top;var d=l.left?2*l.left-o+c:2*l.top-r+u,p=l.left?"left":"top",h=l.left?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(d,i[0][h],p)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(){function t(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),o=e.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(o),o.isDefaultPrevented()?void 0:(i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],i="BODY"==n.tagName;return e.extend({},"function"==typeof n.getBoundingClientRect?n.getBoundingClientRect():null,{scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:i?e(window).width():t.outerWidth(),height:i?e(window).height():t.outerHeight()},i?{top:0,left:0}:t.offset())},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var r=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(e)){var a=t.top-r-s.scroll,c=t.top+r-s.scroll+i;a<s.top?o.top=s.top-a:c>s.top+s.height&&(o.top=s.top+s.height-c)}else{var u=t.left-r,l=t.left+r+n;u<s.left?o.left=s.left-u:l>s.width&&(o.left=s.left+s.width-l)}return o},n.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},n.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},n.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=n,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),function(){$.fn.tooltip.Constructor.DEFAULTS.template='<div class="academia-tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'}.call(this),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.popover"),r="object"==typeof t&&t;(o||"destroy"!=t)&&(o||i.data("bs.popover",o=new n(this,r)),"string"==typeof t&&o[t]())})}var n=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.2.0",n.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},n.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=n,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.HoverPopover=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.$el.data("bs.popover")?void 0:(this.on_shown=e.on_shown,this.show_delay=e.show_delay,this.hide_delay=e.hide_delay,this.before_show=e.before_show,this.frozen=!1,e.trigger="manual",this.$el.popover(e),this._popover_el().on("mouseenter",function(e){return function(){return e._unschedule_close()}}(this)).on("mouseleave",function(e){return function(){return e._schedule_close()}}(this)))},n.prototype.events={mouseenter:"_schedule_open",mouseleave:"_schedule_close",click:"_handle_click","shown.bs.popover":"_emit_shown"},n.prototype.freeze=function(){return this._unschedule_open(),this._unschedule_close(),this.frozen=!0},n.prototype.unfreeze=function(){return this.frozen=!1,this.$el.is(":hover")||this._popover_el().is(":hover")?this._schedule_open():this._schedule_close()},n.prototype._emit_shown=function(){return null!=this.on_shown?this.on_shown(this._popover_el()):void 0},n.prototype._handle_click=function(e){return e.stopPropagation(),this.popover_shown?void 0:(this._show(),e.preventDefault())},n.prototype._schedule_open=function(e){return this.frozen||$a.isLeftMouseButtonDown(e)||$a.ie9()?void 0:(this._unschedule_close(),this.openme=setTimeout(function(e){return function(){return e.popover_shown?void 0:e._show()}}(this),this.show_delay))},n.prototype._unschedule_open=function(){return null!=this.openme?clearTimeout(this.openme):void 0},n.prototype._schedule_close=function(){return this.frozen?void 0:(this._unschedule_open(),this.closeme=setTimeout(function(e){return function(){return e._hide()}}(this),this.hide_delay))},n.prototype._unschedule_close=function(){return null!=this.closeme?clearTimeout(this.closeme):void 0
},n.prototype._show=function(){var e;return e=function(e){return function(){return e.popover_shown=!0,e.$el.popover("show"),_.defer(function(){return e.popover_shown?e._hide_on_clicking_elsewhere():void 0})}}(this),this.before_show?this.before_show(e):e()},n.prototype._hide_on_clicking_elsewhere=function(){return $(document).on("click.hover-popover",function(e){return function(t){return e._popover_el()?e._popover_el().has($(t.target)).length>0?void 0:_.defer(function(){return e.popover_shown?e._hide():void 0}):void 0}}(this))},n.prototype._hide=function(){return this.popover_shown=!1,this.frozen=!1,this.$el.popover("hide"),$(document).off("click.hover-popover")},n.prototype._popover_el=function(){var e;return null!=(e=this.$el.data("bs.popover"))?e.tip():void 0},n.prototype.remove=function(){return this._hide(),n.__super__.remove.apply(this,arguments)},_,n}(Backbone.View)}.call(this),function(){var e;e=function(e){return function(t){return t.authResponse?FB.api("/me/permissions",function(n){return n&&!n.error&&_.findWhere(n.data,{permission:"email",status:"granted"})?void e.resolve(t.authResponse):(FB.api("/me/permissions","DELETE",function(){}),e.reject())}):e.reject()}},this.Facebook={is_ready:!1,ready_listeners:[],connected_url:"/auth/connect",disconnected_url:"/auth/disconnect",default_permissions:"email,user_friends,user_education_history,user_work_history",scope:function(){return this.default_permissions},run_ready_listeners:function(){var e,t;for(this.is_ready=!0,e=void 0,t=[];e=this.ready_listeners.shift();)t.push(e());return t},_when_ready:function(e){return this.is_ready?e():this.ready_listeners.push(e)},get_login_status:function(e){return this._when_ready(function(){return FB.getLoginStatus(e)})},check_login_status:function(){var t;return t=new $.Deferred,this.get_login_status(e(t)),t},authorize:function(t){var n,i;return null==t&&(t=!1),n=new $.Deferred,i={scope:this.scope()},t&&(i.auth_type="rerequest"),this._when_ready(function(){return function(){return FB.login(e(n),i)}}(this)),n},check_permissions_granted:function(e){var t;return t=new $.Deferred,FB.api("/me/permissions",function(n){var i,o,r,s;return n&&!n.error&&(s=function(){var t,r,s;for(s=[],t=0,r=e.length;r>t;t++)o=e[t],i=_.findWhere(n.data,{permission:o,status:"granted"}),s.push(null!=i);return s}(),r=_.reduce(s,function(e,t){return e&&t},!0),t.resolve(r)),t.resolve(!1)}),t},register_connected:function(e){return $.post(this.connected_url,{provider:"facebook",uid:e.userID,"oauth[token]":e.accessToken,"oauth[expires]":e.expiresIn})},deregister_connected_and_reload:function(){return FB.login(function(e){return e.authResponse?FB.api({method:"auth.revokeAuthorization",params:{uid:e.authResponse.userID}},function(){return $.post(Facebook.disconnected_url,{provider:"facebook"},function(){return window.location.reload(!0)})}):void 0})}}}.call(this),function(){this.Google={last_successful_auth_response:!1,disconnect_api_url:"https://accounts.google.com/o/oauth2/revoke?token=",disconnect_url:"auth/disconnect",connect_url:"auth/connect",scopes:"openid email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/contacts.readonly https://www.googleapis.com/auth/plus.me",old_scopes:"openid email https://www.googleapis.com/auth/userinfo.profile https://www.google.com/m8/feeds/ https://www.googleapis.com/auth/plus.me",authorize:function(){var e;return this.last_successful_auth_response?(e=new $.Deferred,e.resolve(this.last_successful_auth_response),e):this._request_auth({scope:this.scopes,immediate:!1})},check_authorization:function(){return this._request_auth({scope:this.scopes,immediate:!0}).fail(function(e){return function(t){return"immediate_failed"===(null!=t?t.error:void 0)?e._request_auth({scope:e.old_scopes,immediate:!0}):void 0}}(this))},_request_auth:function(e){var t;return t=new $.Deferred,"undefined"==typeof gapi?t.reject():gapi.auth.authorize(_.extend({client_id:Google.client_id},e),function(e){return function(n){return(null!=n?n.access_token:void 0)?(e.last_successful_auth_response=n,t.resolve(n)):t.reject(n)}}(this)),t},get_user_info:function(){var e;return e=new $.Deferred,gapi.client.load("oauth2","v2",function(){return gapi.client.oauth2.userinfo.get({userId:"me"}).then(function(t){return e.resolve(t.result)},function(){return e.reject()})}),e},register_connected:function(e,t){return $.post(Google.connect_url,{provider:"google",uid:t.id,"oauth[token]":e.access_token,"oauth[expires]":e.expires_in})},deregister_connected_and_reload:function(){return this.authorize().done(function(e){var t;return t=Google.disconnect_api_url+e.access_token,$.ajax({type:"GET",url:t,async:!1,contentType:"application/json",dataType:"jsonp",success:function(){return $.post(Google.disconnect_url,{provider:"google","oauth[token]":e.access_token,"oauth[expires]":e.expires_in},function(){return window.location.reload()})}})})}}}.call(this),function(){var e,t,n,i,o,r,s;e=function(){function e(e,t){this.routeHelper=e,this.ajaxResponseDataKey=t,this.pendingItems=[],this.retrieve=_.debounce(this.retrievePendingItems,100)}return e.prototype.queue=function(e,t){return this.pendingItems.push({itemId:e,callback:t}),this.retrieve()},e.prototype.retrievePendingItems=function(){var e,t;if(0!==this.pendingItems.length)return t=this.pendingItems.slice(),e=_.keys(_.groupBy(this.pendingItems,"itemId")),this.pendingItems=[],$.ajax({dataType:"jsonp",url:this.routeHelper(e),success:function(e){return function(n){return _.each(n[e.ajaxResponseDataKey],function(e,n){var i;return n=parseInt(n),i=_.filter(t,function(e){return e.itemId===n}),_.each(i,function(t){return t.callback(e)})})}}(this)})},e}(),s=function(e){return $r.api_v0_works_views_url({work_ids:e})},window.Academia.workViewCountsFetcher=new e(s,"views"),r=function(e){return $r.api_v0_works_percentiles_url({work_ids:e})},window.Academia.workPercentilesFetcher=new e(r,"percentiles"),o=function(e){return $r.api_v0_works_certification_counts_url({work_ids:e})},window.Academia.workCertificationCountsFetcher=new e(o,"certification_counts"),t=function(e){return $r.api_v0_certifications_ranks_paper_ranks_url({ids:e})},window.Academia.paperRanksFetcher=new e(t,"paper_ranks"),n=function(e){return $r.api_v0_social_distance_url()+"?work_ids[]="+e.join("&work_ids[]=")},window.Academia.socialDistanceFetcher=new e(n,"works"),i=function(e){return $r.api_v0_profiles_user_relation_stats_url({ids:e})},window.Academia.userRelationStats=new e(i,"profile_user_relation_stats")}.call(this),function(){this.AcademiaSharing={}}.call(this),function(){$(document).on("click","*[data-academia-share]",function(e){var t;return t=new AcademiaSharing.BookmarkButtonView({el:$(e.currentTarget)}),t.model.fetch().error(function(){return t.model.set({message:""})}).always(function(){return t.handle_bookmark_click()})})}.call(this),function(){AcademiaSharing.UndoTracker=function(){function e(){this.previous_undos=parseInt($.cookie(this.cookie_name)||0),$.cookie(this.cookie_name,null,this.cookie_settings())}return e.prototype.cookie_name="autobookmark_undo",e.prototype.increment=function(){return $.cookie(this.cookie_name,this.previous_undos+1,this.cookie_settings())},e.prototype.cookie_settings=function(){return{path:"/",domain:"."+$domain,expires:$a.days_from_now(7)}},e}()}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/bookmarks/templates/modal_view"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="academia_sharing_modal clearfix"><div class="work_share_container">'+(null==(t=i)?"":t)+'</div><div class="input"><textarea name="message" maxlength="500" class="message">'+jade.escape(null==(t=e)?"":t)+'</textarea></div><a href="#" style="display: none" class="button red unshare">Remove</a><a href="#" class="button blue save">Save</a><a href="#" class="button light-grey cancel">Cancel</a></div>')}.call(this,"message"in i?i.message:"undefined"!=typeof message?message:void 0,"preview"in i?i.preview:"undefined"!=typeof preview?preview:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/bookmarks/templates/settings_link"]=function(){var e=[];return e.push('<div class="top_banner_flash orange"><i class="close">&times;</i><a href="/settings#privacy" class="action">Settings</a><p class="message">Did you know you can prevent your downloads from being automatically bookmarked? Visit your <a href="/settings#privacy">Privacy Settings.</a></p></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/bookmarks/templates/success_notice"]=function(e){var t=[],n=e||{};return function(e){t.push('<div class="top_banner_flash blue"><i class="close">&times;</i><a class="action">Undo</a><p class="message">'),t.push(e?'Paper downloaded and added to your public <a href="/Bookmarks">bookmarks</a>':'Paper added to your public <a href="/Bookmarks">bookmarks</a>'),t.push("</p></div>")}.call(this,"isDownload"in n?n.isDownload:"undefined"!=typeof isDownload?isDownload:void 0),t.join("")}}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;AcademiaSharing.Bookmark=function(n){function i(){return this.sync=e(this.sync,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.modelName="bookmark",i.prototype.routeKey="api_v0_bookmark",i.for_target_arx=function(e,t){var n,i,o,r;return null==t&&(t={}),o=e.split("/"),r=o[0],n=o[1],i=new AcademiaSharing.Bookmark({content_type:r,content_id:parseInt(n)}),i.set(t),i},i.prototype.target_arx=function(){return this.get("content_type")+"/"+this.get("content_id")},i.prototype.url=function(e){return"read"===e&&null==this.id?$r.find_api_v0_bookmarks_path({subdomain_param:"api","bookmark[content_type]":this.get("content_type"),"bookmark[content_id]":this.get("content_id")}):i.__super__.url.apply(this,arguments)},i.prototype.sync=function(e){var t;return t=i.__super__.sync.apply(this,arguments),!t||"create"!==e&&"update"!==e||t.done(function(e){return function(){return e.trigger("save")}}(this)),t},i.prototype.preview_url=function(){return $r.html_api_v0_work_path({id:this.get("content_id"),subdomain_param:"api"})},i.prototype.toJSON=function(){return _.omit(this.attributes,"preview")},i}(Academia.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;AcademiaSharing.BookmarkButtonView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.set_model(this.options.model||this.build_model(this.options.model_options)),this},n.prototype.set_model=function(e){return this.model=e,this.model.on("save",function(e){return function(){return e.set_bookmarked()}}(this)),this.model.on("destroy",function(e){return function(){return e.model.unset("id"),e.set_unbookmarked()}}(this))},n.prototype.build_model=function(e){var t,n,i,o;return t=this.$el.data("academia-share"),n=this.$el.parents(".work_share_container").data("reshare-of"),i=(null!=e?e.source:void 0)||this.$el.data("share-source"),o=(null!=e?e.source_details:void 0)||this.$el.data("share-source-details"),null==o&&this.$el.data("share-source-details-news-story-verb")&&(o={story_verb:this.$el.data("share-source-details-news-story-verb")}),AcademiaSharing.Bookmark.for_target_arx(t,{share_id:n,source:i,source_details:o})},n.prototype.handle_bookmark_click=function(){return this.model.id?this.handle_remove():this.handle_save()},n.prototype.handle_remove=function(){return $w.confirm("Bookmark exists. Remove it?",{nextTo:this.$el},function(e){return function(){return e.model.destroy()}}(this))},n.prototype.handle_save=function(){return this.model.save({message:""},{success:function(e){return function(){var t;return t=new AcademiaSharing.SuccessNoticeView({model:e.model,link_settings_on_undo:!1}),t.show(!1)}}(this)})},n.prototype.set_bookmarked=function(){return this.$el.addClass("after_success").find('*[data-content="button_text"]').text("Bookmarked")},n.prototype.set_unbookmarked=function(){return this.$el.removeClass("after_success").find('*[data-content="button_text"]').text("Bookmark")},n}(Academia.StaticView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;AcademiaSharing.SuccessNoticeView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.jstTemplate="core/sitewide_business_elements/bookmarks/templates/success_notice",n.prototype.elements={banner:".top_banner_flash",close:".close",undo:".action",message:".message"},n.prototype.events={"click %close":"handle_close","click %undo":"handle_undo"},n.prototype.handle_close=function(){return this.$el.remove(),this.trigger("close")},n.prototype.handle_undo=function(){return this.$els.undo.remove(),this.cancel_fadeout(),this.model.destroy({success:function(e){return function(){return e.display_undo_success()}}(this)})},n.prototype.show=function(e){return null==e&&(e=!0),$("#site").before(this.$el.html(JST[this.jstTemplate]({isDownload:e}))),this._find_elements(),this.fadeout_after_delay()},n.prototype.fadeout_after_delay=function(e){return null==e&&(e=5e3),this.scheduledFade=setTimeout(function(e){return function(){return e.$el.fadeOut({complete:function(){return e.trigger("close")}})}}(this),e)},n.prototype.cancel_fadeout=function(){return null!=this.scheduledFade&&clearTimeout(this.scheduledFade),this.$el.stop()},n.prototype.display_undo_success=function(){return this.options.link_settings_on_undo?(this.$el.html(JST["core/sitewide_business_elements/bookmarks/templates/settings_link"]),this.fadeout_after_delay(15e3)):(this.$els.banner.removeClass("blue").addClass("orange"),this.$els.message.html("Bookmark removed"),this.fadeout_after_delay())},n}(Academia.View)}.call(this),function(){var e,t;(e=this.c).Documents||(e.Documents={}),(t=this.c.Documents).Download||(t.Download={})}.call(this),function(){this.c.Documents.AutoBookmark=function(){function e(){}return e.trigger=function(e,t,n){var i,o;return i=new AcademiaSharing.Bookmark({content_type:"Work",content_id:t.asset_id,source:"download",share_id:e.parents(".work_share_container").data("reshare-of"),from_download_at:n}),$("*[data-academia-share='"+i.target_arx()+"']").each(function(){return new AcademiaSharing.BookmarkButtonView({el:$(this),model:i})}),o=new AcademiaSharing.UndoTracker,i.on("destroy",function(){return o.increment()}),i.fetch({error:function(e,t){return e.isNew()&&404===t.status?e.save({},{success:function(){var t;return t=new AcademiaSharing.SuccessNoticeView({model:e,link_settings_on_undo:o.previous_undos>=2}),t.show()}}):void 0}})},e}()}.call(this),function(){var e;e=new Date,this.c.Documents.DownloadButton=function(){function t(e){this.$el=$(e),this.data=this.$el.data("download"),this.popover=new c.Documents.DownloadPopover(this.data),this.can_request_logged_in_reader_messages=!Aedu.swpData.get("userHasUploadedWorks")}return t.prototype.handle_click=function(e){var t,n,i,o;if(this.add_tracking_token_to_href(new Date(e.timeStamp)),this.popover.should_show())e.preventDefault(),this.popover.show();else if("undefined"!=typeof $current_user&&null!==$current_user&&(this.style_as_downloaded(),!this.non_work())){if(Aedu.swpData.get("leftReaderMessage"))return;return this.can_request_logged_in_reader_messages?(FullStory.recordSession(),n=null,o=function(){return n.close()},i={readerMessageDeliveredHandler:o},t=new Aedu.Broccoli({defaultFeatures:{listenForClicks:!1},defaultCollection:"logged_in_reader_messages"}),t.notify("post_download_modal_shown",{user_id:Aedu.User.current.id}),n=Components.Utils.showModal(Aedu.SingleWork.PostDownloadModal,i)):c.Documents.AutoBookmark.trigger(this.$el,this.data,new Date(e.timeStamp))}},t.prototype.non_work=function(){return null!=this.data.asset_type&&"Work"!==this.data.asset_type},t.prototype.style_as_downloaded=function(){return this.$el.addClass("after_success").find('*[data-content="button_text"]').text("Downloaded")},t.prototype.add_tracking_token_to_href=function(e){var t;return t=this.$el.attr("href"),t?this.$el.attr("href",this.add_tracking_token_to_url(t,e)):void 0},t.prototype.add_tracking_token_to_url=function(e,t){var n,i,o,r;return o=$a.decompose_url(e),r=o[0],i=o[1],n=o[2],_(i).any(function(e){return"ct"===e[0]})||i.push(["ct",this.generate_tracking_token(t)]),_(i).any(function(e){return"s"===e[0]})||i.push(["s",this.data.button_location]),$a.build_url(r,i,n)},t.prototype.generate_tracking_token=function(t){var n;return n=[Math.round(e.getTime()/1e3),Math.round(t.getTime()/1e3)],"undefined"!=typeof $current_user&&null!==$current_user&&n.push($current_user.id),window.btoa(n.join(","))},t}(),$(document).on("click","*[data-download]",function(e){return new c.Documents.DownloadButton(e.currentTarget).handle_click(e)})}.call(this),function(){this.c.Documents.DownloadPopover=function(){function e(e){this.options=e,(null==this.options.track||this.options.track)&&(this.tracker=new c.Documents.DownloadTracker(this.options))}return e.prototype.should_show=function(){return!("undefined"!=typeof $current_user&&null!==$current_user||this.options.always_allow_download||$a.ie6()||$a.is_mobile()||this.constructor._popover_disabled)},e.prototype.show=function(){var e;return null!=(e=this.tracker)&&e.opened_popover(),$("#signup-modal").length>0?this._show_signup_modal():this._create_boxy()},e.prototype._show_signup_modal=function(){return UserSource.remember("download"),SessionModal.pubSub.trigger("signup:show")},e.prototype._create_boxy=function(){return this.boxy&&this.boxy.hide_all(),this.boxy=$w.boxover({iframe:this._build_url(),title:"You must be logged in to download",top:"100px",width:"512px",height:"250px",onclose:function(e){return function(){var t;return null!=(t=e.tracker)?t.closed_popover():void 0}}(this)})},e.prototype._build_url=function(){var e,t;return e="//"+$domain+"/signup_wall",t=[],this.options.redirect_to&&t.push(["cp",encodeURIComponent(this.options.redirect_to)]),t.push(["a_id",this.options.attachment_id]),t.push(["boxy","iframe"]),t.push(["user_source","download"]),this.options.button_location&&t.push(["button_location",this.options.button_location]),$a.build_url(e,t)},e.set_feature_flags=function(){return this._popover_disabled=jQuery.cookie("ab_test_june_2012_5"),null!=this._popover_disabled&&(this._popover_disabled="true"===this._popover_disabled),null==this._popover_disabled?jQuery.ajax({url:$r.api_v0_feature_flags_path({subdomain_param:"api"}),dataType:"json",success:function(e){return function(t){var n;return e._popover_disabled=t.ab_test_june_2012_5,jQuery.cookie("ab_test_june_2012_5",null!=(n=t.ab_test_june_2012_5)?n:!1,{domain:$domain,path:"/",expires:365})}}(this)}):void 0},e}(),c.Documents.DownloadPopover.set_feature_flags()}.call(this),function(){this.c.Documents.DownloadTracker=function(){function e(e){this.notifier=new c.Server.Notification("sutd"),this.options=e}return e.prototype.opened_popover=function(){return $(window).on("unload.sutd",function(e){return function(){return e.closed_window()}}(this)),this.notifier.notify({event_type:"download",location:this.options.button_location,auvid:$auvid,attachment_id:this.options.attachment_id,work_id:"Work"===this.options.asset_type?this.options.asset_id:void 0})},e.prototype.closed_popover=function(){return $(window).off("unload.sutd"),this.notifier.notify({event_type:"download_closed",auvid:$auvid})},e.prototype.closed_window=function(){return this.notifier.notify({event_type:"unload",auvid:$auvid})},e}()}.call(this),function(){var e,t;e=function(e,t,n){return $(document).ready(function(){var i;return null!=t&&(i=$(t)),e.fadeOut("fast",function(){return e.hasClass("js-display-inline-block")?null!=i?i.fadeIn("fast").css("display","inline-block"):void 0:(null!=i&&i.removeClass("hidden"),null!=i?i.fadeIn("fast"):void 0)}),n.fail(function(t){return e.stop(!0,!0),null!=i&&i.stop(!0,!0),e.show(),null!=i&&i.hide(),t.responseText?$w.flash(t.responseText,{nextTo:e,visibleMS:2e3}):void 0})})},t=function(e,t,n){var i,o;return o="follow"===n?{original:"data-follow-user-id",opposite:"data-unfollow-user-id"}:{original:"data-unfollow-user-id",opposite:"data-follow-user-id"},i=_.reject($("["+o.original+"='"+t+"']"),function(){return function(t){return t===e[0]}}(this)),_.each(i,function(){return function(e){var n,i;return i=$(e),n=i.siblings("["+o.opposite+"='"+t+"']").first(),i.addClass("hidden"),n.removeClass("hidden").show()}}(this))},$(document).on("click","*[data-follow-user-id]",function(n){var i,o,r,s;return n.preventDefault(),i=$(n.currentTarget),s=i.data("follow-user-id"),r=i.siblings("[data-unfollow-user-id]")[0],$a.is_logged_in()?(o=Follow.followUser(s,i.data("follow-user-source"),i.data("follow-user-src-details")),e(i,r,o),o.done(function(){return function(){return t(i,s,"follow")}}(this))):void Follow.showSignupToFollow(s,i.data("follow-user-fname"))}),$(document).on("click","*[data-unfollow-user-id]",function(n){var i,o,r,s;if($a.is_logged_in())return n.preventDefault(),i=$(n.currentTarget),s=i.data("unfollow-user-id"),o=i.siblings("[data-follow-user-id]")[0],r=Follow.unfollowUser(s),e(i,o,r),r.done(function(){return function(){return t(i,s,"unfollow")}}(this))}),$(document).on("click","*[data-block-user-id]",function(e){var t,n;if($a.is_logged_in())return t=$(e.currentTarget),n=t.data("block-user-id"),Follow.blockUser(n).done(function(){return window.location.reload()})}),$(document).on("click","*[data-unblock-user-id]",function(t){var n,i,o;if($a.is_logged_in())return n=$(t.currentTarget),o=n.data("unblock-user-id"),i=Follow.unblockUser(o),e(n,"*[data-follow-user-id="+o+"], *[data-block-user-id="+o+"]",i)}),$(document).ready(function(){var e;return $a.is_logged_in()?(e=c.User.current,window.checkNewFollowButtonsOmgImSorry()):void $("*[data-follow-user-id]").removeClass("hidden")}),window.checkNewFollowButtonsOmgImSorry=function(){var e;return e=c.User.current,$("*[data-follow-user-id].hidden, *[data-follow-user-id].btn-hidden").each(function(){var t,n;return t=$(this),n=t.data("follow-user-id"),n===e.id||e.follows(n)?void 0:(t.removeClass("hidden"),t.removeClass("btn-hidden"))}),$("*[data-unfollow-user-id].hidden, *[data-unfollow-user-id].btn-hidden").each(function(){var t,n;return t=$(this),n=t.data("unfollow-user-id"),n!==e.id&&e.follows(n)?(t.removeClass("hidden"),t.removeClass("btn-hidden")):void 0}),$a.is_owner()&&$("*[data-block-user-id].hidden, *[data-block-user-id].btn-hidden").each(function(){var t,n;return t=$(this),n=t.data("block-user-id"),n===e.id||e.follows(n)?void 0:(t.removeClass("hidden"),t.removeClass("btn-hidden"))}),$("*[data-follow-ri-id].hidden, *[data-follow-ri-id].btn-hidden").each(function(){var t,n;return t=$(this),n=t.data("follow-ri-id"),e.has_interest(n)?void 0:(t.removeClass("hidden"),t.removeClass("btn-hidden"))}),$("*[data-unfollow-ri-id].hidden, *[data-unfollow-ri-id].btn-hidden").each(function(){var t,n;return t=$(this),n=t.data("unfollow-ri-id"),e.has_interest(n)?(t.removeClass("hidden"),t.removeClass("btn-hidden")):void 0})},$(document).on("click","*[data-follow-ri-id]",function(t){var n,i,o;return t.preventDefault(),n=$(t.currentTarget),o=n.data("follow-ri-id"),i=FollowRI.follow_ri(o),e(n,"*[data-unfollow-ri-id="+o+"]",i)}),$(document).on("click","*[data-unfollow-ri-id]",function(t){var n,i,o;if($a.is_logged_in())return t.preventDefault(),n=$(t.currentTarget),o=n.data("unfollow-ri-id"),i=FollowRI.unfollow_ri(o),e(n,"*[data-follow-ri-id="+o+"]",i)})}.call(this),function(){window.Academia||(window.Academia={}),window.Academia.openTwitterShareWindow=function(e,t,n){var i,o;return o="http://twitter.com/intent/tweet?text="+encodeURIComponent(e),null!=t&&t.length>0&&(o=o+"&url="+encodeURIComponent(t)),null!=n&&n.length>0&&(o=o+"&via="+encodeURIComponent(n)),i="toolbar=0,scrollbars=1,resizable=1,width=600,height=400",window.open(o,"",i)}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/modals/templates/confirm_modal"]=function(e){var t,n=[],i=e||{};return function(e,i,o,r,s){n.push('<div aria-hidden="true" class="confirm-modal modal fade"><div class="confirm-modal-dialog modal-dialog"><div class="modal-content"><div class="confirm-modal-body modal-body"><button data-dismiss="modal" class="close confirm-modal-close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="text-center"><strong>'+jade.escape(null==(t=r)?"":t)+"</strong></h4>"),s&&n.push('<p class="text-dark">'+jade.escape(null==(t=s)?"":t)+"</p><br/>"),n.push('<div class="row"><div class="col-xs-6"><button data-dismiss="modal" class="js-confirm-modal-cancel-button btn btn-muted btn-lg btn-block">'+jade.escape(null==(t=e)?"":t)+'</button></div><div class="col-xs-6"><button'+jade.cls(["js-confirm-modal-confirm-button","btn","btn-lg","btn-block",i],[null,null,null,null,!0])+">"+jade.escape(null==(t=o)?"":t)+"</button></div></div></div></div></div></div>")}.call(this,"cancelButtonText"in i?i.cancelButtonText:"undefined"!=typeof cancelButtonText?cancelButtonText:void 0,"confirmButtonClasses"in i?i.confirmButtonClasses:"undefined"!=typeof confirmButtonClasses?confirmButtonClasses:void 0,"confirmButtonText"in i?i.confirmButtonText:"undefined"!=typeof confirmButtonText?confirmButtonText:void 0,"mainText"in i?i.mainText:"undefined"!=typeof mainText?mainText:void 0,"subText"in i?i.subText:"undefined"!=typeof subText?subText:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.ConfirmModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="core/sitewide_business_elements/modals/templates/confirm_modal",n.prototype.events={"click .js-confirm-modal-confirm-button":"_confirmClicked","click .js-confirm-modal-cancel-button":"_cancelClicked"},n.prototype.initialize=function(e){return this.options=e,this.successCallback=this.options.successCallback,this.render(),this.$el.appendTo("body"),this.ui={$modal:this.$(".confirm-modal")},this.ui.$modal.on("hidden.bs.modal",function(e){return function(){return e.remove()}}(this)).modal("show"),this},n.prototype.render=function(){return this.$el.append(JST[this.template](this.viewOptions())),this},n.prototype._confirmClicked=function(){return this.ui.$modal.modal("hide"),"function"==typeof this.successCallback&&this.successCallback(),this.trigger("confirm")},n.prototype._cancelClicked=function(){return this.trigger("cancel")},n.prototype.remove=function(){return this.trigger("close"),n.__super__.remove.call(this)},n.prototype.viewOptions=function(){var e,t;return t=_(this.options).pick(["successCallback","mainText","subText","cancelButtonText","confirmButtonText","confirmButtonClasses"]),e={confirmButtonClasses:"btn-danger"},_(e).extend(t)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.AutocompleteSearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={submit:"preventDefault","select2-open":"addOpenStyles","select2-close":"removeOpenStyles"},n.prototype.initialize=function(){return this.ui={$input:this.$(".js-nav-search-input")},this.initializeSelect2(),this.ui.$input.focus(function(e){return function(){return e.showPrompt()}}(this))},n.prototype.initializeSelect2=function(){return this.ui.$input.select2({useExistingInput:!0,closeOnSelect:!0,minimumInputLength:3,matcher:function(){return!0},delay:100,dropdownCssClass:"js-nav-search-results nav-search-results bootstrap",formatResult:function(e){return function(t){return e.formatResult(t)}}(this),formatSelection:function(e){return function(t){return e.redirectToResult(t)}}(this),formatNoMatches:function(e){return function(){return e.formatNoMatches()}}(this),formatInputTooShort:function(e){return function(){return e.formatPrompt()}}(this),formatSearching:function(e){return function(){return e.formatSearching()}}(this),ajax:{url:"/ac_search",dataType:"json",quietMillis:100,data:function(e){return{q:e,limit:20}},results:function(e){return e}}})},n.prototype.addOpenStyles=function(){return this.$el.addClass("nav-search-open"),this.addDropdownArrow(),this.determineResultsHeight()},n.prototype.removeOpenStyles=function(){return this.$el.removeClass("nav-search-open"),this.removeDropdownArrow()},n.prototype.redirectToResult=function(e){return $a.track_single_request({typeahead_hit:!0}),window.location.href=e.entity_url},n.prototype.formatResult=function(e){return this.addViewAllButton(),JST["core/sitewide_business_elements/navbar/templates/search_result"]({result:e})},n.prototype.formatPrompt=function(){var e;return $a.is_logged_in()&&Aedu.User.current.has_rollout_feature("premium_rollout_march_24")&&!Aedu.User.current.premium?(this.formatStatusMessage(),e=JST["core/sitewide_business_elements/navbar/templates/search_advanced_trigger_popover"](),"<div class='DesignSystem text-center'> <div class='u-pt8x u-ph8x'> Type to search for People, Research Interests and Universities </div> <div class='u-p2x u-ph6x'><hr></div> </div> <div class='DesignSystem text-center'> <div class='u-ph8x'> "+e+" <div class='u-mb8x'></div> </div> </div>"):this.formatStatusMessage("Type to search for People, Research Interests and Universities")},n.prototype.formatNoMatches=function(){return this.formatStatusMessage('<i class="fa fa-warning"></i>&nbsp;&nbsp;No matches found')},n.prototype.formatSearching=function(){return this.formatStatusMessage('<i class="fa fa-spinner fa-spin"></i>&nbsp;&nbsp;Searching...')},n.prototype.formatStatusMessage=function(e){return this.removeViewAllButton(),this.determineResultsHeight(),"<div class='text-center padding-8x'>"+e+"</div>"},n.prototype.preventDefault=function(e){return e.isTrigger?void 0:e.preventDefault()},n.prototype.showPrompt=function(){return this.ui.$input.select2("open")},n.prototype.addDropdownArrow=function(){return $(".js-nav-search-results").append('<div class="js-top-search-dropdown-arrow DropdownArrow"></div>')},n.prototype.removeDropdownArrow=function(){return $(".js-top-search-dropdown-arrow.DropdownArrow").remove()},n.prototype.addViewAllButton=function(){var e;return e=$(".js-nav-search-results"),e.find(".js-nav-search-view-all").length>0?void 0:(e.append('<div><a class="ViewAllResults btn padding-vertical-3x btn-block text-uppercase js-nav-search-view-all">View All Results</a></div>'),e.find(".js-nav-search-view-all").click(function(e){return function(t){return $(t.currentTarget).html('<i class="fa fa-spinner fa-spin"></i>'),e.$el.submit()}}(this)))},n.prototype.determineResultsHeight=function(){var e;return e=$(".select2-results"),1===e.find(".select2-no-results").length?e.css("max-height","none"):e.css("max-height","200px")},n.prototype.removeViewAllButton=function(){return $(".js-nav-search-view-all").parent().remove()},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.NavigationController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .js-main-nav-my-account-link":"toggleMyAccountMenu","mouseenter #default-position-button":"hideAll"},n.prototype.initialize=function(e){return null==e&&(e={}),this.showHighlightedNotification=e.showHighlightedNotification,$(function(e){return function(){return e.render()}}(this))},n.prototype.render=function(){return this.ui={$myAccountLink:this.$(".js-main-nav-my-account-link"),$myAccountMenu:this.$(".js-main-nav-my-account-menu"),$notificationsLink:this.$(".js-main-nav-notifications-link-container"),$discussionsMenu:this.$(".js-main-nav-discussions-dropdown-trigger")},this.closeDropdownsOnEscape(),this.initializeMyAccountHover(),this.notificationContainerView=new Aedu.NotificationContainerView({el:this.ui.$notificationsLink,showHighlightedNotification:this.showHighlightedNotification}),this.listenTo(this.notificationContainerView,"closeNavDropdowns",this.hideAll)
},n.prototype.closeDropdownsOnEscape=function(){return $(document).keydown(function(e){return function(t){return 27===t.keyCode?e.hideAll():void 0}}(this))},n.prototype.initializeMyAccountHover=function(){var e,t,n;if(!$a.is_mobile())return n=this.ui,e=n.$myAccountLink,t=n.$myAccountMenu,_.each([e,t],function(n){return function(i){return i.hover(function(){return t.data("hovered",!0),e.hasClass("account_open")?void 0:(n.hideAll(),t.fadeIn(200),e.addClass("account_open"))},function(){return t.data("hovered",!1),_.delay(function(){return t.data("hovered")?void 0:(t.fadeOut(200),e.removeClass("account_open"))},1e3)})}}(this))},n.prototype.toggleMyAccountMenu=function(e){return e.preventDefault(),$a.is_mobile()?this.ui.$myAccountMenu.toggle():void 0},n.prototype.hideAll=function(){return this.ui.$myAccountMenu.hide(),this.ui.$discussionsMenu.parent().removeClass("open"),this.ui.$myAccountLink.removeClass("account_open"),this.notificationContainerView.trigger("closeNotificationDropdown")},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.NotificationContainerView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .js-main-nav-notifications-link":"toggleNotificationsDropdown","click .js-main-nav-notifications-count":"toggleNotificationsDropdown"},n.prototype.initialize=function(e){return this.showHighlightedNotification=e.showHighlightedNotification,this.notificationsDropdownShown=!1,this.render(),this.addSourceToInternalClicks()},n.prototype.render=function(){return this.ui={$notificationsDropdown:this.$(".js-main-nav-notifications-container"),$notificationsContent:this.$(".js-main-nav-notifications-content"),$notificationsCounter:this.$(".js-main-nav-notifications-count"),$notificationsLink:this.$(".js-main-nav-notifications-link")},this.on("closeNotificationDropdown",this.closeDropdown),this.showUnreadNotificationCount()},n.prototype.showUnreadNotificationCount=function(){return $.get($r.unread_count_api_v0_notifications_path({subdomain_param:"api"})).done(function(e){return function(t){var n;return n=t.count,e.ui.$notificationsCounter.text(e.formatCount(n)),e.addNotificationCountToPageTitle(n),e.showHighlightedNotification?e.ui.$notificationsLink.click():void 0}}(this))},n.prototype.formatCount=function(e){return 0===e?"":e>99?"99+":e.toString()},n.prototype.toggleNotificationsDropdown=function(e){return e.preventDefault(),e.stopPropagation(),this.alreadySeen?this.markNotificationsRead():this.alreadySeen=!0,this.showHighlightedNotification?this.showHighlightedNotification=!1:this.notificationsAlreadyInitialized||(this.populateNotificationContent(),this.notificationsAlreadyInitialized=!0),this.resetUnreadNotificationCount(),this.notificationsDropdownShown?this.closeDropdown():(this.trigger("closeNavDropdowns"),this.ui.$notificationsDropdown.fadeIn(200),$("body").on("click.notificationDropdown",function(e){return function(t){return e.clickIsInsideNotificationsDropdown(t)?void 0:e.closeDropdown()}}(this)),this.notificationsDropdownShown=!0)},n.prototype.resetUnreadNotificationCount=function(){return this.ui.$notificationsCounter.html(""),this.removeNotificationsCountFromPageTitle()},n.prototype.markNotificationsRead=function(){return this.ui.$notificationsDropdown.find(".js-notification-popover").addClass("notification-popover-message-is-read").removeClass("notification-popover-message-is-unread")},n.prototype.closeDropdown=function(){return $("body").off("click.notificationDropdown"),this.ui.$notificationsDropdown.hide(),this.notificationsDropdownShown=!1},n.prototype.clickIsInsideNotificationsDropdown=function(e){return $(e.target).closest(".drop_notifications").length>0},n.prototype.addNotificationCountToPageTitle=function(e){return e>0?document.title="("+e+") "+document.title:void 0},n.prototype.removeNotificationsCountFromPageTitle=function(){return document.title=document.title.replace(/^\(\d+\)\s+/,"")},n.prototype.populateNotificationContent=function(){var e;return e=new Aedu.Notifications.Container,this.ui.$notificationsContent.html(e.$el)},n.prototype.addSourceToInternalClicks=function(){return $(".js-notification-popover").on("click","[data-notification-message-type]",function(e){var t;return t=$(e.currentTarget),$a.track_single_request_with_source("notification_popover",{notification_type:t.data("notification-message-type")})})},n}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/navbar/templates/search_advanced_trigger_popover"]=function(e){var t=[],n=e||{};return function(e){t.push('<div class="u-taCenter"><div class="u-tcGray u-textUppercase u-letterSpacing0_5 u-fs13">Introducing</div><div class="u-fs18 u-mv2x u-fw500">Advanced Search</div><div class="u-mb4x">Search for Papers by Keyword, and filter by Position, University, and Research Interests.</div><a'+jade.attr("href",e.upgrade_path({feature:"search"}),!0,!1)+' class="Button Button--md Button--blue">Learn More</a></div>')}.call(this,"$r"in n?n.$r:"undefined"!=typeof $r?$r:void 0),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/navbar/templates/search_result"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div class="media_v2 padding-vertical-1x"><div class="media-left media-middle text-center">'),e.image_url?n.push("<img"+jade.attr("src",e.image_url,!0,!1)+" onerror=\"if (this.src != '/images/tiny_no_pic.png') this.src = '/images/tiny_no_pic.png'\" class=\"avatar-md avatar-rectangle\"/>"):"ResearchInterest"==e.type?n.push('<div class="avatar-md avatar-rectangle valign-wrapper bg-gray-light"><i class="fa fa-tag valign-item text-white"></i></div>'):"University"==e.type&&n.push('<div class="avatar-md avatar-rectangle valign-wrapper bg-gray-light"><i class="fa fa-university valign-item text-white"></i></div>'),n.push('</div><div class="media-body media-middle"><h6 class="text-bold margin-top-0x margin-bottom-0x">'+jade.escape(null==(t=e.display_name)?"":t)+"</h6>"),e.description&&n.push('<small style="width:250px" class="text-gray text-slim text-truncate">'+jade.escape(null==(t=e.description)?"":t)+"</small>"),n.push("</div></div>")}.call(this,"result"in i?i.result:"undefined"!=typeof result?result:void 0),n.join("")}}.call(this),function(){var e=function(){$("#top_banner").is(":visible")&&$("body").css({"background-position":"0px 40px"})},t=function(){$("#top_panel").is(":visible")&&$("body").css({"background-position":"0px 78px"})};$(document).ready(function(){e(),t()})}(),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/research_interest_card/templates/card"]=function(e){var t,n=[],i=e||{};return function(e,i,o){n.push('<div class="clearfix"><div class="ri-card-main js-ri-card-main padding-top-4x padding-horizontal-4x clickable text-center"><a'+jade.attr("href",o.url,!0,!1)+' class="ri-card-name margin-top-3x margin-vertical-1x margin-bottom-1x">'+jade.escape(null==(t=o.name)?"":t)+"</a><div"+jade.attr("data-stats-for-ri",o.id,!0,!1)+' class="ri-card-stats margin-top-4x margin-bottom-3x row"><div class="col-xs-6 padding-vertical-2x ri-col"><strong data-stat="followers_count" class="ri-card-stat-num js-ri-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="ri-card-stat-label"> People</span></div><div class="col-xs-6 padding-vertical-2x ri-col"><strong data-stat="works_count" class="ri-card-stat-num js-ri-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="ri-card-stat-label"> Documents</span></div></div></div><div class="ri-card-actions text-center btn-toolbar">');var r=e.is_logged_in()&&i.User.current.has_interest(o.id);n.push("<a"+jade.attr("data-follow-ri-id",o.id,!0,!1)+' data-follow-ri-source="ri_card"'+jade.attr("style",r?"display: none":!1,!0,!1)+' class="btn btn-primary"><small><i class="fa fa-plus"></i>&nbsp;&nbsp;Follow</small></a><a'+jade.attr("data-unfollow-ri-id",o.id,!0,!1)+jade.attr("style",r?!1:"display: none",!0,!1)+' class="btn btn-primary"><small><i class="fa fa-check"></i>&nbsp;&nbsp;Following</small></a></div></div>')}.call(this,"$a"in i?i.$a:"undefined"!=typeof $a?$a:void 0,"c"in i?i.c:"undefined"!=typeof c?c:void 0,"ri"in i?i.ri:"undefined"!=typeof ri?ri:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;c.ResearchInterestCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.call(this,{html:!0,placement:"bottom",container:this._cardContainer(),show_delay:400,hide_delay:250,content:function(e){return function(){return e._cardContent()}}(this),template:function(){return $($.fn.popover.Constructor.DEFAULTS.template).addClass("popover-hovercard ri-card")}()}),this.ri=null!=this.options.ri?new Aedu.ResearchInterest(this.options.ri):this._findResearchInterestFromContent(),null!=this.ri?(this._initClickable(),this.on_shown=this._showStats):void 0},n.prototype._findResearchInterestFromContent=function(){var e,t,n;return n=this.$el.data("has-card-for-ri"),t=$("*[data-card-contents-for-ri="+n+"]"),t&&(e=t.html())?this.ri=new Aedu.ResearchInterest(JSON.parse(e)):void 0},n.prototype._initClickable=function(){return this.$el.data("bs.popover").tip().on("click",".js-ri-card-main",function(e){return function(t){return t.metaKey||t.ctrlKey?void 0:window.location=e.ri.get("url")}}(this))},n.prototype._showStats=function(e){var t;return t=function(t){return function(n,i){var o;return o="*[data-stats-for-ri="+t.ri.id+"] .js-ri-card-stat-num[data-stat="+n+"]",e.find(o).text($h.commaizeInt(i))}}(this),this.ri.loadFollowersCount().done(function(e){return t("followers_count",e)}),this.ri.loadWorksCount().done(function(e){return"no_count"!==e?t("works_count",e):void 0})},n.prototype._cardContent=function(){return JST["core/sitewide_business_elements/research_interest_card/templates/card"]({ri:this.ri.toJSON()})},n.prototype._cardContainer=function(){return this.$el.parent().is("div, li")&&this.$el.parents(".bootstrap").length?void 0:"#bootstrap-modal-container"},n}(HoverPopover),$a.is_logged_in()&&$a.each_current_and_future("*[data-has-card-for-ri]",function(e){return new c.ResearchInterestCard({el:$(e)})})}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/research_interest_list_card/templates/card"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="clearfix"><ul class="list-group ri-list-card-negative-margin">'),function(){var o=i;if("number"==typeof o.length)for(var r=0,s=o.length;s>r;r++){var a=o[r];if(n.push('<li class="list-group-item padding-top-1x"><div class="text-center btn-toolbar pull-right margin-top-4x ri-list-card-actions">'),e.User.current){var c=e.User.current&&e.User.current.has_interest(a.id);n.push("<a"+jade.attr("data-follow-ri-id",a.id,!0,!1)+' data-follow-ri-source="ri_list_card"'+jade.attr("style",c?"display: none":!1,!0,!1)+' class="btn btn-xs btn-primary"><small><div class="fa fa-plus"></div></small></a><a'+jade.attr("data-unfollow-ri-id",a.id,!0,!1)+jade.attr("style",c?!1:"display: none",!0,!1)+' class="btn btn-xs btn-success-clear"><small><i class="fa fa-check"></i></small></a>')}n.push("</div><span"+jade.attr("data-stats-for-ri",a.id,!0,!1)+"><a"+jade.attr("href",a.get("url"),!0,!1)+' class="margin-top-2x text-truncate link-unstyled h5 margin-bottom-0x padding-bottom-1x padding-right-5x">'+jade.escape(null==(t=a.get("name"))?"":t)+'</a><strong data-stat="followers_count" class="js-ri-card-stat-num ri-card-stat-label"><i class="fa fa-spinner fa-spin"></i></strong><span class="ri-card-stat-label"> People</span></span></li>')}else{var s=0;for(var r in o){s++;var a=o[r];if(n.push('<li class="list-group-item padding-top-1x"><div class="text-center btn-toolbar pull-right margin-top-4x ri-list-card-actions">'),e.User.current){var c=e.User.current&&e.User.current.has_interest(a.id);n.push("<a"+jade.attr("data-follow-ri-id",a.id,!0,!1)+' data-follow-ri-source="ri_list_card"'+jade.attr("style",c?"display: none":!1,!0,!1)+' class="btn btn-xs btn-primary"><small><div class="fa fa-plus"></div></small></a><a'+jade.attr("data-unfollow-ri-id",a.id,!0,!1)+jade.attr("style",c?!1:"display: none",!0,!1)+' class="btn btn-xs btn-success-clear"><small><i class="fa fa-check"></i></small></a>')}n.push("</div><span"+jade.attr("data-stats-for-ri",a.id,!0,!1)+"><a"+jade.attr("href",a.get("url"),!0,!1)+' class="margin-top-2x text-truncate link-unstyled h5 margin-bottom-0x padding-bottom-1x padding-right-5x">'+jade.escape(null==(t=a.get("name"))?"":t)+'</a><strong data-stat="followers_count" class="js-ri-card-stat-num ri-card-stat-label"><i class="fa fa-spinner fa-spin"></i></strong><span class="ri-card-stat-label"> People</span></span></li>')}}}.call(this),n.push("</ul></div>")}.call(this,"Aedu"in i?i.Aedu:"undefined"!=typeof Aedu?Aedu:void 0,"ris"in i?i.ris:"undefined"!=typeof ris?ris:void 0,"undefined"in i?i.undefined:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.ResearchInterestListCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return n.__super__.initialize.call(this,{html:!0,placement:"bottom",container:this._cardContainer(),show_delay:400,hide_delay:250,content:function(e){return function(){return e._cardContent()}}(this),template:function(){return $($.fn.popover.Constructor.DEFAULTS.template).addClass("popover-hovercard ri-list-card")}()}),this.list=this._getResearchInterestListFromOptions(e),null!=this.list&&(this.on_shown=this._showStats),Aedu.Behaviors.ScrollScope.enable(this._popover_el().find(".popover-content"))},n.prototype._getResearchInterestListFromOptions=function(e){var t,n,i,o,r,s;for(s=this.$el.data("remove-ri"),r=[],i=e.work.research_interests,t=0,n=i.length;n>t;t++)o=i[t],o.id!==s&&r.push(new Aedu.ResearchInterest(o));return null!=Aedu.User.current?_(r).sortBy(function(e){return!Aedu.User.current.has_interest(e.id)}):r},n.prototype._showStats=function(e){var t,n,i,o,r;for(i=this.list,o=[],t=0,n=i.length;n>t;t++)r=i[t],o.push(function(){var t;return t="*[data-stats-for-ri="+r.get("id")+"] .js-ri-card-stat-num[data-stat=followers_count]",r.loadFollowersCount().done(function(n){return e.find(t).text($h.commaizeInt(n))})}());return o},n.prototype._cardContent=function(){return JST["core/sitewide_business_elements/research_interest_list_card/templates/card"]({ris:this.list})},n.prototype._cardContainer=function(){return this.$el.parent().is("div, li")&&this.$el.parents(".bootstrap").length?void 0:"#bootstrap-modal-container"},n}(HoverPopover)}.call(this),function(){var e,t,n;window.confirmAccountEmail&&(n=Aedu.User.current,n.banned?n.requested_unflag?t="Your account was flagged as suspicious, and your reconsideration request is awaiting manual review. We're sorry for any inconvenience.":(t="Your account was flagged as suspicious by an automated system. If this was an error, please accept our apologies.",e={"Request Unflagging":function(){return document.location="/user_unflag_requests/new"}}):(t="Please confirm your account. We've sent a confirmation link to "+window.confirmAccountEmail,e={Resend:function(){return $.post("/confirm/send_new_email").done(function(){return document.location="/confirm/sent"})},"Change Email":function(){return document.location="/confirm/sent#email"}}),$(document).ready(function(){return new ConfirmationBanner.BelowNavView({mode:"warning",message:t,actions:e}).render()}))}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/user_card/templates/card"]=function(e){var t,n=[],i=e||{};return function(e,i,o,r){n.push('<div class="clearfix"><div class="user-card-main clickable text-center"><a'+jade.attr("href",o.url,!0,!1)+' class="user-card-photo"><img'+jade.attr("src",o.photo,!0,!1)+jade.attr("alt",o.display_name,!0,!1)+' class="circle s65"/></a><a'+jade.attr("href",o.url,!0,!1)+' class="user-card-name">'+jade.escape(null==(t=o.display_name)?"":t)+"</a>"),o.is_affiliated()?n.push('<div class="user-card-affiliation">'+jade.escape(null==(t=o.department.university.name+", "+o.department.name+", "+o.position)?"":t)+"</div>"):o.has_research_interests()&&n.push('<div class="user-card-affiliation">'+jade.escape(null==(t=r)?"":t)+"</div>"),n.push("<div"+jade.attr("data-stats-for-user",o.id,!0,!1)+' class="user-card-stats row"><div class="col-xs-4"><strong data-stat="followers_count" class="user-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="user-card-stat-label"> Followers</span></div><div class="col-xs-4"><strong data-stat="works_count" class="user-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="user-card-stat-label"> Documents</span></div><div class="col-xs-4"><strong data-stat="views_count" class="user-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="user-card-stat-label"> Views</span></div></div></div><div class="user-card-actions text-center btn-toolbar"><a data-send-message="data-send-message"'+jade.attr("data-recipient-id",o.id,!0,!1)+' class="btn btn-muted logged_in_only"><small><i class="fa fa-envelope"></i>&nbsp;&nbsp;Message</small></a>');var s=e.is_logged_in()&&i.User.current.follows(o.id);n.push("<a"+jade.attr("data-follow-user-id",o.id,!0,!1)+' data-follow-user-source="user_card"'+jade.attr("data-follow-user-fname",o.first_name,!0,!1)+jade.attr("style",s?"display: none":!1,!0,!1)+' class="btn btn-primary"><small><i class="fa fa-plus"></i>&nbsp;&nbsp;Follow</small></a><a'+jade.attr("data-unfollow-user-id",o.id,!0,!1)+jade.attr("style",s?!1:"display: none",!0,!1)+' class="btn btn-primary"><small><i class="fa fa-check"></i>&nbsp;&nbsp;Following</small></a></div></div>')}.call(this,"$a"in i?i.$a:"undefined"!=typeof $a?$a:void 0,"c"in i?i.c:"undefined"!=typeof c?c:void 0,"profile"in i?i.profile:"undefined"!=typeof profile?profile:void 0,"research_interest_sentence"in i?i.research_interest_sentence:"undefined"!=typeof research_interest_sentence?research_interest_sentence:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;c.UserCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return n.__super__.initialize.call(this,{html:!0,placement:"bottom",container:this._card_container(),show_delay:400,hide_delay:250,content:function(e){return function(){return e._card_content()}}(this),template:function(){return $($.fn.popover.Constructor.DEFAULTS.template).addClass("popover-hovercard user-card")}()}),this.user=e.user||this._find_user_from_content(),null!=this.user?(this._init_clickable(),this.on_shown=this._show_stats,this._handle_message_click()):void 0},n.prototype._find_user_from_content=function(){var e,t,n;return n=this.$el.data("has-card-for-user"),t=$("*[data-card-contents-for-user="+n+"]"),t&&(e=t.html())?this.user=c.User.from_json(e):void 0},n.prototype._init_clickable=function(){return this.$el.data("bs.popover").tip().on("click",".user-card-main",function(e){return function(t){return t.metaKey||t.ctrlKey?void 0:window.location=e.user.url}}(this))},n.prototype._handle_message_click=function(){return this.$el.on("shown.bs.popover",function(e){return function(){var t;return t=e.$el.data("bs.popover").tip().find("*[data-send-message]"),t.data("message-view")||t.data("message-view",new Messages.ModalFormView(e.user.id)),t.data("message-view").on("shown",function(){return e.freeze()}),t.data("message-view").on("hidden",function(){return e.unfreeze()})}}(this))},n.prototype._show_stats=function(e){var t;return t=function(t){return function(n,i){var o;return o="*[data-stats-for-user="+t.user.id+"] .user-card-stat-num[data-stat="+n+"]",e.find(o).text($h.commaizeInt(i))}}(this),this.user.load_followers_count().done(function(){return function(e){return t("followers_count",e)}}(this)),this.user.load_works_count().done(function(){return function(e){return t("works_count",e)}}(this)),this.user.load_views_counts().done(function(){return function(e){return t("views_count",e.all_time_stats.documents_count+e.all_time_stats.non_documents_count)}}(this))},n.prototype._card_content=function(){return JST["core/sitewide_business_elements/user_card/templates/card"]({profile:this.user,research_interest_sentence:this._research_interest_sentence()})},n.prototype._card_container=function(){return this.$el.parent().is("div, li")&&this.$el.parents(".bootstrap").length?void 0:"#bootstrap-modal-container"},n.prototype._research_interest_sentence=function(e){var t,n,i,o;return null==e&&(e=2),this.user.has_research_interests()?(t=this.user.interests.length,n=t>e+1?e:t,o=_(this.user.interests).first(n),i=o.map(function(e){return e.name}),t>n&&i.push(t-n+" more interests"),$h.to_sentence(i)):void 0},n}(HoverPopover),$a.is_logged_in()&&$a.each_current_and_future("*[data-has-card-for-user]",function(e){return new c.UserCard({el:$(e)})})}.call(this),function(){this.UserSource={sources:["unknown"],remember:function(e){return this.sources.push(e)},last:function(){return _.last(this.sources)}}}.call(this),function(){this.WorkCreator.startStandalone=function(e,t){var n;return n={cb:encodeURIComponent(window.location.toString().replace(/(#add)$/,"")),section:encodeURIComponent(e)},t&&(n.source=encodeURIComponent(t)),window.location=$r.Papers_Upload_path(n)}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.ResponsiveScribdDocumentView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.zoomPerPixel=null,this.scribdIds=e.scribdIds,this.ui={$loader:this.$(".js-scribd-document-loader"),$container:this.$(".js-scribd-document-container")},this._throttledCheckForPageChange=_.throttle(function(e){return function(){return e._checkForPageChange()}}(this),250),this.tracker=new Aedu.ScribdDocumentTracker(e.attachmentId,this)},n.prototype.show=function(){return this.ui.$loader.show(),this.ui.$container.append("<div id='scribd-reflowable-doc'></div>"),this.scribdDoc=this._getDoc(),this.scribdDoc.addEventListener("docReady",function(e){return function(t){return e._onDocReady(t)}}(this)),$(window).on("scroll.scribd-"+this.scribdIds.docId,function(e){return function(){return e._throttledCheckForPageChange()}}(this))},n.prototype.tear_down=function(){return this.scribdDoc.__remove(),this.scribdDoc=null,$(window).off("scroll.scribd-"+this.scribdIds.docId)},n.prototype._resizeScribd=function(){var e;return null!=this.scribdDoc?(this.trigger("beforeResize"),e=this.zoomPerPixel*this._calculateWidth(),this.scribdDoc.api.setZoom(e),this.trigger("afterResize")):void 0},n.prototype._calculateWidth=function(){var e;return e=$("#scribd-reflowable-doc").outerWidth(),$a.log("scribd document width: ",e),e},n.prototype._onDocReady=function(e){var t;return this.ui.$loader.hide(),t=this.$(".outer_page:first").width(),this.zoomPerPixel=1/t,this._resizeScribd(),$(window).on("resize",function(e){return function(){return e._resizeScribd()}}(this)),this.trigger("docReady",e)},n.prototype._getDoc=function(){var e;return e=scribd.Document.getDoc(this.scribdIds.docId,this.scribdIds.accessKey),e.addParam("jsapi_version",2),e.addParam("disable_related_docs",!0),e.addParam("disable_resume_reading",!0),e.addParam("hideZoomControls",!0),e.seamless("scribd-reflowable-doc"),e},n.prototype._checkForPageChange=function(){var e;if(this.scribdDoc)return e=this.getPage(),this.currentPage!==e?($a.log("Scribd page: "+e+", was: "+this.currentPage),this.trigger("pageChanged",{was:this.currentPage,page:e}),this.currentPage=e):void 0},n.prototype.getPage=function(e){var t;return null==e&&(e=document),t=0,_.each($('[id^="outer_page_"]'),function(e){return $(e).offset().top<$(document).scrollTop()?t++:void 0}),t},n}(Backbone.View)}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};Aedu.ScribdDocumentTracker=function(){function t(t,n){var i;this.attachmentId=t,this.docView=n,_.extend(this,Backbone.Events),this.events=[],this.listenTo(this.docView,"docReady",this.recordDocumentReady),this.listenTo(this.docView,"pageChanged",this.recordPageChange),$(window).on("beforeunload",function(e){return function(){return e.recordUnload()}}(this)),e.call(window.navigator,"sendBeacon")>=0?(this.sendData=window.navigator.sendBeacon,i=15e3):(this.sendData=$.post,i=1e3),this.flushEventsThrottled=_.throttle(function(e){return function(){return e.flushEvents()}}(this),i)}return t.loadedAt=new Date,t.prototype.recordDocumentReady=function(){return this.enqueueEvent("docReady",this.docView.getPage()),this.flushEventsThrottled()},t.prototype.recordPageChange=function(e){return this.enqueueEvent("pageChanged",e.page),this.flushEventsThrottled()},t.prototype.recordUnload=function(){this.enqueueEvent("unload",this.docView.getPage()),this.flushEvents(!1)},t.prototype.enqueueEvent=function(e,t){return this.events.push({event:e,ms_since_load:(new Date).getTime()-this.constructor.loadedAt,page:t})},t.prototype.flushEvents=function(e){return null==e&&(e=!0),this.events.length>0?(!Aedu.hit_data&&e&&setTimeout(function(e){return function(){return e.flushEventsThrottled()}}(this),500),this.sendData($r.api_v0_scribd_events_path({subdomain_param:"api"}),{hit:JSON.stringify(Aedu.hit_data),attachment_id:this.attachmentId,events:JSON.stringify(this.events)}),this.events=[]):void 0},t}()}.call(this),Widgets.BoxOver=Widgets.Base.inherit({widget_name:"BoxOver",url:null,internal_definition:null,type:null,title:null,width:null,height:null,top:null,positioning:null,DEFAULT_TOP:75,DEFAULT_WIDTH:500,DEFAULT_HEIGHT:300,init:function(e){"undefined"!=typeof e.ajax&&(this.type="ajax",this.url=e.ajax),"undefined"!=typeof e.iframe&&(this.type="iframe",this.url=e.iframe),"undefined"!=typeof e.dynamic&&(this.type="dynamic",this.internal_definition=e.dynamic),"undefined"!=typeof e.title&&(this.title=e.title),this.width="undefined"!=typeof e.width?parseInt(e.width,10):this.DEFAULT_WIDTH,this.height="undefined"!=typeof e.height?parseInt(e.height,10):this.DEFAULT_HEIGHT,this.top="undefined"!=typeof e.top?parseInt(e.top,10):this.DEFAULT_TOP,"undefined"!=typeof e.after_hide&&(this.after_hide_callback=e.after_hide),this.onclose="undefined"!=typeof e.onclose?e.onclose:function(){},"absolute"==e.positioning?(this.positioning="absolute",this.top+=$(window).scrollTop()):this.ensure_all_visible(),this.build()},ensure_all_visible:function(){var e=$(window).scrollTop(),t=$(window).height(),n=this.j_element,i=n?n.offset().top-e:this.top,o=n?n.height():this.height;i+o>t?(this.positioning="absolute",this.top+=e):this.positioning="fixed",this.j_element&&this.j_element.css({position:this.positioning,top:this.top})},content_width:function(){return this.width},content_height:function(){return this.height},set_height:function(e,t,n){var i=this,o=i.j_element.find(".container_title_bar").height();this.height=e,t||(t="fast");var r=function(){i.j_element.height(e+o),"fixed"==i.positioning&&i.ensure_all_visible(),n&&"function"==typeof n&&n()};"iframe"===this.type?i.j_element.find("iframe").animate({height:""+i.height+"px"},t,function(){i.j_element.css({height:""+i.height+"px"}),i.j_element.find("table").css({height:""+i.height+"px"}),r()}):i.j_element.animate({height:""+i.height+"px"},t,r)},position:function(){var e=this.j_element.width();this.width&&(e=this.width),this.j_element.css(this.styles(e)),function(t){$(window).on("resize",function(){t.j_element.css(t.styles(e))})}(this),"iframe"===this.type&&(this.j_element.find("table").css({width:""+this.width+"px",height:""+this.height+"px"}),this.j_element.find("iframe").css({width:""+this.content_width()+"px",height:""+this.height+"px"}))},styles:function(e){var t=$(window).width(),n={position:this.positioning,zIndex:100,left:""+(t-e)/2+"px",top:""+this.top+"px",height:""+this.height+"px",width:""+e+"px"};return n},show:function(){var e=this,t=$("#overlay_background");if("ajax"===e.type)e.j_element.find(".container_content").html(""),$.get(e.url,function(n){var i=document.createElement("div");i.innerHTML=n,e.j_element.find(".container_content").append(i),e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut("fast"),e.hide(),e.onclose(),!1}),e.prepare(),e.position(),e.j_element.show(),e.add_to_open_widgets()});else if("iframe"===e.type){e.j_element.find(".container_content").html("");var n=$(document.createElement("iframe"));n.attr("src",e.url),e.j_element.find(".container_content").append(n),e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut("fast"),e.hide(),e.onclose(),!1}),e.prepare(),e.position(),e.j_element.show(),e.add_to_open_widgets(),e.show_wait_view(),n.load(function(){e.show_content_view()})}else"dynamic"===e.type&&(e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut(),e.hide(),e.onclose(),!1}),e.prepare(),e.position(),$("html,body").animate({scrollTop:0},400),e.j_element.show(),e.add_to_open_widgets())},show_wait_view:function(){var e=this;e.j_element.find(".container_content").hide();var t=e.j_element.find(".container_wait_content");t.css({height:""+e.height+"px","background-color":"#ffffff","text-align":"center","padding-top":""+e.content_height()/2+"px"}),t.show()},show_content_view:function(){var e=this;e.j_element.find(".container_wait_content").hide(),e.j_element.find(".container_content").show()},definition:function(){var e=this,t=function(){var t="";return e.internal_definition&&(t=e.internal_definition),null!==e.title?["div.container_center",{valign:"top"},[".container_title_bar",[".container_close.boxover_widget_close",["i",{"class":"fa fa-times icon-dark"},""]],[".container_title",e.title]],[".container_content",t],[".container_wait_content",["i",{"class":"fa fa-spinner fa-spin fa-lg"},""]]]:["div.container_content",{valign:"top"},t]};return["#boxover_widget",t()]},hide_all_and_redirect_to:function(e){this.hide_all(),document.location=e}}),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n=[].slice;$w.modal_box=function(e,t){var n;return null==t&&(t={}),n=new Widgets.ModalBox(e),n.on("shown",function(){return"function"==typeof e.after_show?e.after_show(n):void 0}),n.show(t)},Widgets.ModalBox=function(){function n(e){this._handle_window_keyup=t(this._handle_window_keyup,this),_.extend(this,Backbone.Events),this.title=e.title||"",this.contents=e.contents||"",this.width=e.width||"600px",this.close_on_esc=null!=e.close_on_esc?e.close_on_esc:!0,this._adjust_top_margin_throttled=_.throttle(function(e){return function(){return e._adjust_top_margin()}}(this),200)}return n.prototype.template=_.template("<div class=modal_overlay> <div class=modal_overlay_box> <div class=modal_title_bar> <%= title %> <i class='fa fa-times'></i> </div> <div class='modal_contents clearfix'></div> </div> </div>"),n.prototype.show=function(t){return $("#overlay_background").fadeIn(100,function(n){return function(){return n.$el=$(n.template({title:e(n.title,t)})),n.$el.find(".modal_contents").append(e(n.contents,t)),n.$el.find(".modal_overlay_box").css({width:n.width}),$(window).on("keyup",n._handle_window_keyup),$(window).on("resize",n._adjust_top_margin_throttled),$("body").addClass("no_scroll"),$("body").append(n.$el),n._adjust_top_margin(),n._bind_events(),n.trigger("shown")}}(this)),this},n.prototype.hide=function(){return this.$el.hide(),$("#overlay_background").fadeOut(200,function(e){return function(){return e.$el.remove(),$(window).off("keyup",e._handle_window_keyup),$(window).off("resize",e._adjust_top_margin_throttled),$("body").removeClass("no_scroll"),e.trigger("hidden")}}(this))},n.prototype._handle_window_keyup=function(e){return 27===e.keyCode&&this.close_on_esc?(e.preventDefault(),e.stopPropagation(),this.hide()):void 0},n.prototype._adjust_top_margin=function(){var e,t,n,i;return e=this.$el.find(".modal_overlay_box"),t=e.outerHeight(),i=$(window).height(),0===t?setTimeout(this._adjust_top_margin,200):(n=Math.max((i-t)/2,50),e.css({marginTop:n+"px"}))
},n.prototype._bind_events=function(){return this.$el.on("click",function(e){return function(t){return $(t.target).is(e.$el)?e.hide():void 0}}(this)),this.$el.on("click",".modal_title_bar i",function(e){return function(){return e.hide()}}(this)),this.$el.on("resize_modal",function(e){return function(t){return t.stopPropagation(),e._adjust_top_margin()}}(this)),this.$el.on("hide_modal",function(e){return function(t){return t.stopPropagation(),e.hide()}}(this))},n}(),e=function(){var e,t;return t=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],"function"==typeof t?t.apply(null,e):t}}.call(this),Widgets.Notification=Widgets.Base.inherit({message:"",init:function(e){this.parent.init(e),this.message=e.message,this.build()},definition:function(){return[".notification-widget",[".notification-widget-message",this.message]]}}),_.extend($w,{flash:function(e,t,n){"undefined"==typeof t&&(t={}),t.message=e;var i=Widgets.Notification.create(t);i.flash(n,t)},confirm:function(e,t,n){"undefined"==typeof t&&(t={});var i;return t.message=e,t.onYes=function(){i.fadeOutAndRemove("fast",n)},i=Widgets.YesNo.create(t),i.fadeIn(),i},boxover:function(e){var t=Widgets.BoxOver.create(e);return $("#overlay_background").fadeTo("fast",.6),t.show(),t}}),Widgets.YesNo={message:"Are you sure?",yes:"Confirm",no:"Cancel",create:function(e){function t(){}t.prototype=this;var n=new t;if(e.message&&(n.message=e.message),e.yes&&(n.yes=e.yes),e.no&&(n.no=e.no),e.onYes&&(n.onYes=e.onYes),e.onNo&&(n.onNo=e.onNo),e.nextTo){n.target=e.nextTo;var i=e.down||20,o=e.along||0,r=$(n.target).offset();n.offset={left:r.left+o,top:r.top+i}}else if(e.inCenterOf){n.target=e.inCenterOf;var s=$(n.target),r=s.offset();n.dimensions={width:s.width()/2,height:s.height()/2},n.offset={left:r.left+(s.width()-n.dimensions.width)/2,top:r.top+(s.height()-n.dimensions.height)/2}}return n.raw_el=JSML.transform(["div.yes-no-widget",["div.yes-no-widget-message",n.message],["div.yes-no-widget-buttons",["img.yes-no-spinner",{src:$image_url("spinner.gif"),style:"display: none;"}]," ",["a.no",{href:"#",onclick:function(){return n.onNo.apply(n),!1}},n.no]," ",["a.yes",{href:"#",onclick:function(){return n.onYes.apply(n),!1}},n.yes]]]),n.j_el=$(n.raw_el),n.j_el.css({position:"absolute",left:n.offset.left,top:n.offset.top,"z-index":1e5}),n.dimensions&&n.j_el.css({width:""+n.dimensions.width+"px",height:""+n.dimensions.height+"px"}),e.warning_icon&&$(n.j_el).find(".yes-no-widget-message").prepend($("<i/>").addClass("fa").addClass("fa-exclamation-triangle").css("color","#d43a3a").after("&nbsp;")),n.j_el.hide(),document.body.appendChild(n.raw_el),n},waiting:function(e){e?this.j_el.find(".yes-no-spinner").show():this.j_el.find(".yes-no-spinner").hide()},onNo:function(){return this.fadeOutAndRemove("fast"),!1},fadeIn:function(){this.j_el.fadeIn("fast")},fadeOutAndRemove:function(e,t){var n=this.j_el;n.fadeOut(e,function(){n.remove()}),t&&t()}},function(e){"undefined"==typeof e.fn.each2&&e.fn.extend({each2:function(t){for(var n=e([0]),i=-1,o=this.length;++i<o&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function n(e,t){for(var n=0,i=t.length;i>n;n+=1)if(o(e,t[n]))return n;return-1}function i(){var t=e(B);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function o(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function r(t,n){var i,o,r;if(null===t||t.length<1)return[];for(i=t.split(n),o=0,r=i.length;r>o;o+=1)i[o]=e.trim(i[o]);return i}function s(e){return e.outerWidth(!1)-e.width()}function a(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var o=e.data(n,i);o!==t&&n.val()!==o&&(e.removeData(n,i),n.trigger("keyup-change"))})}function c(n){n.on("mousemove",function(n){var i=j;(i===t||i.x!==n.pageX||i.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function u(e,n,i){i=i||t;var o;return function(){var t=arguments;window.clearTimeout(o),o=window.setTimeout(function(){n.apply(i,t)},e)}}function l(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function d(e,t){var i=u(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){n(e.target,t.get())>=0&&i(e)})}function p(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus(),e.is(":visible")&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},0)}function h(t){t=e(t)[0];var n=0,i=0;if("selectionStart"in t)n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var o=document.selection.createRange();i=document.selection.createRange().text.length,o.moveStart("character",-t.value.length),n=o.text.length-i}return{offset:n,length:i}}function _(e){e.preventDefault(),e.stopPropagation()}function f(e){e.preventDefault(),e.stopImmediatePropagation()}function m(t){if(!O){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);O=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),O.attr("class","select2-sizer"),e("body").append(O)}return O.text(t.val()),O.width()}function g(t,n,i){var o,r,s=[];o=t.attr("class"),o&&(o=""+o,e(o.split(" ")).each2(function(){0===this.indexOf("select2-")&&s.push(this)})),o=n.attr("class"),o&&(o=""+o,e(o.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(r=i(this),r&&s.push(this))})),t.attr("class",s.join(" "))}function v(e,t,n,i){var o=e.toUpperCase().indexOf(t.toUpperCase()),r=t.length;return 0>o?void n.push(i(e)):(n.push(i(e.substring(0,o))),n.push("<span class='select2-match'>"),n.push(i(e.substring(o,o+r))),n.push("</span>"),void n.push(i(e.substring(o+r,e.length))))}function y(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function w(n){var i,o=0,r=null,s=n.quietMillis||100,a=n.url,c=this;return function(u){window.clearTimeout(i),i=window.setTimeout(function(){o+=1;var i=o,s=n.data,l=a,d=n.transport||e.fn.select2.ajaxDefaults.transport,p={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},h=e.extend({},e.fn.select2.ajaxDefaults.params,p);s=s?s.call(c,u.term,u.page,u.context):null,l="function"==typeof l?l.call(c,u.term,u.page,u.context):l,r&&r.abort(),n.params&&(e.isFunction(n.params)?e.extend(h,n.params.call(c)):e.extend(h,n.params)),e.extend(h,{url:l,dataType:n.dataType,data:s,success:function(e){if(!(o>i)){var t=n.results(e,u.page);u.callback(t)}}}),r=d.call(c,h)},s)}}function b(t){var n,i,o=t,r=function(e){return""+e.text};e.isArray(o)&&(i=o,o={results:i}),e.isFunction(o)===!1&&(i=o,o=function(){return i});var s=o();return s.text&&(r=s.text,e.isFunction(r)||(n=s.text,r=function(e){return e[n]})),function(t){var n,i=t.term,s={results:[]};return""===i?void t.callback(o()):(n=function(o,s){var a,c;if(o=o[0],o.children){a={};for(c in o)o.hasOwnProperty(c)&&(a[c]=o[c]);a.children=[],e(o.children).each2(function(e,t){n(t,a.children)}),(a.children.length||t.matcher(i,r(a),o))&&s.push(a)}else t.matcher(i,r(o),o)&&s.push(o)},e(o().results).each2(function(e,t){n(t,s.results)}),void t.callback(s))}}function A(n){var i=e.isFunction(n);return function(o){var r=o.term,s={results:[]};e(i?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===r||o.matcher(r,n))&&s.results.push(e?this:{id:this,text:this})}),o.callback(s)}}function k(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error(n+" must be a function or a falsy value")}function C(t){return e.isFunction(t)?t():t}function T(t){var n=0;return e.each(t,function(e,t){t.children?n+=T(t.children):n++}),n}function $(e,n,i,r){var s,a,c,u,l,d=e,p=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(a=-1,c=0,u=r.tokenSeparators.length;u>c&&(l=r.tokenSeparators[c],a=e.indexOf(l),!(a>=0));c++);if(0>a)break;if(s=e.substring(0,a),e=e.substring(a+l.length),s.length>0&&(s=r.createSearchChoice.call(this,s,n),s!==t&&null!==s&&r.id(s)!==t&&null!==r.id(s))){for(p=!1,c=0,u=n.length;u>c;c++)if(o(r.id(s),r.id(n[c]))){p=!0;break}p||i(s)}}return d!==e?e:void 0}function S(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var x,E,D,R,P,O,N,I,j={x:0,y:0},x={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case x.LEFT:case x.RIGHT:case x.UP:case x.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case x.SHIFT:case x.CTRL:case x.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},B="<div class='select2-measure-scrollbar'></div>";N=e(document),P=function(){var e=1;return function(){return e++}}(),N.on("mousemove",function(e){j.x=e.pageX,j.y=e.pageY}),E=S(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var o,r,s,u,p=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=n.useExistingInput?this.createContainerForExistingInput():this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+P()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=l(function(){return n.element.closest("body")}),n.useExistingInput||g(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(C(n.containerCss)),this.container.addClass(C(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),n.useExistingInput?(this.container.insertBefore(this.opts.element),this.container.prepend(this.opts.element),this.opts.element.addClass("select2-input").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck",!1)):this.opts.element.attr("tabindex","-1").before(this.container),this.opts.element.data("select2",this),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(C(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=o=this.container.find(p),this.search=r=this.container.find("input.select2-input"),this.resultsPage=0,this.context=null,this.initContainer(),c(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",p,this.bind(this.highlightUnderEvent)),d(80,this.results),this.dropdown.on("scroll-debounced",p,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&o.mousewheel(function(e,t,n,i){var r=o.scrollTop();i>0&&0>=r-i?(o.scrollTop(0),_(e)):0>i&&o.get(0).scrollHeight-o.scrollTop()+i<=o.height()&&(o.scrollTop(o.get(0).scrollHeight-o.height()),_(e))}),a(r),r.on("keyup-change input paste",this.bind(this.updateResults)),r.on("focus",function(){r.addClass("select2-focused")}),r.on("blur",function(){r.removeClass("select2-focused")}),this.dropdown.on("mouseup",p,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var s=n.element.prop("disabled");s===t&&(s=!1),this.enable(!s);var u=n.element.prop("readonly");u===t&&(u=!1),this.readonly(u),I=I||i(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus()},destroy:function(){var e=this.opts.element,n=e.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},createContainerForExistingInput:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:o(e.attr("locked"),"locked")||o(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,s,a,c,u=this;if(i=n.element,"select"===i.get(0).tagName.toLowerCase()&&(this.select=s=n.element),s&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,o,r){var s,a=this.opts.id;(s=function(i,o,c){var l,d,p,h,_,f,m,g,v,y;for(i=n.sortResults(i,o,r),l=0,d=i.length;d>l;l+=1)p=i[l],_=p.disabled===!0,h=!_&&a(p)!==t,f=p.children&&p.children.length>0,m=e("<li></li>"),m.addClass("select2-results-dept-"+c),m.addClass("select2-result"),m.addClass(h?"select2-result-selectable":"select2-result-unselectable"),_&&m.addClass("select2-disabled"),f&&m.addClass("select2-result-with-children"),m.addClass(u.opts.formatResultCssClass(p)),g=e(document.createElement("div")),g.addClass("select2-result-label"),y=n.formatResult(p,g,r,u.opts.escapeMarkup),y!==t&&g.html(y),m.append(g),f&&(v=e("<ul></ul>"),v.addClass("select2-result-sub"),s(p.children,v,c+1),m.append(v)),m.data("select2-data",p),o.append(m)})(o,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(a=n.id,n.id=function(e){return e[a]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(s?(n.query=this.bind(function(e){var n,o,r,s={results:[],more:!1},a=e.term;r=function(t,n){var i;t.is("option")?e.matcher(a,t.text(),t)&&n.push(u.optionToData(t)):t.is("optgroup")&&(i=u.optionToData(t),t.children().each2(function(e,t){r(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(o=this.getPlaceholderOption(),o&&(n=n.not(o))),n.each2(function(e,t){r(t,s.results)}),e.callback(s)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(c=n.element.data("ajax-url"),c&&c.length>0&&(n.ajax.url=c),n.query=w.call(n.element,n.ajax)):"data"in n?n.query=b(n.data):"tags"in n&&(n.query=A(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,i){var s=[];e(r(t.val(),n.separator)).each(function(){var t=this,i=this,r=n.tags;e.isFunction(r)&&(r=r()),e(r).each(function(){return o(this.id,t)?(i=this.text,!1):void 0}),s.push({id:t,text:i})}),i(s)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e,n=this.opts.element;n.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e,i=n.prop("disabled");i===t&&(i=!1),this.enable(!i);var e=n.prop("readonly");e===t&&(e=!1),this.readonly(e),g(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(C(this.opts.containerCssClass)),g(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(C(this.opts.dropdownCssClass))}),n.on("propertychange.select2 DOMAttrModified.select2",e),this.mutationCallback===t&&(this.mutationCallback=function(t){t.forEach(e)}),"undefined"!=typeof WebKitMutationObserver&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(this.mutationCallback),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){return e===t&&(e=!0),this._enabled===e?!1:(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface(),!0)},readonly:function(e){return e===t&&(e=!1),this._readonly===e?!1:(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,o,r=this.dropdown,s=this.container.offset(),a=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=r.outerHeight(!1),l=e(window).scrollLeft()+e(window).width(),d=e(window).scrollTop()+e(window).height(),p=s.top+a,h=s.left,_=d>=p+u,f=s.top-u>=this.body().scrollTop(),m=r.outerWidth(!1),g=l>=h+m,v=r.hasClass("select2-drop-above");this.opts.dropdownAutoWidth?(o=e(".select2-results",r)[0],r.addClass("select2-drop-auto-width"),r.css("width",""),m=r.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:I.width),m>c?c=m:m=c,g=l>=h+m):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),p-=t.top,h-=t.left),v?(n=!0,!f&&_&&(n=!1)):(n=!1,!_&&f&&(n=!0)),g||(h=s.left+c-m),n?(p=s.top-u,this.container.addClass("select2-drop-above"),r.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),r.removeClass("select2-drop-above")),i=e.extend({top:p,left:h,width:c},C(this.opts.dropdownCss)),r.css(i)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){function t(){return{width:Math.max(document.documentElement.scrollWidth,e(window).width()),height:Math.max(document.documentElement.scrollHeight,e(window).height())}}var n,i,o=this.containerId,r="scroll."+o,s="resize."+o,a="orientationchange."+o;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),n=e("#select2-drop-mask"),0==n.length&&(n=e(document.createElement("div")),n.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),n.hide(),n.appendTo(this.body()),n.on("mousedown touchstart click",function(t){var n,i=e("#select2-drop");i.length>0&&(n=i.data("select2"),n.opts.selectOnBlur&&n.selectHighlighted({noFocus:!0}),n.close(),t.preventDefault(),t.stopPropagation())})),this.dropdown.prev()[0]!==n[0]&&this.dropdown.before(n),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),i=t(),n.css(i).show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var c=this;this.container.parents().add(window).each(function(){e(this).on(s+" "+r+" "+a,function(){var n=t();e("#select2-drop-mask").css(n),c.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerId,n="scroll."+t,i="resize."+t,o="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(o)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return C(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,n,i,o,r,s,a,c=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return void c.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),i=e(t[n]),o=i.offset().top+i.outerHeight(!0),n===t.length-1&&(a=c.find("li.select2-more-results"),a.length>0&&(o=a.offset().top+a.outerHeight(!0))),r=c.offset().top+c.outerHeight(!0),o>r&&c.scrollTop(c.scrollTop()+(o-r)),s=i.offset().top-c.offset().top,0>s&&"none"!=i.css("display")&&c.scrollTop(c.scrollTop()+s)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){i+=t;var o=e(n[i]);if(o.hasClass("select2-result-selectable")&&!o.hasClass("select2-disabled")&&!o.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var i,o,r=this.findHighlightableChoices();return 0===arguments.length?n(r.filter(".select2-highlighted")[0],r.get()):(t>=r.length&&(t=r.length-1),0>t&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),i=e(r[t]),i.addClass("select2-highlighted"),this.ensureHighlightVisible(),o=i.data("select2-data"),void(o&&this.opts.element.trigger({type:"select2-highlight",val:this.id(o),choice:o})))},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,o=this,r=this.search.val(),s=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:r,page:i,context:s,matcher:this.opts.matcher,callback:this.bind(function(e){o.opened()&&(o.opts.populateResults.call(this,t,e.results,{term:r,page:i,context:s}),o.postprocessResults(e,!1,!1),e.more===!0?(n.detach().appendTo(t).text(o.opts.formatLoadMore(i+1)),window.setTimeout(function(){o.loadMoreIfNeeded()},10)):n.remove(),o.positionDropdown(),o.resultsPage=i,o.context=e.context)})})))},tokenize:function(){},updateResults:function(n){function i(){c.removeClass("select2-active"),d.positionDropdown()}function r(e){u.html(e),i()}var s,a,c=this.search,u=this.results,l=this.opts,d=this,p=c.val(),h=e.data(this.container,"select2-last-term");if((n===!0||!h||!o(p,h))&&(e.data(this.container,"select2-last-term",p),n===!0||this.showSearchInput!==!1&&this.opened())){var _=this.getMaximumSelectionSize();if(_>=1&&(s=this.data(),e.isArray(s)&&s.length>=_&&k(l.formatSelectionTooBig,"formatSelectionTooBig")))return void r("<li class='select2-selection-limit'>"+l.formatSelectionTooBig(_)+"</li>");if(c.val().length<l.minimumInputLength)return r(k(l.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+l.formatInputTooShort(c.val(),l.minimumInputLength)+"</li>":""),void(n&&this.showSearch&&this.showSearch(!0));if(l.maximumInputLength&&c.val().length>l.maximumInputLength)return void r(k(l.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+l.formatInputTooLong(c.val(),l.maximumInputLength)+"</li>":"");l.formatSearching&&0===this.findHighlightableChoices().length&&r("<li class='select2-searching'>"+l.formatSearching()+"</li>"),c.addClass("select2-active"),a=this.tokenize(),a!=t&&null!=a&&c.val(a),this.resultsPage=1,l.query({element:l.element,term:c.val(),page:this.resultsPage,context:null,matcher:l.matcher,callback:this.bind(function(s){var a;return this.opened()?(this.context=s.context===t?null:s.context,this.opts.createSearchChoice&&""!==c.val()&&(a=this.opts.createSearchChoice.call(d,c.val(),s.results),a!==t&&null!==a&&d.id(a)!==t&&null!==d.id(a)&&0===e(s.results).filter(function(){return o(d.id(this),d.id(a))}).length&&s.results.unshift(a)),0===s.results.length&&k(l.formatNoMatches,"formatNoMatches")?void r("<li class='select2-no-results'>"+l.formatNoMatches(c.val())+"</li>"):(u.empty(),d.opts.populateResults.call(this,u,s.results,{term:c.val(),page:this.resultsPage,context:null}),s.more===!0&&k(l.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(l.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(s,n),i(),void this.opts.element.trigger({type:"select2-loaded",items:s}))):void this.search.removeClass("select2-active")})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),i=n.closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children().first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.text()&&""===e.val())return e}},initContainerWidth:function(){function n(){var n,i,o,r,s;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),r=0,s=i.length;s>r;r+=1)if(o=i[r].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==o&&o.length>=1)return o[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}if(!this.opts.useExistingInput){var i=n.call(this);null!==i&&this.container.css("width",i)}}}),D=S(E,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var t,n,i;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),t=this.search.get(0),t.createTextRange?(n=t.createTextRange(),n.collapse(!1),n.select()):t.setSelectionRange&&(i=this.search.val().length,t.setSelectionRange(i,i)),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var t,n=this.container,i=this.dropdown;this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+P()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===x.PAGE_UP||e.which===x.PAGE_DOWN)return void _(e);switch(e.which){case x.UP:case x.DOWN:return this.moveHighlight(e.which===x.UP?-1:1),void _(e);case x.ENTER:return this.selectHighlighted(),void _(e);case x.TAB:return void this.selectHighlighted({noFocus:!0});case x.ESC:return this.cancel(e),void _(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==x.TAB&&!x.isControl(e)&&!x.isFunctionKey(e)&&e.which!==x.ESC){if(this.opts.openOnEnter===!1&&e.which===x.ENTER)return void _(e);if(e.which==x.DOWN||e.which==x.UP||e.which==x.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void _(e)}return e.which==x.DELETE||e.which==x.BACKSPACE?(this.opts.allowClear&&this.clear(),void _(e)):void 0}})),a(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),f(e),this.close(),this.selection.focus())})),t.on("mousedown",this.bind(function(t){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),_(t)})),i.on("mousedown",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){_(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");if(t){var n=this.getPlaceholderOption();this.opts.element.val(n?n.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))
}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection([]),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var e;return(e=this.getPlaceholderOption())!==t&&e.is(":selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val()},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find(":selected");t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=n.val(),s=null;t.query({matcher:function(e,n,i){var a=o(r,t.id(i));return a&&(s=i),a},callback:e.isFunction(i)?function(){i(s)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,r=this;if(this.findHighlightableChoices().each2(function(e,t){return o(r.id(t.data("select2-data")),r.opts.element.val())?(i=e,!1):void 0}),n!==!1&&this.highlight(t===!0&&i>=0?i:0),t===!0){var s=this.opts.minimumResultsForSearch;s>=0&&this.showSearch(T(e.results)>=s)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.close(),t&&t.noFocus||this.selection.focus(),o(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,o=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),o.empty(),n=this.opts.formatSelection(e,o,this.opts.escapeMarkup),n!==t&&o.append(n),i=this.opts.formatSelectionCssClass(e,o),i!==t&&o.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,i=null,o=this,r=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find(":selected").each2(function(e,t){return i=o.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:r});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){o.opts.element.val(e?o.id(e):""),o.updateSelection(e),o.setPlaceholder(),n&&o.triggerChange({added:e,removed:r})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e,n){var i;return 0===arguments.length?(i=this.selection.data("select2-data"),i==t&&(i=null),i):void(e&&""!==e?(i=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:i})):this.clear(n))}}),R=S(E,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitilize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find(":selected").each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var s=r(n.val(),t.separator),a=[];t.query({matcher:function(n,i,r){var c=e.grep(s,function(e){return o(e,t.id(r))}).length;return c&&a.push(r),c},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<s.length;n++)for(var r=s[n],c=0;c<a.length;c++){var u=a[c];if(o(r,t.id(u))){e.push(u),a.splice(c,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},initContainer:function(){var t,n=".select2-choices";this.opts.useExistingInput?this.searchContainer=this.selection=t=this.container:(this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n));var i=this;this.selection.on("mousedown",".select2-search-choice",function(){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+P()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),i=n.prev(".select2-search-choice:not(.select2-locked)"),o=n.next(".select2-search-choice:not(.select2-locked)"),r=h(this.search);if(n.length&&(e.which==x.LEFT||e.which==x.RIGHT||e.which==x.BACKSPACE||e.which==x.DELETE||e.which==x.ENTER)){var s=n;return e.which==x.LEFT&&i.length?s=i:e.which==x.RIGHT?s=o.length?o:null:e.which===x.BACKSPACE?(this.unselect(n.first()),this.searchWidthTen(),s=i.length?i:o):e.which==x.DELETE?(this.unselect(n.first()),this.searchWidthTen(),s=o.length?o:null):e.which==x.ENTER&&(s=null),this.selectChoice(s),_(e),void(s&&s.length||this.open())}if((e.which===x.BACKSPACE&&1==this.keydowns||e.which==x.LEFT)&&0==r.offset&&!r.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void _(e);if(this.selectChoice(null),this.opened())switch(e.which){case x.UP:case x.DOWN:return this.moveHighlight(e.which===x.UP?-1:1),void _(e);case x.ENTER:return this.selectHighlighted(),void _(e);case x.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case x.ESC:return this.cancel(e),void _(e)}if(e.which!==x.TAB&&!x.isControl(e)&&!x.isFunctionKey(e)&&e.which!==x.BACKSPACE&&e.which!==x.ESC){if(e.which===x.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===x.PAGE_UP||e.which===x.PAGE_DOWN)&&_(e),e.which===x.ENTER&&_(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.useExistingInput||this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){if(!this.opts.useExistingInput){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):(this.search.val(""),this.searchWidthTen())}},searchWidthTen:function(){this.opts.useExistingInput||this.search.width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],o=[],r=this;e(t).each(function(){n(r.id(this),i)<0&&(i.push(r.id(this)),o.push(this))}),t=o,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){r.addSelectedChoice(this)}),r.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.searchWidthTen()):this.countSelectableResults()>0?(this.searchWidthTen(),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.searchWidthTen()),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,o,r=!n.locked,s=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=e("<li class='select2-search-choice select2-locked'><div></div></li>"),c=r?s:a,u=this.id(n),l=this.getVal();i=this.opts.formatSelection(n,c.find("div"),this.opts.escapeMarkup),i!=t&&c.find("div").replaceWith("<div>"+i+"</div>"),o=this.opts.formatSelectionCssClass(n,c.find("div")),o!=t&&c.addClass(o),r&&c.find(".select2-search-choice-close").on("mousedown",_).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),_(t))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),c.data("select2-data",n),c.insertBefore(this.searchContainer),l.push(u),this.setVal(l)},unselect:function(e){var t,i,o=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),t&&(i=n(this.id(t),o),i>=0&&(o.splice(i,1),this.setVal(o),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))},postprocessResults:function(e,t,i){var o=this.getVal(),r=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),a=this;r.each2(function(e,t){var i=a.id(t.data("select2-data"));n(i,o)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&i!==!1&&a.highlight(0),!this.opts.createSearchChoice&&!r.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&k(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+a.opts.formatNoMatches(a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-s(this.search)},resizeSearch:function(){if(!this.opts.useExistingInput){var e,t,n,i,o,r=s(this.search);e=m(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,o=n-(t-i)-r,e>o&&(o=n-r),40>o&&(o=n-r),0>=o&&(o=e),this.search.width(o)}},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),r(e,this.opts.separator))},setVal:function(t){if(!this.opts.useExistingInput){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){n(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))}},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)o(this.opts.id(t[n]),this.opts.id(e[i]))&&(t.splice(n,1),n--,e.splice(i,1),i--);return{added:t,removed:e}},val:function(n,i){var o,r=this;if(0===arguments.length)return this.getVal();if(o=this.data(),o.length||(o=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:o}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(o,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,r.id);r.setVal(n),r.updateSelection(t),r.clearSearch(),i&&r.triggerChange(this.buildChangeDetails(o,this.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,o,r=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(o=this.data(),t||(t=[]),i=e.map(t,function(e){return r.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(o,this.data())),void 0)}}),e.fn.select2=function(){var i,o,r,s,a,c=Array.prototype.slice.call(arguments,0),u=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","readonly","positionDropdown","data","search"],l=["val","opened","isFocused","container","data"],d={search:"externalSearch"};return this.each(function(){if(0===c.length||"object"==typeof c[0])i=0===c.length?{}:e.extend({},c[0]),i.element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?a=i.element.prop("multiple"):i.useExistingInput?(i.multiple||i.maximumSelectionSize||(i.maximumSelectionSize=1),a=i.multiple=!0):(a=i.multiple||!1,"tags"in i&&(i.multiple=a=!0)),o=a?new R:new D,o.init(i);else{if("string"!=typeof c[0])throw"Invalid arguments to select2 plugin: "+c;if(n(c[0],u)<0)throw"Unknown method: "+c[0];if(s=t,o=e(this).data("select2"),o===t)return;if(r=c[0],"container"===r?s=o.container:"dropdown"===r?s=o.dropdown:(d[r]&&(r=d[r]),s=o[r].apply(o,c.slice(1))),n(c[0],l)>=0)return!1}}),s===t?this:s},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var o=[];return v(e.text,n.term,o,i),o.join("")},formatSelection:function(e,n,i){return e?i(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(){return t},formatSelectionCssClass:function(){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return(""+t).toUpperCase().indexOf((""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:$,escapeMarkup:y,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:w,local:b,tags:A},util:{debounce:u,markMatch:v,escapeMarkup:y},"class":{"abstract":E,single:D,multi:R}}}}(jQuery),function(){this.Search||(this.Search={})}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/coauthor_search_cant_find"]=function(){var e=[];return e.push('<div class="bootstrap"><div class="select2-footer"><div class="margin-vertical-3x"><p>&nbsp; Can\'t Find Your Co-Author?</p><button type="submit" onclick="jQuery(\'input#authors-input\').trigger(\'select2-footer-clicked\');jQuery(\'input#work-edit-modal-coauthors-input\').trigger(\'select2-footer-clicked\');" class="btn btn-primary text-bold margin-left-4x">Add Co-Author</button></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/create_department"]=function(){var e=[];return e.push('<div id="affiliation-editor-create-department-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-header text-center"><button aria-label="Close" data-dismiss="modal" class="close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Create Department</h4></div><div class="modal-body text-center"><form class="form-inline"><input placeholder="Enter department name..." class="form-control text-slim"/><button type="submit" class="btn btn-primary text-bold margin-left-4x">ADD</button></form></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/create_ri_modal"]=function(){var e=[];return e.push('<div id="ri-search-create-ri-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-header text-center"><button aria-label="Close" data-dismiss="modal" class="close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Create Research Interest</h4></div><div class="modal-body text-center"><form class="form-inline"><input placeholder="Enter a research interest..." class="form-control text-slim"/><button type="submit" class="btn btn-primary text-bold create-ri-submit-btn">ADD</button></form></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/research_interest_result"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="media_v2"><div class="media-body media-middle"><small class="text-truncate">'+jade.escape(null==(t=i.name)?"":t)+'</small></div><div class="media-right"><small class="text-gray text-slim">'+jade.escape(null==(t=e.commaizeInt(i.followers))?"":t)+"&nbsp;"+jade.escape(null==(t=e.pluralize(i.followers,"follower"))?"":t)+"</small></div></div>")}.call(this,"$h"in i?i.$h:"undefined"!=typeof $h?$h:void 0,"ri"in i?i.ri:"undefined"!=typeof ri?ri:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/user_result"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div class="media_v2"><div class="media-left media-middle"><img'+jade.attr("src",e.profile_pic_url,!0,!1)+' onerror="if (this.src != \'/images/s65_no_pic.png\') this.src = \'/images/s65_no_pic.png\';" class="avatar-lg"/></div><div class="select2-user-info media-body media-middle text-truncate"><div class="select2-user-name text-bold">'+jade.escape(null==(t=e.name)?"":t)+'</div><div class="select2-user-university">'+jade.escape(null==(t=e.university)?"":t)+"</div></div></div>")}.call(this,"user"in i?i.user:"undefined"!=typeof user?user:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.Base=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return _.defaults(e,{minimumInputLength:2,matcher:function(){return!0},formatResult:this.formatResult,formatResultCssClass:this.formatResultCssClass,formatSelection:this.formatSelection}),_.defaults(e.ajax,{dataType:"json",quietMillis:100}),this.$el.select2(e).on("change",function(e){return function(t){return e.change(t)}}(this)).on("select2-opening",function(e){return function(){return e.opening()}}(this)).on("select2-open",function(e){return function(){return e.open()}}(this)).on("select2-close",function(e){return function(){return e.close()}}(this)),this.collection?(this.resetData(),this.listenTo(this.collection,"add remove change error",this.resetData,this)):void 0},n.prototype._getDefaults=function(){},n.prototype.change=function(e){var t;return(t=e.added)?this.trigger("item-selected",t):(t=e.removed)?this.trigger("item-removed",t):void 0},n.prototype.currentSearchString=function(){return this.$el.select2("container").find(".select2-search-field input").val()},n.prototype.resetData=function(){return this.$el.select2("data",this.collection.models)},n.prototype.opening=function(){},n.prototype.open=function(){},n.prototype.close=function(){},n.prototype.formatSelection=function(){},n.prototype.formatResult=function(){},n.prototype.formatResultCssClass=function(){},n.prototype.parse=function(){},n.prototype.remove=function(){return this.$el.select2("destroy"),n.__super__.remove.apply(this,arguments)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;this.Search.UserSearch=function(n){function i(){return this.formatResult=e(this.formatResult,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.resultTemplate="search/templates/user_result",i.prototype.initialize=function(e){return _.defaults(e,{tags:[],multiple:!0,ajax:{url:"/users/search",data:function(t){return function(n){return{q:n,hide_users:t._hideUsers().join(","),include_contacts:null!=e?e.includeContacts:void 0,limit:null!=e?e.limit:void 0}}}(this),results:function(e){return function(t){return{results:_.map((null!=t?t.results:void 0)||[],e.parse,e)}}}(this)}}),i.__super__.initialize.apply(this,arguments)},i.prototype._hideUsers=function(){return[$current_user.id]},i.prototype.formatSelection=function(e,t,n){return n(e.get("name"))},i.prototype.formatResult=function(e){return JST[this.resultTemplate]({user:e.toJSON()})},i.prototype.formatResultCssClass=function(){return"select2-user-result bordered-search-result bootstrap"},i.prototype.parse=function(e){var t;return t=new Backbone.Model(e),t.get("profile_pic_url")||t.set("profile_pic_url","/images/s65_no_pic.png"),t.get("id")&&!t.get("university")&&t.set("university","Independent"),t},i}(this.Search.Base)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.CoauthorSearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return _.defaults(e,{includeContacts:!0,placeholder:"Add co-authors...",formatNoMatches:this.trackNoResults,id:function(e){return e.get("email")}}),this.on("item-selected",this.addCoauthor,this),this.on("item-removed",this.removeCoauthor,this),n.__super__.initialize.apply(this,arguments)},n.prototype.opening=function(){var e;return e=JST["search/templates/coauthor_search_cant_find"](),this.$el.select2("container").find("div.select2-drop").append(e)},n.prototype.trackNoResults=function(){return"undefined"!=typeof heap&&null!==heap?heap.track("Coauthor search: no results"):void 0},n.prototype._hideUsers=function(){return this.collection.pluck("tagged_user_id").concat(n.__super__._hideUsers.apply(this,arguments))},n.prototype.addCoauthor=function(e){return this.collection.add(Works.CoauthorTag.fromUserSearch(e))},n.prototype.removeCoauthor=function(e){return this.collection.remove(e)},n}(this.Search.UserSearch)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.CreateDepartment=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="search/templates/create_department",n.prototype.events={"shown.bs.modal":"_focusInput",submit:"_handleSubmit"},n.prototype.render=function(){return this.$el.html(JST[this.template]()),this.$modal=this.$("#affiliation-editor-create-department-modal"),this.$input=this.$("input"),$("body").append(this.$el),this},n.prototype.show=function(e){return this.$input.val(e),this.$modal.modal("show")},n.prototype._handleSubmit=function(e){return e.preventDefault(),this.options.save(this.$input.val()),this.$modal.modal("hide"),!1},n.prototype._focusInput=function(){return this.$input.focus()},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.CreateRIModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="search/templates/create_ri_modal",n.prototype.className="bootstrap",n.prototype.events={"shown.bs.modal":"_focusInput",submit:"_handleSubmit"},n.prototype.render=function(){return this.$el.html(JST[this.template]()),this.$modal=this.$("#ri-search-create-ri-modal"),this.$input=this.$("input"),$("body").append(this.$el),this},n.prototype.show=function(e){return this.$input.val(e),this.$modal.modal("show")},n.prototype._handleSubmit=function(){return this.collection.add(new Backbone.Model({name:this.$input.val(),followers:0})),this.$modal.modal("hide"),!1},n.prototype._focusInput=function(){return this.$input.focus()},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.DepartmentSearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){var t,i;return this.universityId=e.universityId,this.allowCreation=e.allowCreation,t=e.department,(null!=t?t.name:void 0)&&(i={id:t.id||-1,name:t.name}),_.defaults(e,{placeholder:"Department",ajax:{url:"/ac_university_departments/"+this.universityId,data:function(){return function(e){return{q:e}}}(this),results:function(){return function(e){return{results:e.results}}}(this)},initSelection:function(e,t){return i?t(i):void 0}}),this.allowCreation&&(this.createNewView=new Search.CreateDepartment({save:function(e){return function(t){return e.$el.select2("data",{id:-1,name:t},!0)}}(this)}),this.createNewView.render()),n.__super__.initialize.apply(this,arguments),i?this.$el.select2("data",i,!0):void 0},n.prototype.formatSelection=function(e,t,n){return n(e.name)},n.prototype.formatResult=function(e,t,n,i){return i(e.name)},n.prototype.opening=function(){return this.allowCreation?this._addCreateNewButtonToFooter(this.$el.select2("container").find(".select2-drop")):void 0},n.prototype._addCreateNewButtonToFooter=function(e){return e.find("#affiliation-editor-create-department-btn").length>0?void 0:(e.append('<div class="select2-footer"> <a id="affiliation-editor-create-department-btn" class="text-gray-dark">'+I18n.t("department_search.create_new")+"</a> </div>"),e.find("#affiliation-editor-create-department-btn").click(function(e){return function(){return e.createNewView.show(e.currentSearchString()),e.$el.select2("close")}}(this)))},n}(this.Search.Base)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;this.Search.ResearchInterestSearch=function(n){function i(){return this.formatResult=e(this.formatResult,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.resultTemplate="search/templates/research_interest_result",i.prototype.initialize=function(e){return _.defaults(e,{placeholder:"Add a research interest...",multiple:!0,ajax:{url:"/tags/search",data:function(e){return function(t){return{q:t,exclude_tags:JSON.stringify(e.collection.pluck("id"))}}}(this),results:function(e){return function(t){return{results:e._parseSearchResults(t.results)}}}(this)}}),i.__super__.initialize.apply(this,arguments),this.createNewView=new Search.CreateRIModal({collection:this.collection}).render()},i.prototype.opening=function(){return this._addCreateNewButtonToFooter(this.$el.select2("container").find(".select2-drop"))},i.prototype.formatSelection=function(e,t,n){return n(e.get("name"))},i.prototype.formatResult=function(e){return JST[this.resultTemplate]({ri:e.toJSON()})},i.prototype.formatResultCssClass=function(){return"bordered-search-result bootstrap"},i.prototype._parseSearchResults=function(e){return _(e).map(function(e){return new Backbone.Model({id:e.id,name:e.display_name,followers:e.weight})})},i.prototype._addCreateNewButtonToFooter=function(e){return e.append('<div class="bootstrap select2-footer"> <a id="ri-search-create-new-ri" class="text-gray-dark"> Or create a new research interest... </a> </div>'),e.find("#ri-search-create-new-ri").click(function(e){return function(){return e.createNewView.show(e.currentSearchString()),e.$el.select2("close")}}(this))},i}(this.Search.Base)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.UniversitySearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return _.defaults(e,{placeholder:"University",ajax:{url:"/ac_universities",data:function(){return function(e){return{q:e}}}(this),results:function(){return function(e){return{results:e.results}}}(this)},initSelection:function(t,n){var i;return i=e.university,(null!=i?i.id:void 0)&&(null!=i?i.name:void 0)?n({id:i.id,display_name:i.name}):void 0
}}),n.__super__.initialize.apply(this,arguments)},n.prototype.formatSelection=function(e,t,n){return n(e.display_name)},n.prototype.formatResult=function(e,t,n,i){return i(e.display_name)},n}(this.Search.Base)}.call(this),function(){var e;(e=this.Academia).Auth||(e.Auth={})}.call(this),function(){this.Academia.Auth.EmailSignupController=function(){function e(e){this.ds_errors=e.ds_errors,this.track=e.track,this.init_elements(e.elements),this.init_provided_fields(e.fields),e.prevalidate_submit&&this.pre_validate_fields(e.fields),this.notifier=new c.Server.Notification("sutd"),this.init_form(),this.init_link()}return e.prototype.init_elements=function(e){return this.elements={},_.each(e,function(e){return function(t,n){return e.elements[n]=$(t)}}(this))},e.prototype.init_provided_fields=function(e){return _.each(e,function(e){return function(t,n){var i;return i=$(n),null!=t&&i.val(t),e.track?i.on("keypress.tracker",function(t){return i.off("keypress.tracker"),e.notifier.notify({event_type:"started_typing",location:t.target.id,auvid:$auvid})}):void 0}}(this))},e.prototype.pre_validate_fields=function(e){return $(this.elements.form).on("keyup",function(t){return function(){var n,i;return i=_.size(e),n=0,_.each(e,function(e,t){var i;return i=$(t),i.val().length>0?n++:void 0}),i===n?$(t.elements.register_button).removeClass("disabled"):$(t.elements.register_button).addClass("disabled")}}(this))},e.prototype.init_form=function(){return this.elements.form.single_submit_with_callback(function(e){return function(t,n){return e.handle_submission(t,n)}}(this))},e.prototype.submit_url=function(){var e;return e=this.elements.form.attr("action")},e.prototype.handle_submission=function(e,t){var n;return this.track&&this.notifier.notify({event_type:"attempted_submit",auvid:$auvid}),n=this.elements.form.serializeObject(),n.user_source=UserSource.last(),$.ajax({type:"POST",url:this.submit_url(),data:n,dataType:"json",xhrFields:{withCredentials:!0}}).always(function(e){return function(){return e.elements.spinner.hide(),t()}}(this)).done(function(e){return function(t){var n,i,o;return o=t[0],n=t[1],i=t[2],o?e.redirect_on_success(n.redirect):e.handle_validation_errors(i)}}(this)).fail(function(){return function(){return alert("Oops... Something just went wrong! We're taking a look at the issue right now. Please try again in a few minutes.")}}(this)),this.elements.spinner.show(),!1},e.prototype.redirect_on_success=function(e){return null==e&&(e="/StartRegPath"),window.parent.location.href=e},e.prototype.handle_validation_errors=function(e){return $("#signup-modal").length>0||$(".coauthor-verify-modal").length>0?SessionModal.pubSub.trigger("signup:errors",e):this.ds_errors?this.displayErrors(e):($(".inline_error").remove(),_.each(e,function(){return function(e){var t,n,i,o;return o=e[0],n=e[1],i=$("input[name='"+o+"']"),t="<p class='inline_error'>"+n+"</p>",i.addClass("input_error"),i.after(t)}}(this)),this.elements.facebook_success.hide(),$(document).trigger("set_iframe_size"),this.notifier.notify({event_type:"validation_failure",error:JSON.stringify(e),auvid:$auvid}))},e.prototype.init_link=function(){return this.elements.show_form_link.click(function(e){return function(t){return t.preventDefault(),e.elements.connect_buttons.hide(),e.elements.show_form_link.hide(),e.elements.form.show(),$(document).trigger("set_iframe_size"),e.track?e.notifier.notify({event_type:"no_fb",auvid:$auvid}):void 0}}(this))},e.prototype.renderErrorHTML=function(e){return"<div class='js-signup-input-inner-error signup-input-inner-error u-tcRed a-fadeInDownShort u-fs11'>"+e+"</div>"},e.prototype.displayErrors=function(e){var t,n,i,o,r;return t=$('[name="user[email]"]'),n=$('[name="user[first_name]"]'),o=$('[name="user[last_name]"]'),r=$('[name="user[password]"]'),i=t.add(n).add(o).add(r),i.removeClass("TextInput--error").addClass("TextInput--dark").css({"padding-top":0}),$(".js-signup-input-inner-error").remove(),_.each(e,function(e){return function(i){var s,a;return a=i[0],s=i[1],"user[email]"===a&&e.showErrorForInput(t,s),"user[first_name]"===a&&e.showErrorForInput(n,s),"user[last_name]"===a&&e.showErrorForInput(o,s),"user[password]"===a?e.showErrorForInput(r,s):void 0}}(this))},e.prototype.showErrorForInput=function(e,t){return e.addClass("TextInput--error").removeClass("TextInput--dark").after(this.renderErrorHTML(t.replace(/\.$/g,""))).css({"padding-top":10})},e}()}.call(this),function(){this.Academia.Auth.OAuthAdapter=function(){function e(e){_.extend(this,Backbone.Events),this.provider=e}return e.prototype.login=function(e){return null==e&&(e={}),this._authorize().done(function(t){return function(n){var i;return i=$login_protocol+"://"+window.location.host+"/sessions",t._post(i,n,e)}}(this))},e.prototype.register=function(e){return null==e&&(e={}),this._authorize().done(function(t){return function(n){var i,o;return o=$login_protocol+"://"+window.location.host+"/registrations",i=_.extend({user_source:UserSource.last()},e),t._post(o,n,i)}}(this))},e.prototype._authorize=function(){return this.trigger("oauth:attempt"),this._authorizeForProvider().fail(function(e){return function(){return e.trigger("oauth:canceled")}}(this)).done(function(e){return function(){return e.trigger("oauth:authorized")}}(this))},e.prototype._post=function(e,t,n){return $.ajax({type:"POST",url:e,data:_.extend({provider:this.provider,oauth:{token:t.access_token||t.accessToken,expires:t.expires_in||t.expiresIn,scopes:this._scopesForProvider()}},n),dataType:"json",xhrFields:{withCredentials:!0}}).done(function(e){return function(t){var n,i;return i=t[0],n=t[1],i?e.trigger("oauth:success",n):(null!=n?n.email:void 0)?e.trigger("oauth:email_taken",n):e.trigger("oauth:invalid",n)}}(this)).fail(function(e){return function(){return e.trigger("oauth:error")}}(this))},e.prototype._scopesForProvider=function(){var e;switch(this.provider){case"google":return null!=(e=Google.last_successful_auth_response)?e.scope:void 0;case"facebook":return Facebook.scope()}},e.prototype._authorizeForProvider=function(){switch(this.provider){case"google":return Google.authorize();case"facebook":return Facebook.authorize()}},e}()}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Academia.Auth.OauthButton=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}var i;return e(n,t),i=2e3,n.prototype.errorTemplate="auth/templates/oauth_error",n.prototype.events={click:"debouncedHandleClick"},n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.adapter=new Academia.Auth.OAuthAdapter(this.provider()),this.debounceClickHandler(),this.listenToOAuthEvents()},n.prototype.debounceClickHandler=function(){return this.debouncedHandleClick=_.debounce(function(e){return function(t){return e.handleClick(t)}}(this),i,!0)},n.prototype.handleClick=function(e){return e.preventDefault(),this.attemptOAuthConnect()},n.prototype.attemptOAuthConnect=function(){},n.prototype.provider=function(){},n.prototype.listenToOAuthEvents=function(){},n.prototype.prettyProvider=function(){return $h.capitalize(this.provider())},n.prototype.displayError=function(e){var t,n;return null!=(n=this.$errorModal)&&n.remove(),t=JST[this.errorTemplate]({message:e}),$("#bootstrap-modal-container").append(t),this.$errorModal=$("#oauth-error-modal"),this.$errorModal.modal("show")},n.prototype.redirectToLoginWithPrefilledEmail=function(e){return window.parent.location.href=$a.build_url("/login",[["login",e],["email_was_taken",!0],["provider",this.prettyProvider()]])},n}(Backbone.View),Academia.Auth.OauthButton.Login=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.attemptOAuthConnect=function(){return this.adapter.login(this.provider())},n.prototype.listenToOAuthEvents=function(){return this.listenTo(this.adapter,"oauth:success",function(e){return function(){return window.parent!==window?window.parent.location.reload():window.location.href=e.successRedirectUrl()}}(this)),this.listenTo(this.adapter,"oauth:email_taken",function(e){return function(t){return e.redirectToLoginWithPrefilledEmail(t.email)}}(this)),this.listenTo(this.adapter,"oauth:invalid",function(e){return function(){return e.displayError("We couldn't find an Academia.edu account matching your "+e.prettyProvider()+" account.<br/><br/>Please choose a different login method or <a href='/signup'>create an account</a>.")}}(this)),this.listenTo(this.adapter,"oauth:error",function(e){return function(){return e.displayError("Sorry, something went wrong! We're looking into it now.<br/><br/>Please choose a different login method or try again in a few minutes.")}}(this))},n.prototype.successRedirectUrl=function(){return this.$el.closest(".signup_wall").length>0?window.parent.location.href:/\/(login|signup)/.test(document.location.pathname)?"/":document.location.href},n}(Academia.Auth.OauthButton),Academia.Auth.OauthButton.Login.Facebook=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"facebook"},n}(Academia.Auth.OauthButton.Login),Academia.Auth.OauthButton.Login.Google=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"google"},n}(Academia.Auth.OauthButton.Login),Academia.Auth.OauthButton.Connect=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.extraRegParams=(null!=e?e.registrationParams:void 0)||{},n.__super__.initialize.apply(this,arguments)},n.prototype.attemptOAuthConnect=function(){return this.adapter.register(this.extraRegParams)},n.prototype.listenToOAuthEvents=function(){return this.listenTo(this.adapter,"oauth:success",function(){return function(e){return(null!=e?e.redirect:void 0)?window.parent.location.href=e.redirect:window.parent.location.reload()}}(this)),this.listenTo(this.adapter,"oauth:email_taken",function(e){return function(t){return e.redirectToLoginWithPrefilledEmail(t.email)}}(this)),this.listenTo(this.adapter,"oauth:error oauth:invalid",function(e){return function(){return e.displayError("Sorry, something went wrong! We're looking into it now.<br/><br/>Please choose a different signup method or try again in a few minutes.")}}(this)),this.options.track?this.trackEvents():void 0},n.prototype.trackEvents=function(){return this.listenTo(this.adapter,"oauth:attempt",function(e){return function(){return e.notify(e.eventType())}}(this)),this.listenTo(this.adapter,"oauth:success",function(e){return function(){return e.notify(e.eventType()+"_complete")}}(this)),this.listenTo(this.adapter,"oauth:email_taken",function(e){return function(){return e.notify("email_was_taken")}}(this)),this.listenTo(this.adapter,"oauth:canceled",function(e){return function(){return e.notify(e.eventType()+"_cancelled")}}(this))},n.prototype.notify=function(e){return this.notifier||(this.notifier=new c.Server.Notification("sutd")),this.notifier.notify({event_type:e,auvid:$auvid})},n.prototype.eventType=function(){},n}(Academia.Auth.OauthButton),Academia.Auth.OauthButton.Connect.Facebook=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"facebook"},n.prototype.eventType=function(){return"fb_connect"},n}(Academia.Auth.OauthButton.Connect),Academia.Auth.OauthButton.Connect.Google=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"google"},n.prototype.eventType=function(){return"google_connect"},n}(Academia.Auth.OauthButton.Connect)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Academia.Auth.SignupWallController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click #login_button":"handleLogin","click #signup_button":"handleSignup"},n.prototype.initialize=function(){return this.notifier=new c.Server.Notification("sutd"),this.initUi(),this.initResize()},n.prototype.initUi=function(){return this.ui={$signupContainer:this.$("#sign_up_box")}},n.prototype.handleLogin=function(e){var t,n,i;return e.preventDefault(),t=window.parent.location,i=[["cp",t.href]],n=$a.build_url("/login",i),t.href=n},n.prototype.handleSignup=function(e){return e.preventDefault(),this.ui.$signup_container.show(),this.triggerResize(),this.notifier.notify({event_type:"sign_up",auvid:$auvid})},n.prototype.initResize=function(){return $(document).bind("set_iframe_size",function(e){return function(){return e.triggerResize()}}(this))},n.prototype.triggerResize=function(){return top.$(top.document).trigger("resize_boxy",this.newHeight())},n.prototype.newHeight=function(){var e;return e=90,$("body").height()+e},n}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["auth/templates/oauth_error"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div id="oauth-error-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-body"><button aria-label="Close" data-dismiss="modal" class="pull-right close"><span aria-hidden="true">&times;</span></button><div class="padding-4x text-bold">'+(null==(t=e)?"":t)+"</div></div></div></div></div>")}.call(this,"message"in i?i.message:"undefined"!=typeof message?message:void 0),n.join("")}}.call(this),function(){this.Messages={send_message:function(e){var t,n,i;return t=e.data,i=e.success,n=e.error,$.ajax({type:"POST",dataType:"json",url:$r.api_v0_messages_path({subdomain_param:"api"}),data:t,success:i,error:n})},is_blocked:function(e){var t;return t=$r.api_v0_user_blocks_path({user_id:$current_user.id,recipient_id:e,subdomain_param:"api"}),$.ajax(t)}}}.call(this),function(){this.JST||(this.JST={}),this.JST["messages/templates/form"]=function(e){var t=[],n=e||{};return function(n){t.push('<style>.recipient-input .select2-input {\n  width: 520px !important;\n}\n\n</style><form class="new_message DesignSystem"><div class="row"><div class="col-xs-12"><input type="hidden" name="message[sender_id]"'+jade.attr("value",n.id,!0,!1)+"/>"),t.push(e.message_thread_id?'<input type="hidden" name="message[message_thread_id]"'+jade.attr("value",e.message_thread_id,!0,!1)+"/>":'<div class="input recipient"><input type="hidden" name="message[recipient_id]"'+jade.attr("value",e.recipient_id,!0,!1)+' class="recipient-input u-mb5x"/></div>'),t.push('<div class="input body"><textarea rows="4" name="message[body]" class="autoexpand_on_focus TextArea u-mb5x"></textarea></div><button class="Button Button--blue submit-reply-button">Send</button></div></div></form>')}.call(this,"$current_user"in n?n.$current_user:"undefined"!=typeof $current_user?$current_user:void 0),t.join("")}}.call(this),function(){Messages.FormView=function(){function e(e,t){this.data=e,this.success=t,this.placeholder=this.data.placeholder||"Write a message"}return e.prototype.render=function(){return JST["messages/templates/form"](this.data)},e.prototype.after_render=function(e){var t,n,i;return i=e.find(".new_message"),n=i.find(".submit-reply-button"),t=i.find("textarea"),t.attr("placeholder",this.placeholder),t.autosize({callback:function(){return i.trigger("resize_modal")}}),this.data.message_thread_id||new Messages.RecipientFinder(i.find(".recipient-input")),n.on("click",function(e){return function(t){var o;return t.preventDefault(),o=Spinner.small_white_hide_contents(n),Messages.send_message({data:i.serialize(),success:function(){return o.stop(),"function"==typeof e.success?e.success.apply(e,arguments):void 0},error:function(e){var t,i,r;return o.stop(),r=JSON.parse(e.responseText),r.errors&&(i=$a.errors_array(r.errors),t=i[0]),t||(t="Sorry, an error occurred. Please try again."),$w.flash(t,{nextTo:n,visibleMS:2e3})}})}}(this))},e}()}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Messages.ModalFormView=function(t){function n(e){this.form_view=new Messages.FormView({recipient_id:e},function(e){return window.location.href=e.message.message_thread_url}),n.__super__.constructor.call(this,{title:"Send a Message",contents:this.form_view.render(),width:"550px",close_on_esc:!1}),this.on("shown",function(e){return function(){return e.form_view.after_render(e.$el)}}(this))}return e(n,t),n}(Widgets.ModalBox)}.call(this),function(){var e;e=function(e,t,n){var i;return e?(i=t.find("i.fa"),i.addClass("fa-spinner fa-spin"),Messages.is_blocked(e).always(function(){return i.removeClass("fa-spinner fa-spin")}).done(function(e){return e.blocked?$w.flash("You cannot message "+e.name+".",{nextTo:t,visibleMS:2e3}):n()})):void n()},$(document).on("click","*[data-send-message]",function(t){var n,i;return t.preventDefault(),n=$(t.currentTarget),i=n.data("recipient-id"),n.data("message-view")||n.data("message-view",new Messages.ModalFormView(i)),e(i,n,function(){return n.data("message-view").show()})})}.call(this),function(){Messages.RecipientFinder=function(){function e(e){this.el=e,this._initialValue().always(function(e){return function(t){return e._initAutocomplete(null!=t?t.recipient:void 0)}}(this))}return e.prototype._initAutocomplete=function(e){var t;return new Search.UserSearch({el:this.el,placeholder:"Choose a recipient",minimumInputLength:0,maximumSelectionSize:5,limit:25}),this.el.trigger("resize_modal"),t=this.el.data("select2"),e&&t.updateSelection(new Backbone.Model(e)),t.search.on("keyup",function(){return function(e){return 27===e.keyCode?(e.stopPropagation(),t.cancel()):void 0}}(this))},e.prototype._initialValue=function(){var e;return(e=this.el.val())?$.ajax({url:$r.recipient_api_v0_messages_path({id:e,subdomain_param:"api"}),dataType:"json"}):{always:function(e){return e()}}},e}()}.call(this),function(){this.ConfirmationBanner={}}.call(this),function(){this.JST||(this.JST={}),this.JST["confirmation_banner/templates/below_nav_view"]=function(e){var t,n=[],i=e||{};return function(e,i,o,r){n.push("<div"+jade.cls(["confirmation-banner-below-nav","text-center",i],[null,null,!0])+'><span class="h5 text-white text-bold"><i'+jade.cls(["fa",o],[null,!0])+"></i>&nbsp;&nbsp;"+jade.escape(null==(t=r)?"":t)+"</span>"),function(){var i=e;if("number"==typeof i.length)for(var o=0,r=i.length;r>o;o++){var s=i[o];n.push("&nbsp;&nbsp;&nbsp;<a"+jade.attr("data-action",s,!0,!1)+' class="h5 text-white text-bold text-underline clickable">'+jade.escape(null==(t=s)?"":t)+"</a>")}else{var r=0;for(var o in i){r++;var s=i[o];n.push("&nbsp;&nbsp;&nbsp;<a"+jade.attr("data-action",s,!0,!1)+' class="h5 text-white text-bold text-underline clickable">'+jade.escape(null==(t=s)?"":t)+"</a>")}}}.call(this),n.push("</div>")}.call(this,"actions"in i?i.actions:"undefined"!=typeof actions?actions:void 0,"bannerClass"in i?i.bannerClass:"undefined"!=typeof bannerClass?bannerClass:void 0,"iconClass"in i?i.iconClass:"undefined"!=typeof iconClass?iconClass:void 0,"message"in i?i.message:"undefined"!=typeof message?message:void 0,"undefined"in i?i.undefined:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["confirmation_banner/templates/overlay_view"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="top_banner_flash blue"><i class="close">\xd7</i><div class="actions">'),function(){var i=e;if("number"==typeof i.length)for(var o=0,r=i.length;r>o;o++){var s=i[o];n.push("<a"+jade.attr("data-action",s,!0,!1)+' class="action">'+jade.escape(null==(t=s)?"":t)+"</a>")}else{var r=0;for(var o in i){r++;var s=i[o];n.push("<a"+jade.attr("data-action",s,!0,!1)+' class="action">'+jade.escape(null==(t=s)?"":t)+"</a>")}}}.call(this),n.push('</div><p class="message">'+jade.escape(null==(t=i)?"":t)+"</p></div>")}.call(this,"actions"in i?i.actions:"undefined"!=typeof actions?actions:void 0,"message"in i?i.message:"undefined"!=typeof message?message:void 0,"undefined"in i?i.undefined:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;ConfirmationBanner.BelowNavView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.defaultFadeout=1500,n.fadeInTime=250,n.fadeOutTime=500,n.defaultAfter="#main-header-container",n.prototype.className="bootstrap",n.prototype.jstTemplate="confirmation_banner/templates/below_nav_view",n.prototype.events={"click *[data-action]":"actionWasClicked"},n.prototype.initialize=function(e){return this.mode=e.mode,this.message=e.message,this.actions=e.actions||{},this.afterElement=$(e.after||this.constructor.defaultAfter),this.fadeout=e.fadeout,this.fadeout===!0&&(this.fadeout=this.constructor.defaultFadeout),"success"===this.mode?(this.bannerClass="bg-success",this.iconClass="fa-check-circle"):"warning"===this.mode?(this.bannerClass="bg-warning",this.iconClass="fa-exclamation-triangle"):void 0},n.prototype.actionWasClicked=function(e){return this.actions[$(e.target).data("action")](),this.fadeout?this.close():void 0},n.prototype.render=function(){return this.$el.html(JST[this.jstTemplate]({message:this.message,actions:_.keys(this.actions),bannerClass:this.bannerClass,iconClass:this.iconClass})),this.afterElement.after(this.$el).fadeIn(this.constructor.fadeInTime),this.fadeout?this.$el.delay(this.fadeout).fadeOut(this.constructor.fadeOutTime):void 0},n.prototype.close=function(){return this.$el.fadeOut(ConfirmationBanner.BelowNavView.fadeOutTime)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;ConfirmationBanner.OverlayView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.defaultFadeout=1500,n.fadeInTime=250,n.fadeOutTime=500,n.prototype.jstTemplate="confirmation_banner/templates/overlay_view",n.prototype.events={"click .close":"closeWasClicked","click .actions .action":"actionWasClicked"},n.prototype.initialize=function(e){return this.message=e.message,this.actions=e.actions||{},this.fadeout=e.fadeout,this.fadeout===!0?this.fadeout=ConfirmationBanner.OverlayView.defaultFadeout:void 0},n.prototype.closeWasClicked=function(){return this.close()},n.prototype.actionWasClicked=function(e){return this.actions[$(e.target).data("action")](),this.close()},n.prototype.render=function(){return $("#site").before(this.$el.html(JST[this.jstTemplate]({message:this.message,actions:_.keys(this.actions)})).fadeIn(ConfirmationBanner.OverlayView.fadeInTime)),this.fadeout?this.$el.delay(this.fadeout).fadeOut(ConfirmationBanner.OverlayView.fadeOutTime):void 0},n.prototype.close=function(){return this.$el.fadeOut(ConfirmationBanner.OverlayView.fadeOutTime)},n}(Backbone.View)}.call(this),function(){var e;(e=this.Aedu).Notifications||(e.Notifications={})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.Notification=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.view=function(){return{el:this.get("html")}},n}(Backbone.Model)}.call(this),function(){var e,t,n,i;e=function(e){return e.data("bs.popover")?void 0:(new Works.CoauthorTagEdit({el:e,model:new Works.CoauthorTag(e.data("suggested-tag"))}),e.mouseenter())},i=function(e){var t;return t=$("*[data-coauthor-suggestion-notification="+e+"]").data("suggested-tag"),new Works.CoauthorTag(t)},t=function(e){var t;return t=e.data("confirm-coauthor-suggestion"),e.html('<i class="fa fa-spinner fa-spin"></i>'),i(t).save().done(function(){return e.html('<i class="fa fa-check"></i>&nbsp;&nbsp;Confirmed'),$("*[data-dismiss-coauthor-suggestion="+t+"]").parent(".notification-message-dismiss").remove()})},n=function(e){var t;return t=e.data("dismiss-coauthor-suggestion"),e.html('<i class="fa fa-spinner fa-spin"></i>'),i(t).rejectAsSuggestion().done(function(){return e.parents(".panel").fadeOut(),e.parents(".notification-popover").fadeOut()})},$(document).on("mouseenter","*[data-coauthor-suggestion-notification]",function(t){return e($(t.currentTarget))}),$(document).on("click","*[data-confirm-coauthor-suggestion]",function(e){return e.preventDefault(),t($(e.currentTarget))}),$(document).on("click","*[data-dismiss-coauthor-suggestion]",function(e){return n($(e.currentTarget))})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.NotificationCollection=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Aedu.Notifications.Notification,n}(Backbone.Collection)}.call(this),function(){var e;e=function(e){return e.button("loading"),$.ajax({type:"POST",url:$r.api_v0_discussion_audience_invitations_path({subdomain_param:"api",discussion_id:e.data("invitation-id")})}).done(function(){return window.location.replace(e.data("discussion-url"))}).fail(function(){return alert("Failure joining session."),e.button("reset")})},$(document).on("click",".js-notification-join-button",function(t){return t.preventDefault(),e($(t.currentTarget))})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.MostRecentNotifications=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url=$r.api_v0_notifications_path({subdomain_param:"api"}),n.prototype.initialize=function(){return this.set("notifications",new Aedu.Notifications.NotificationCollection)},n.prototype.parse=function(e){return this.get("notifications").add(e.notifications),_.omit(e,"notifications")},n.prototype.fetch=function(e){return e=e||{},this.get("earliest_created_at")&&_.extend(e,{data:{created_before:this.get("earliest_created_at")}}),n.__super__.fetch.call(this,e)},n}(Backbone.Model)}.call(this),function(){this.JST||(this.JST={}),this.JST["notifications/templates/notification_spinner"]=function(){var e=[];return e.push('<div class="js-notifications-spinner"><div class="text-center padding-bottom-4x padding-top-2x"><i class="fa fa-2x fa-spin fa-spinner text-base-color"></i></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["notifications/templates/notifications_container"]=function(e){var t=[],n=e||{};return function(e){t.push('<div id="notifications"><div class="notification-popover"><div class="js-notification-list-location"></div></div><a'+jade.attr("href",e.notifications_url(),!0,!1)+' class="view_all_notifications text-primary">View All Notifications</a></div>')}.call(this,"$r"in n?n.$r:"undefined"!=typeof $r?$r:void 0),t.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.Container=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="notifications/templates/notifications_container",n.prototype.initialize=function(){return this.render()},n.prototype.render=function(){var e;return e=new Aedu.Notifications.ListView,this.$el.html(JST[this.template]()),this.ui={$listLocation:this.$(".js-notification-list-location")},this.ui.$listLocation.html(e.$el)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;Aedu.Notifications.ListView=function(n){function i(){return this.maybeFetchNotifications=e(this.maybeFetchNotifications,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.className="js-notification-list notification-list",i.prototype.initialize=function(){return this.mostRecentNotifications=new Aedu.Notifications.MostRecentNotifications,this.notifications=this.mostRecentNotifications.get("notifications"),this.listenTo(this.notifications,"add",this.addNotification),this.enableScrollScope(),this.$el.scroll(this.maybeFetchNotifications),this.fetchNotifications()},i.prototype.enableScrollScope=function(){return Aedu.Behaviors.ScrollScope.enable(this.$el)},i.prototype.fetchNotifications=function(){return this.appendSpinner(),this.mostRecentNotifications.fetch().success(function(e){return function(){return e.resetScroll(),e.infiniteScrollActive=!e.mostRecentNotifications.get("depleted"),e.removeSpinner(),e.markRead(),e.maybeFetchNotifications()}}(this))},i.prototype.appendSpinner=function(){var e;return e=$(JST["notifications/templates/notification_spinner"]()),this.$el.append(e)},i.prototype.resetScroll=function(){return this.isScrollReset?void 0:(this.el.scrollTop=0,this.isScrollReset=!0)},i.prototype.removeSpinner=function(){return this.$(".js-notifications-spinner").remove()},i.prototype.markRead=function(){var e;return e=this.mostRecentNotifications.get("notification_ids"),$.post($r.mark_read_api_v0_notifications_path({subdomain_param:"api",data:JSON.stringify({ids:e})}))},i.prototype.addNotification=function(e){return this.$el.append(e.view().el)},i.prototype.maybeFetchNotifications=function(){return this.infiniteScrollActive&&this.isNearBottom()?(this.infiniteScrollActive=!1,this.fetchNotifications()):void 0},i.prototype.isNearBottom=function(){var e;return e=20,this.$el.scrollTop()+this.$el.innerHeight()>=this.el.scrollHeight-e},i}(Backbone.View)}.call(this),function(){var e,t,n,i,o,r,s,a,u;u=function(e,t){return e&&e[t]?_.isFunction(e[t])?e[t]():e[t]:null},this.Academia.FormBuilder=n=Backbone.View.extend({tagName:"form",options:{single_click:!0,include_cancel_and_submit:!1},initialize:function(e){return this.fields=[],this.options.record_events_for&&(this.notifier=new c.Server.Notification(this.options.record_events_for)),this.submit_handler=this._generate_submit_handler(e)},add_field:function(e,t){var n;return null==t&&(t={}),t=_.extend({model:this.model,sync_to_model:this.options.sync_to_model},t),n="string"==typeof e?new Academia.FormBuilder.Fields[e](t):new e(t),this.fields.push(n),n},clear_fields:function(){return this.fields=[]},form_data:function(){return this.$el.serializeObject()},process_error_response:function(e){var t,n;try{if(422!==e.status)throw"Unexpected error status";n=JSON.parse(e.responseText).errors}catch(i){t=i,alert("Sorry, there's been an error. Please try again.")}return this.process_error_hash(n)},process_error_hash:function(e){return _.each(this.fields,function(){return function(t){return"function"==typeof t.render_errors?t.render_errors(e[t.name]):void 0}}(this))},render:function(){return this.$el.empty(),this.$el.off("submit"),this.$el.on("submit",this.submit_handler),_.each(this.fields,function(e){return function(t){return e.$el.append(t.render().$el)}}(this)),this.options.include_cancel_and_submit&&this.$el.append('<div class="cancel_or_submit"> <a href="#" class="cancel_link">cancel</a> <input type="submit" class="button blue" value="Save"></input> </div>'),this},_record_event:function(e){return("undefined"!=typeof $a&&null!==$a?$a.log:void 0)&&$a.log(e),null!=this.notifier?this.notifier.notify({event:e,user_id:$current_user.id,source:this.options.source,user_time:parseInt((new Date).getTime()/1e3)}):void 0},save:function(e){var t;return t=this.form_data(),("function"==typeof e.before_submit?e.before_submit(t,e):void 0)!==!1?this.model.save(t,e):void 0},submit:function(){return this.$el.submit()},_generate_submit_handler:function(e){var t,n;return n=!1,t={params:{},before_submit:e.before_submit,success:e.success,error:function(t){return function(i,o){return n=!1,t.process_error_response(o),e.error?e.error.apply(t,arguments):void 0}}(this)},function(i){return function(o){return o.preventDefault(),n&&e.single_click?void 0:(n=!0,i.save(t))
}}(this)}}),e=n.BaseField=Backbone.View.extend({className:"clearfix",inputType:"text",events:{"change input":"sync_changes","keyup  input":"sync_changes","change textarea":"sync_changes","keyup  textarea":"sync_changes","change select":"sync_changes"},initialize:function(e){return this.name=e.name,e.value_fn?this.value=e.value_fn:void 0},focus:function(){return this.$("input, textarea").focus()},human_name:function(){var e;return e=this.options.label||this.name,e.charAt(0).toUpperCase()+e.slice(1)},inputId:function(){var e;return e=this.model.modelName+"_"+this.model.cid+"_"+u(this,"name"),e.replace(/[\[\]]/g,"_")},render:function(){var e;return this.$el.html(""),this.options.label!==!1&&this.$el.append(this._generate_label()),e=$("<div></div>"),e.attr("class","input input_"+u(this,"name")),(this.input=this._generate_input()).appendTo(e),(this.errors=this._generate_errors()).appendTo(e),this.$el.append(e),this},render_errors:function(e){return null==e&&(e=[]),this.errors.html(""),e.length>0?(_.each(e,function(e){return function(t){var n;return n=$('<div class="error_message"></div>'),n.text(e.human_name()+" "+t),n.appendTo(e.errors)}}(this)),this.errors.show()):this.errors.hide()},value:function(e){return"undefined"==typeof e?this.model.get(this.name):this.model.set(this.name,e)},sync_changes:function(){return this.options.sync_to_model?this.value(this.input.val()):void 0},_generate_label:function(){var e;return e=$("<label></label>"),e.attr("for",u(this,"inputId")),e.html(this.human_name()+":"),e},_generate_input:function(){var e;return e=$("<input></input>"),e.attr("name",u(this,"name")),e.attr("type",u(this,"inputType")),e.attr("value",u(this,"value")),e.attr("id",u(this,"inputId")),e.attr("class",this.options.input_class||"")},_generate_errors:function(){var e;return e=$('<div class="error_messages" style="display:none"></div>')}}),s=n.TextareaField=e.extend({render:function(){return e.prototype.render.apply(this,arguments),this},_generate_input:function(){var e;return e=$("<textarea></textarea>"),this.options.no_autoexpand||e.attr("class","autoexpand_on_focus"),e.attr("name",u(this,"name")),e.attr("value",u(this,"value")),e.attr("id",u(this,"inputId")),e.attr("class",this.options.input_class||""),e}}),o=[["January",31],["February",29],["March",31],["April",30],["May",31],["June",30],["July",31],["August",31],["September",30],["October",31],["November",30],["December",31]],t=n.DateEntryField=e.extend({events:{"change input":"sync_changes","change select":"sync_changes"},value_for:function(e){var t;return null!=(t=this.model.get("metadata")[this.options.field_name])?t[e]:void 0},id_for:function(e){return u(this,"inputId")+"_"+e},sync_changes:function(){var e;return this.options.sync_to_model?(e={},_.each(["month","day","year"],function(t){return function(n){return e[n]=t.$("#"+t.id_for(n)).val()}}(this)),this.value(e),this.render()):void 0},_generate_input:function(){var e,t;return t=u(this,"name"),e=$("<div></div>"),e.append(this._generate_month_input(t)),e.append(this._generate_day_input(t)),e.append(this._generate_year_input(t)),$(e.html())},_generate_month_input:function(e){var t,n,i,r,s,a,c,u,l;for(a=parseInt(this.value_for("month")),i=$("<select></select>"),i.attr("class","input_month"),i.attr("name",e+"[month]"),i.attr("id",this.id_for("month")),i.append("<option></option>"),n=r=0,s=o.length;s>r;n=++r)l=o[n],c=l[0],t=l[1],u=$("<option></option>"),u.val(n+1),u.text(c),n+1===a&&u.attr("selected","selected"),u.appendTo(i);return i},_generate_day_input:function(e){var t,n,i,r,s,a,c;if(s=parseInt(this.value_for("month")),t=parseInt(this.value_for("day")),i=$("<select></select>"),i.attr("class","input_day"),i.attr("name",e+"[day]"),i.attr("id",this.id_for("day")),i.append("<option></option>"),!s||isNaN(s))return i;for(n=r=0,c=o[s-1][1];c>=0?c>r:r>c;n=c>=0?++r:--r)a=$("<option></option>"),a.val(n+1),a.text(n+1),n+1===t&&a.attr("selected","selected"),a.appendTo(i);return i},_generate_year_input:function(e){var t;return t=$("<input></input>"),t.attr("class","input_year"),t.attr("name",e+"[year]"),t.attr("type","text"),t.attr("value",this.value_for("year")),t.attr("id",this.id_for("year")),t}}),a=n.TimeEntryField=e.extend({value_for:function(e){var t;return null!=(t=this.model.get("metadata")[this.options.field_name])?t[e]:void 0},id_for:function(e){return u(this,"inputId")+"_"+e},sync_changes:function(){var e;return this.options.sync_to_model?(e={},_.each(["start_hour","end_hour"],function(t){return function(n){return e[n]=t.$("#"+t.id_for(n)).val()}}(this)),this.value(e)):void 0},render:function(){return e.prototype.render.apply(this,arguments),this.$el.addClass("time_entry_container"),this},_generate_input:function(){var e,t;return t=u(this,"name"),e=$("<div></div>"),e.append(this._generate_time_input(t,"start_hour")),e.append(" to "),e.append(this._generate_time_input(t,"end_hour")),$(e.html())},_generate_time_input:function(e,t){var n,i,o,r;for(i=$("<select></select>"),i.attr("class","time_entry"),i.attr("name",e+"["+t+"]"),i.attr("id",this.id_for(t)),i.append("<option></option>"),n=o=0;23>=o;n=++o)r=$("<option></option>"),r.val(n),r.text(0===n?"12 am":12>n?n+" am":12===n?"12 pm":n-12+" pm"),n===this.value_for(t)&&r.attr("selected","selected"),r.appendTo(i);return i}}),r=n.SelectField=e.extend({_generate_input:function(){var e;return e=$("<select></select>"),e.attr("name",u(this,"name")),e.attr("id",u(this,"inputId")),e.attr("class",this.options.input_class||""),this._generate_options(e,u(this,"value")),e},_generate_options:function(e,t){var n;return n=this.options.options||[],_.each(n,function(){return function(n){var i;return i=$("<option></option>"),i.attr("value",n.value),n.value===t&&i.attr("selected","selected"),i.html(n.label||n.value),i.appendTo(e)}}(this))}}),i=n.HiddenField=Backbone.View.extend({className:"hidden",initialize:function(e){return this.value=e.value,this.name=e.name},render:function(){var e;return this.$el.html(""),e=$('<input type="hidden"/>'),e.attr("value",this.value),e.attr("name",this.name),this.$el.append(e),this}}),this.Academia.FormBuilder.Fields={string:e,integer:e,text:s,date:e,timestamp:e,"boolean":e,date_entry:t,time_entry:a,select:r,hidden:i}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Academia.PopoverWidget=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="popover",n.prototype.wrapper=_.template('<span class="arrow"></span><%= content %>'),n.prototype.events={click:"stopPropagation"},n.prototype.initialize=function(){var e;if(n.__super__.initialize.apply(this,arguments),this.properties||(this.properties={}),!this.options.element)throw"Must pass an element to create a popover widget";return(e=this.options).position||(e.position="right")},n.prototype.render=function(e){var t;return null==e&&(e={}),t=this.template||JST[this.jstTemplate],e.template=function(e){return function(n){return e.wrapper({content:t(n)})}}(this),n.__super__.render.call(this,_.extend(e,this.properties)),_.defer(function(e){return function(){return e.bind_removes()}}(this)),this},n.prototype.render_and_show=function(){return this.render.apply(this,arguments).$el.insertAfter(this.options.container||this.options.element),this.position(),this},n.prototype.position=function(){var e;return this.$el.addClass(this.options.position),"right"===this.options.position?(this.$el.css("left",this.options.element.position().left+this.options.element.width()+10),this.$el.css("top",this.options.element.position().top+parseInt(this.options.element.css("margin-top"))+this.options.element.innerHeight()/2-18)):(e=this.options.element.position().left,e>505?(this.$el.css("left",e-this.$el.width()/1.5),this.$el.addClass("two_thirds")):(this.$el.css("left",e-this.$el.width()/3),this.$el.addClass("one_third")),this.$el.css("top",this.options.element.position().top+23))},n.prototype.bind_removes=function(){return this.remove_on_external_click(),this.remove_on_esc_key_up()},n.prototype.remove_on_external_click=function(){return $(document).click(function(e){return function(){return e.remove()}}(this))},n.prototype.remove_on_esc_key_up=function(){return $(document).keyup(function(e){return function(t){return 27===t.keyCode?e.remove():void 0}}(this))},n.prototype.stopPropagation=function(e){return e.stopPropagation()},n}(Academia.View),this.Academia.PopoverHoverWidget=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.bind_removes=function(){return this.remove_on_mouseout(),this.remove_on_esc_key_up()},n.prototype.remove_on_mouseout=function(){var e,t,n,i;return i=null,e=function(){return function(){return null!=i?(clearTimeout(i),i=null):void 0}}(this),t=function(){return function(){return i||(i=setTimeout(n,200))}}(this),n=function(e){return function(){return e.$el.fadeOut(100,function(){return e.remove(),e.options.element.off("mouseenter"),e.options.element.off("mouseleave")})}}(this),this.$el.on("mouseenter",e),this.$el.on("mouseleave",t),this.options.element.on("mouseenter",e),this.options.element.on("mouseleave",t)},n}(Academia.PopoverWidget)}.call(this),function(){var e,t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.app=window.app||{},app.models=app.models||{},app.views=app.views||{},app.config=app.config||{},app.config.max_file_size=104857600,app.config.max_file_name_length=125,app.config.accepted_file_types=["pdf","txt","ps","rtf","epub","odt","odp","ods","odg","odf","sxw","sxc","sxi","sxd","doc","ppt","pps","xls","docx","pptx","ppsx","xlsx","csv","tsv"],Academia.BasicUploader=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.template=_.template('<button class="button upload"><%= button_text %></button> <input type=file <%= multiple %>>'),i.prototype.elements={uploader:"input[type=file]",upload_button:"button"},i.prototype.initialize=function(){var e,t;return i.__super__.initialize.apply(this,arguments),(e=this.options).max_size||(e.max_size=app.config.max_file_size),(t=this.options).button_text||(t.button_text="Upload"),req("jquery.fileupload")},i.prototype.render=function(){return i.__super__.render.call(this,{defaults:{button_text:this.options.button_text,multiple:this.options.multiple?"multiple":""}}),this._fix_min_width_and_height(),req("jquery.fileupload",function(t){return function(){var n;return t.$els.uploader.fileupload({url:t.options.url,dataType:"json",formData:{document_domain:$no_document_domain?null:document.domain},dropZone:("function"==typeof(n=t.options).drop_zone?n.drop_zone():void 0)||t.$el,add:function(n,i){return t.options.max_size&&!t._size_ok(i.files[0])||t.options.file_types&&!t._file_type_ok(i.files[0])?void 0:i.files[0].name.length>125?void alert("Sorry, your file name is too long to upload. Please shorten to 125 characters or less."):(i.uploading_file=new e(i),i.submit(),t._record_event("upload_started"),t.trigger("add",i.uploading_file))},progress:function(e,t){return t.uploading_file.trigger("progress",t.progress())},done:function(e,t){return t.uploading_file.trigger("done",t)},fail:function(e,n){return t._record_event("upload_failed",$a.fileUploadErrorString(n),"basic_uploader"),n.uploading_file.trigger("fail",n)}})}}(this))},i.prototype.set_button_html=function(e){return this.$els.upload_button.html(e)},i.prototype.show_spinner=function(){var e;return e=$image_url("loaders/loader-green.gif"),this.set_button_html("<img src='"+e+"'>")},i.prototype.reset_button_html=function(){return this.$els.upload_button.html(this.options.button_text)},i.prototype._fix_min_width_and_height=function(){var e,t;return t=this.$els.upload_button.outerWidth(),e=this.$els.upload_button.outerHeight(),t>0&&e>0?(this.$els.upload_button.css("min-width",t),this.$els.upload_button.css("min-height",e)):setTimeout(function(e){return function(){return e._fix_min_width_and_height()}}(this),500)},i.prototype._size_ok=function(e){return e.size>this.options.max_size?(this.trigger("maximum_file_size_exceeded"),!1):!0},i.prototype._file_type_ok=function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.options.file_types,t)?!0:(this.trigger("invalid_file_type",t),this._report_invalid_extensions_upload_attempt(t),!1)},i.prototype._report_invalid_extensions_upload_attempt=function(e){var t;return t=$r.record_invalid_extension_api_v0_attachments_path({subdomain_param:"api"}),$.post(t,{extensions:[e]})},i}(Academia.View),e=function(){function e(e){this.file=e.files[0]}return _.extend(e.prototype,Backbone.Events),e}(),Academia.Uploader=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.className="uploader",n.prototype.template=_.template("<div class='errors'> <p class='file_size_warning'>Please choose a smaller file<%= max_size_message %>.</p> <p class='file_type_warning'>Sorry, we don't support that file type.</p> <p class='server_error_warning'> Sorry, something went wrong! Your upload may or may not have finished. Please refresh the page, and try again if the uploaded file does not appear. </p> </div> <div class='upload_container'></div> <div class='progress_bar'> <div class='progress'>&nbsp;</div> </div>"),n.prototype.elements={upload_container:".upload_container",upload_button:"button",upload_progress:".progress",progress_bar:".progress_bar",file_size_warning:".file_size_warning",file_type_warning:".file_type_warning",server_error_warning:".server_error_warning"},n.prototype.initialize=function(){var e;return n.__super__.initialize.apply(this,arguments),"allow_multiple"in this.options||(this.options.allow_multiple=!0),(e=this.options).max_size||(e.max_size=app.config.max_file_size),this._create_uploader()},n.prototype.render=function(){return n.__super__.render.call(this,{defaults:{max_size_message:this._max_size_message(this.options.max_size)}}),this.uploader.setElement(this.$els.upload_container).render(),this},n.prototype.render_and_insert=function(e,t){return null==t&&(t="insertAfter"),this.render(),this.$el[t](e),this},n.prototype.reset=function(){return this.$els.progress_bar.hide(),this.$els.file_size_warning.hide(),this.$els.file_type_warning.hide(),this.$els.server_error_warning.hide(),this.uploader.reset_button_html()},n.prototype.update_upload_progress=function(e){return this.$els.progress_bar.show(),this.$els.upload_progress.css("width",e+"%"),this.uploader.set_button_html(e>=100?"99%":e+"%")},n.prototype.upload_complete=function(){return this.$els.progress_bar.hide(),this.uploader.set_button_html('<i class="fa fa-ok"></i>')},n.prototype._create_uploader=function(){return this.uploader=this.options.uploader||this._create_basic_uploader(),this.uploader.on("add",function(e){return function(t){return e._add(t)}}(this)),this.uploader.on("maximum_file_size_exceeded",function(e){return function(){return e.trigger("maximum_file_size_exceeded"),e.$els.file_size_warning.show()}}(this)),this.uploader.on("invalid_file_type",function(e){return function(t){return e.trigger("invalid_file_type",t),e.$els.file_type_warning.show()}}(this))},n.prototype._add=function(e){return this.options.add&&this.options.add(),this.uploader.show_spinner(),this.options.uploading&&this.options.uploading(this),this.options.disable_during_upload&&$(this.options.disable_during_upload()).attr("disabled","disabled"),e.on("progress",function(e){return function(t){return e._progress(t)}}(this)),e.on("done",function(e){return function(t){return e._done(t)}}(this)),e.on("fail",function(e){return function(){return e._failure()}}(this))},n.prototype._progress=function(e){var t;return t=parseInt(e.loaded/e.total*100,10),this.update_upload_progress(t)},n.prototype._done=function(e){return this.upload_complete(),this.options.done&&this.options.done(e,this),this.options.disable_during_upload&&$(this.options.disable_during_upload()).removeAttr("disabled"),this.options.allow_multiple?setTimeout(function(e){return function(){return e.reset()}}(this),2e3):void 0},n.prototype._failure=function(){return this.reset(),this.$els.server_error_warning.show()},n.prototype._create_basic_uploader=function(){return new Academia.BasicUploader(_.pick(this.options,"url","button_text","multiple","max_size","file_types"))},n.prototype._max_size_message=function(e){return" (less than "+window.$h.humanFileSize(e)+")"},n}(Academia.View),Academia.BasicUploader.WorkAttachments=function(e){function n(e){var t;this.work_id=e.work_id,delete e.work_id,this.source=e.source,t={multiple:!0,max_size:app.config.max_file_size,file_types:app.config.accepted_file_types,url:this._attachment_url()},e=_.extend({},t,e),n.__super__.constructor.call(this,e)}return t(n,e),n.prototype._attachment_url=function(){var e;return e={work_id:this.work_id,subdomain_param:"api"},this.source&&(e.source=this.source),$r.api_v0_attachments_path(e)},n}(Academia.BasicUploader),app.views.Uploader_v2=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.max_file_size=e.max_file_size||app.config.max_file_size,this.max_file_name_length=e.max_file_name_length||app.config.max_file_name_length,this.accepted_file_types=e.accepted_file_types||app.config.accepted_file_types,this.notifier=e.event_recorder,req("jquery.fileupload",function(t){return function(){return e.input.fileupload({url:e.url||t._attachment_url(e.work_id,e.source),dataType:"json",formData:{document_domain:$no_document_domain?null:document.domain},dropZone:e.dropZone,add:function(e,n){var i,o;return i=n.files[0],(o=t._validate_file(i))?void t.trigger("error",o,i):(n.submit(),t._record_event("upload_started"),t.trigger("add",i))},progress:function(e,n){var i,o;return o=n.files[0],null!=(i=o.model)&&i.trigger("progress",n.progress()),t.trigger("progress",n.progress())},done:function(e,n){var i,o;return o=n.files[0],null!=(i=o.model)&&i.trigger("done",n),t.trigger("done",n)},fail:function(e,n){var i,o;return o=n.files[0],null!=(i=o.model)&&i.trigger("fail",n),t.trigger("fail",n),t._record_event("upload_failed",$a.fileUploadErrorString(n),"v2_uploader")}})}}(this))},n.prototype._validate_file=function(e){var t;return t=_.compact([this._validate_file_size(e),this._validate_file_type(e),this._validate_file_name_length(e)]),0!==t.length?t:void 0},n.prototype._validate_file_size=function(e){return e.size>this.max_file_size?{file_size:e.size}:void 0},n.prototype._validate_file_name_length=function(e){return e.name.length>this.max_file_name_length?{file_name_length:e.name.length}:void 0},n.prototype._validate_file_type=function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.accepted_file_types,t)?void 0:{file_type:t}},n.prototype._attachment_url=function(e,t){var n;return n={work_id:e,subdomain_param:"api"},t&&(n.source=t),$r.api_v0_attachments_path(n)},n.prototype._record_event=function(e,t,n){return("undefined"!=typeof $a&&null!==$a?$a.log:void 0)&&$a.log(e),null!=this.notifier?this.notifier.notify({event:e,user_id:$current_user.id,source:n||this.options.source,error:t,user_time:parseInt((new Date).getTime()/1e3)}):void 0},n}(Backbone.View)}.call(this),function(){this.Works||(this.Works={}),Works.works=function(){var e;return e=new Works.Works,Works.works=function(){return e},e}}.call(this),Works.FIELDS=[{name:"more_info",label:"More Info",type:"string"},{name:"abstract",label:"Abstract",type:"text"},{name:"publication_name",label:"Publication Name",type:"string"},{name:"publication_date",label:"Publication Date",type:"date_entry"},{name:"publisher",label:"Publisher",type:"string"},{name:"organization",label:"Organization",type:"string"},{name:"location",label:"Location",type:"string"},{name:"event_date",label:"Event Date",type:"date_entry"},{name:"conference_start_date",label:"Conference Start Date",type:"date_entry"},{name:"conference_end_date",label:"Conference End Date",type:"date_entry"},{name:"time",label:"Time",type:"time_entry"},{name:"journal_name",label:"Journal Name",type:"string"}],Works.SECTIONS={Books:{noun:"book",doc_type:"book",suggested_fields:["abstract","more_info","publication_date","publisher"],og_icon:"open-graph-icons/fb-book.gif",og_type:"book"},Papers:{noun:"paper",doc_type:"paper",suggested_fields:["abstract","more_info","publication_name","publication_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},Talks:{noun:"talk",doc_type:"talk",suggested_fields:["abstract","organization","location","time","event_date"],og_icon:"open-graph-icons/fb-talk.gif",og_type:"article"},"Teaching Documents":{noun:"teaching document",doc_type:"teaching_document",suggested_fields:["more_info","abstract","location","event_date"],og_icon:"open-graph-icons/fb-teaching.gif",og_type:"article"},Drafts:{noun:"draft",doc_type:"draft",suggested_fields:["abstract","more_info"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},"Book Reviews":{noun:"book review",doc_type:"book_review",suggested_fields:["abstract","more_info","publication_name","publication_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},"Conference Presentations":{noun:"conference presentation",doc_type:"conference_presentation",suggested_fields:["abstract","journal_name","location","time","event_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},"Thesis Chapters":{noun:"thesis chapter",doc_type:"thesis_chapter",suggested_fields:["abstract","more_info","completion_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},Other:{noun:"document",doc_type:"other",suggested_fields:["abstract","more_info","publication_name","publication_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"}},function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.Attachment=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.routeKey="api_v0_attachment",n}(Academia.Model)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};Works.AttachmentParser=function(){function t(t){this._run=e(this._run,this),this.stop=e(this.stop,this),this.run=e(this.run,this),this.attachment_id=t.attachment_id,this.timeout=t.timeout,this.promise=new $.Deferred,this.url=$r.parsed_attributes_api_v0_attachment_path({id:this.attachment_id,subdomain_param:"api",title_only:!0})}return t.prototype.run=function(){return this.stopped=!1,this._run(),null!=this.timeout&&setTimeout(this.stop,this.timeout),this.promise},t.prototype.stop=function(){return this.stopped=!0,this.promise.reject()},t.prototype._run=function(){return $.get(this.url,function(e){return function(t){return e.stopped?void 0:e.promise.resolve(t.title)}}(this))},t}()}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.Authorship=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.modelName="authorship",n.prototype.routeKey="api_v0_work_authorship",n.prototype.urlArgs=function(){return this.user_id!==$current_user.id?{user_id:this.user_id(),work_id:this.work_id()}:{work_id:this.work_id()}},n.prototype.change_section=function(e,t){var n,i;return i=this.section(),n=NewProfile.sections().by_name(e),$a.admin_log("Move work",this.work_id(),"from section",i.get("name"),"to section",e),$.ajax({url:this.url(),type:"POST",data:{section_name:e,_method:"PUT"},success:function(o){return function(r){return o.set("section",{name:e}),i.decrement_count(),null!=n&&n.increment_count(),"function"==typeof t?t(r):void 0}}(this)})},n.prototype.section=function(){return NewProfile.sections().by_name(this.get("section").name)},n.prototype.work_id=function(){return this.get("work_id")},n.prototype.user_id=function(){return this.get("user_id")},n.prototype.isNew=function(){return!1},n.from_author_and_work=function(e,t){var n;return n=$.extend({},e,{work_id:t.id,user_id:e.id,id:null}),new Works.Authorship(n)},n}(Academia.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTag=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.fromUserSearch=function(e,t){return null==t&&(t={}),new Works.CoauthorTag({name:e.get("name"),email:e.get("email"),encrypted_email:e.get("encrypted_email"),affiliation:e.get("university"),tagged_user_id:e.get("id"),source:e.get("source")||(null!=t?t.source:void 0),source_details:e.get("source_details")||{name:"search",email:"search"}},t)},n.prototype.initialize=function(e){return e?(n.__super__.initialize.call(this,_.omit(e,"display_name","coauthor_email")),e.display_name&&this.set("name",e.display_name),e.coauthor_email&&this.set("email",e.coauthor_email),this.set("orig_email",this.get("email"))):void 0},n.prototype.validate=function(e){var t;return t={},this._validateNamePresence(e)||(t.name="You must provide your co-author's name."),this._validateNameLength(e)||t.name||(t.name="Your co-author's name can't be longer than 240 characters."),this._validateEmailPresence(e)||(t.email="To tag your co-author, you must provide their email."),this._validateEmailFormat(e)||t.email||(t.email="Your co-author's email appears to be invalid."),_.size(t)>0?t:void 0},n.prototype._validateNamePresence=function(e){return e.name&&e.name.length>0},n.prototype._validateNameLength=function(e){return e.name&&e.name.length<240},n.prototype._validateEmailPresence=function(e){return e.email&&e.email.length>0},n.prototype._validateEmailFormat=function(e){return e.email===this.get("orig_email")?!0:e.email&&$h.validEmail(e.email,{strict:!0})},n.prototype.save=function(e,t){var i;return null==t&&(t={}),t.url||(t.url=null!=(i=this.collection)?i.url():void 0),this.has("work_id")&&(t.url||(t.url=$r.api_v0_work_co_author_tags_path({subdomain_param:"api",work_id:this.get("work_id")}))),n.__super__.save.call(this,e,t)},n.prototype.rejectAsSuggestion=function(){return this.has("work_id")?$.post(this.suggestionUrl(),{work_id:this.get("work_id"),tagged_user_id:this.get("tagged_user_id"),name:this.get("name"),email:this.get("email"),encrypted_email:this.get("encrypted_email"),source:this.get("source"),source_details:this.get("source_details"),accepted:!1}):void 0},n.prototype.url=function(){return $r.api_v0_work_co_author_tag_path({id:this.get("id"),work_id:this.get("work_id"),subdomain_param:"api"})},n.prototype.suggestionUrl=function(){return $r.api_v0_suggestions_coauthors_path({subdomain_param:"api"})},n.prototype.uniqueEmail=function(){return this.get("encrypted_email")||this.get("email")},n}(Backbone.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.Section=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.modelName="section",n.prototype.routeKey="api_v0_section",n.prototype.defaults={name:"Papers",public_id:"Papers",works_count:0},n.left_menu_id=function(e){return"left-menu-item-section-"+(e||0)},n.prototype.set_order=function(e,t,n){return null==n&&(n={}),this._ordered_work_ids=e,_.extend(n,{url:$r.set_order_api_v0_works_path({subdomain_param:"api"}),type:"POST",data:{order:e,moved:t,section_id:this.id,_method:"PUT"}}),$.ajax(n)},n.prototype.work_ids_without=function(e){return _.without(this.ordered_work_ids(),e)},n.prototype.move_to_top=function(e){var t;return t=this.work_ids_without(e),t.unshift(e),this.set_order(t,e)},n.prototype.move_to_bottom=function(e){var t;return t=this.work_ids_without(e),t.push(e),this.set_order(t,e)},n.prototype.move=function(e,t){var n,i;return i=_.indexOf(this.ordered_work_ids(),e),n=this.work_ids_without(e),n.splice(i+t,0,e),this.set_order(n,e)},n.prototype.move_up=function(e){return this.move(e,-1)},n.prototype.move_down=function(e){return this.move(e,1)},n.prototype.ordered_work_ids=function(){return this._ordered_work_ids||(this._ordered_work_ids=$("#section_"+this.id).find(".work").map(function(e,t){return parseInt($(t).attr("data-work_id"))}))},n.prototype.increment_count=function(){return this.set("works_count",this.get("works_count")+1)},n.prototype.decrement_count=function(){return this.set("works_count",(this.get("works_count")||1)-1)},n.prototype.left_menu_id=function(){return Works.Section.left_menu_id(this.get("id"))},n.prototype.page_url=function(e){return null==e&&(e={}),_.extend(e,{page_name:$viewed_user.page_name,section_name:this.get("name")}),$r.new_profile_works_path(e)},n}(Academia.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestedCluster=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.parse=function(e){return{papers:new Works.SuggestedWorks(e.papers,{cluster:this}),confidence:parseFloat(e.match_confidence||0),co_author_emails:parseInt(e.co_author_emails)}},n.prototype.save=function(){return this.savePapersWithStatus("claim"),this.savePapersWithStatus("anticlaim")},n.prototype.savePapersWithStatus=function(e){var t,n,i;return n=this.get("papers").where({claimStatus:e}),t=[],_(n).each(function(n){return n.set({claimStatus:e,decided:!0}),t.push(n.get("id"))}),t.length>0?this.addSaveOperation($.ajax({url:$r.api_v0_paper_claims_path({subdomain_param:"api"}),type:"POST",dataType:"json",data:{papers:t,claim_method:e,source:null!=(i=this.collection)?i.source:void 0}})):void 0},n.prototype.addSaveOperation=function(e){var t;return null!=(t=this.collection)?t.saveOperations.push(e):void 0},n.mergeIntoOne=function(e){var t,n,i,o;return i=_.chain(e).map(function(e){return e.get("papers").models}).flatten().value(),n=_(e).reduce(function(e,t){return e+t.get("co_author_emails")},0),t=_(e).reduce(function(e,t){return Math.min(e,t.get("confidence")||0)},1/0),new Works.SuggestedCluster({papers:new Works.SuggestedWorks(i),confidence:t,co_author_emails:n,collection:null!=(o=e[0])?o.collection:void 0})},n}(Backbone.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestedCoauthor=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.defaults={accept:!0,isExpanded:!1,claimStatus:"claim",optedIn:!0},n.prototype.parse=function(e){return{name:e.name,user_id:e.user_id,encrypted_email:e.encrypted_email,obfuscated_email:e.obfuscated_email,tags:e.tags,source:e.source,tagged_user_photo_url:e.tagged_user_photo_url}},n.prototype.rejectTagAsSuggestion=function(e){var t,n;if(e)return t=_.findWhere(this.get("tags"),{work_id:e}),n=_(this.get("tags")).reject(function(t){return e===t.work_id}),this.set("tags",n),$.post(this.suggestionUrl(),{work_id:t.work_id,tagged_user_id:t.tagged_user_id,name:t.name,email:t.email,encrypted_email:t.encrypted_email,source:this.get("source"),source_details:t.source_details,accepted:!1}),0===this.get("tags").length?this.destroy():void 0},n.prototype.suggestionUrl=function(){return $r.api_v0_suggestions_coauthors_path({subdomain_param:"api"})},n.prototype.isClaimed=function(){return"claim"===this.get("claimStatus")},n.prototype.hasEmail=function(){return null!==this.get("encrypted_email")&&void 0!==this.get("encrypted_email")||null!==this.get("email")&&void 0!==this.get("email")},n.prototype.hasValidEmail=function(){return $h.validEmail(this.get("email"),{strict:!0})},n.prototype.isExternal=function(){return null===this.get("tagged_user_id")},n}(Backbone.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestedWork=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.defaults={claimStatus:"claim"},n.prototype.isClaimed=function(){return"claim"===this.get("claimStatus")
},n.prototype.initialize=function(){return this.parseFoundAuthors()},n.prototype.parseFoundAuthors=function(){var e;return this.has("found_authors")?(e=new Works.CoauthorTags(this.get("found_authors"),{work_id:this.get("work_id")}),this.set("found_authors",e)):void 0},n}(Backbone.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.Url=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.modelName="url",n.prototype.routeKey="api_v0_work_url",n.prototype.urlArgs=function(){return{work_id:this.get("work_id")}},n.prototype.initialize=function(){return this.on("error",function(e){return function(t,n){return e.parse_server_error(n),e.trigger("invalid")}}(this))},n.prototype.parse_server_error=function(e){var t;return(e.status=422)?(t=JSON.parse(e.responseText).errors,this.validationError=t):void 0},n.prototype.validate=function(){var e;return e=null,$.ajax({type:"POST",async:!1,url:$r.validate_url_api_v0_works_path({subdomain_param:"api"}),data:this.toJSON(),error:function(t){return function(n){return e=t.parse_server_error(n)}}(this)}),e},n}(Academia.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty,n=[].slice;Works.Work=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.modelName="work",i.prototype.routeKey="api_v0_work",i.prototype.propertyNames=["html"],i.prototype.urlArgs=function(){return this.id?{id:this.id}:{}},i.prototype.destroy=function(){return i.__super__.destroy.apply(this,arguments),this.decrement_section_count()},i.prototype.recommended_metadata_fields=function(){var e;return e=Works.SECTIONS[this.get("section")]||Works.SECTIONS.Other,e.suggested_fields},i.prototype.add_metadata_field=function(e){return this.metadata()[e]=null,this.trigger("added_metadata_field",e)},i.prototype.metadata=function(){return this.get("metadata")||this.set("metadata",{}).get("metadata")},i.prototype.metadata_fields=function(){var e,t,n;return n=_.keys(this.metadata()),t=function(){var t,i,o,r;for(o=Works.FIELDS,r=[],t=0,i=o.length;i>t;t++)e=o[t],_.include(n,e.name)&&r.push(e);return r}()},i.prototype.metadata_keys=function(){var e,t,n,i,o;for(i=this.metadata_fields(),o=[],t=0,n=i.length;n>t;t++)e=i[t],o.push(e.name);return o},i.prototype.toJSON=function(){return _.pick.apply(_,[this.attributes].concat(n.call(this.writable_attributes())))},i.prototype.dom_id=function(){return"work_"+this.id},i.prototype.writable_attributes=function(){return["title","metadata","source"]},i.prototype.increment_section_count=function(){var e;return"undefined"!=typeof NewProfile&&null!==NewProfile&&null!=(e=NewProfile.sections().by_name(this.get("section")))?e.increment_count():void 0},i.prototype.decrement_section_count=function(){var e;return"undefined"!=typeof NewProfile&&null!==NewProfile&&null!=(e=NewProfile.sections().by_name(this.get("section")))?e.decrement_count():void 0},i}(Academia.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SectionView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.elements={section_name:".section_heading .section_name",add_work_link:".section_heading .add",order_works_link:".section_heading .order",works_container:".works",works:".work"},n.prototype.initialize=function(){var e;return n.__super__.initialize.apply(this,arguments),this.section=this.options.section,null!=(e=this.section)?e.on("change:name",function(e){return function(){return e.update_name()}}(this)):void 0},n.prototype.update_name=function(){return this.$els.section_name.text(this.section.get("name"))},n.prototype.empty=function(){return 0===this.section.ordered_work_ids().length},n.prototype.get_work_strip=function(e){return this.$els.works_container.find(".work[data-work_id="+e+"]")},n.prototype.prepend_work=function(e){return this.$els.works_container.prepend(e),this._find_elements()},n}(Academia.StaticView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.EditableSectionView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click %order_works_link":"order_works_link_clicked","click %add_work_link":"add_work_link_clicked"},n.prototype.initialize=function(e){return n.__super__.initialize.apply(this,arguments),this.section.on("highlight_work_strip",function(e){return function(t){return e.highlight_work_strip(t)}}(this)),this.source=source,this.recaptchaKey=e.recaptcha_key},n.prototype.order_works_link_clicked=function(e){return e.preventDefault(),null==this.add_work_popover?this.enter_reordering_mode($(e.target)):void 0},n.prototype.add_work_link_clicked=function(e){return e.preventDefault(),this.start_work_creator()},n.prototype.start_work_creator=function(){return this.leave_reordering_mode(),WorkCreator.start(this.section.get("name"),this.source,this.recaptchaKey)},n.prototype.show_ordering_help_popover=function(){return null==this.ordering_help_popover?(this.ordering_help_popover=new NewProfile.OrderWorksPopover({container:this.$el,element:this.$(".work:first")}),this.ordering_help_popover.render_and_show(),this.ordering_help_popover.on("remove",function(e){return function(){return e.ordering_help_popover=null,e.leave_reordering_mode()}}(this))):void 0},n.prototype.enter_reordering_mode=function(e){return this.$els.works.addClass("ordering"),this.add_ordering_widget_to_work_strips(),this.show_ordering_help_popover(e),this.init_sortable_sections()},n.prototype.leave_reordering_mode=function(){return null!=this.ordering_help_popover&&(this.ordering_help_popover.remove(!0),this.ordering_help_popover=null),this.$els.works.removeClass("ordering")},n.prototype.add_ordering_widget_to_work_strips=function(){return this.ordering_widgets||(this.ordering_widgets={}),_.each(this.$els.works,function(e){return function(t){var n,i;return i=$(t).data("work_id"),n="work_"+i,e.ordering_widgets[n]?void 0:(e.ordering_widgets[n]=new Works.OrderingView({id:i,section:e.section}),e.ordering_widgets[n].on("reorder_works_in_dom",function(){return e.make_dom_works_order_match_section_works_order()}),e.ordering_widgets[n].render().$el.prependTo($(t)))}}(this))},n.prototype.make_dom_works_order_match_section_works_order=function(){var e;return _.each(this.section.ordered_work_ids(),function(e){return function(t){return e.get_work_strip(t).appendTo(e.$els.works_container)}}(this)),"function"==typeof(e=this.$el).sortable?e.sortable("refreshPositions"):void 0},n.prototype.highlight_work_strip=function(e){var t;return t=this.get_work_strip(e),t.removeClass("remove_highlight"),t.addClass("highlight"),_.delay(function(){return t.removeClass("highlight"),t.addClass("remove_highlight"),_.delay(function(){return t.removeClass("remove_highlight")},1e3)},1e3)},n.prototype.init_sortable_sections=function(){return this.sortable=this.$el.sortable({items:".work",containment:"parent",handle:".handle",update:function(e){return function(t,n){var i,o,r;return i=null!=n&&null!=(o=n.item)?o.data("work_id"):void 0,r=e.$el.sortable("toArray",{attribute:"data-work_id"}),r=_.map(r,function(e){return parseInt(e)}),e.section.set_order(r,i,{error:function(){return document.location.reload()}})}}(this)})},n}(Works.SectionView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.SuggestableTagView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="li",n.prototype.className="bg-white",n.prototype.template="works/templates/suggestable_tag",n.prototype.events={"click .close":"removeModel"},n.prototype.attributes=function(){return{"data-tag-id":this.model.id,"data-last-dragged":!!this.model.get("last_dragged")}},n.prototype.initialize=function(){return this.listenTo(this.model,"change",this.render)},n.prototype.render=function(){return this.$el.html(JST[this.template]({model:this.model.toJSON()})),this},n.prototype.removeModel=function(){return this.model.collection.remove(this.model)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.SuggestableTagsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return null==e&&(e={}),this.tagOptions=e.tag_options,this.sortable=e.sortable,n.__super__.initialize.apply(this,arguments),this.listenTo(this.collection,"add remove sort",this.render,this)},n.prototype.render=function(){return this.setupTagViews(),this.initSortable(),this},n.prototype.setupTagViews=function(){return _.invoke(this.tagViews,"remove"),this.tagViews=this.collection.map(function(e){return function(t){return e.viewForModel(t)}}(this)),_.each(this.tagViews,function(e){return function(t){return e.$el.append(t.render().el)}}(this))},n.prototype.initSortable=function(){return this.sortable?(this.$("li").each(function(e){return function(t,n){return $(n).data("sort-index-of-model",e.collection.at(t))}}(this)),this.$el.sortable({containment:"document",items:"li",placeholder:"list-pill-placeholder bg-white",start:function(e){return function(){return e.closePopovers()}}(this),update:function(e){return function(t,n){return e.handleSortingUpdate(t,n)}}(this)})):void 0},n.prototype.handleSortingUpdate=function(e,t){return this.$("li").each(function(e,t){var n;return n=$(t).data("sort-index-of-model"),n.set("display_order",e),n.set("last_dragged",!1)}),t.item.data("sort-index-of-model").set("last_dragged",!0),this.collection.sort()},n.prototype.closePopovers=function(){return this.$(".popover").each(function(e,t){return $(t).data("bs.popover").$element.popover("hide")})},n.prototype.viewForModel=function(e){return new Works.SuggestableTagView(_({model:e}).extend(this.tagOptions))},n.prototype.remove=function(){return _.invoke(this.tagViews,"remove"),n.__super__.remove.apply(this,arguments)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTagView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return null!=e.template&&(this.template=e.template),n.__super__.initialize.apply(this,arguments)},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),this.model.get("locked")||this.addEditView(),this},n.prototype.addEditView=function(){return this.editView||(this.editView=new Works.CoauthorTagEdit({el:this.$el,model:this.model}))},n.prototype.remove=function(){var e;return null!=(e=this.editView)&&e.remove(),n.__super__.remove.apply(this,arguments)},n}(Works.SuggestableTagView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.AddAttachmentButton=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="attachment_upload_button",n.prototype.initialize=function(e){return n.__super__.initialize.apply(this,arguments),this.button_text=e.text||'<i class="fa fa-upload"></i> Upload File',this.work_id=e.work_id,this.uploader=this._create_uploader(e.disable_during_upload)},n.prototype._create_uploader=function(e){return new Academia.Uploader({uploader:new Academia.BasicUploader.WorkAttachments({work_id:this.work_id,source:this.options.source,button_text:this.button_text,record_events_for:this.options.record_events_for}),done:function(e){return function(t){return null!=e.options.done?e.options.done():e.collection.add(new Works.Attachment(t.result.attachment))}}(this),disable_during_upload:e})},n.prototype.render=function(){return this.uploader.render_and_insert(this.$el),this},n}(Academia.View),window.app=window.app||{},app.views=app.views||{},app.views.AddAttachmentButton_v2=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.ui={$button_text:this.$(".btn-text"),$error_alert:this.$(".error-text")},this.done=e.done||function(){},this.uploader=new app.views.Uploader_v2({dropZone:this.$el,input:this.$("input[type=file]"),source:e.source,work_id:e.work_id,event_recorder:e.event_recorder}),this.uploader.on("add",this._clear_errors,this).on("progress",_.throttle(this._show_progress,200),this).on("fail",this._show_failure,this).on("error",this._show_errors,this).on("done",this._show_complete,this),this.$el.show(),this.uploader._record_event("swp_upload_file_shown")},n.prototype.events={"click input[type=file]":"_file_input_clicked"},n.prototype._file_input_clicked=function(){return this.uploader._record_event("upload_file_clicked")},n.prototype._show_progress=function(e){return this.ui.$button_text.text(Math.floor(e.loaded/e.total*100)+"%")},n.prototype._clear_errors=function(){return this.ui.$error_alert.hide()},n.prototype._show_errors=function(e){var t,n;return t={file_name_length:"File name is too long to upload. Please shorten and try again.",file_size:"Please choose a smaller file (less than "+$h.humanFileSize(this.uploader.max_file_size)+").",file_type:"Sorry, we don't support that file type."},n=Object.keys(e[0])[0],this.ui.$error_alert.show().text(t[n]),this.done({success:!1,message:t[n]})},n.prototype._show_failure=function(){return this.done({success:!1,message:"Something went wrong. Please try again"}),alert("Something went wrong")},n.prototype._show_complete=function(e){return this.ui.$button_text.text("Upload Complete"),this.done({success:!0,attachment:e.result.attachment})},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.AttachmentStrip=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="li",n.prototype.jstTemplate="works/templates/attachments/attachment_strip",n.prototype.elements={remove_icon:"i.fa.fa-times"},n.prototype.events={"click %remove_icon":"remove_attachment"},n.prototype.remove_attachment=function(){return this.trigger("remove"),this.model.destroy({success:function(e){return function(){return e.remove()}}(this)})},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.AttachmentsList=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="attachments_list",n.prototype.elements={attachments:".attachments"},n.prototype.template=function(){return"<label>Files:</label> <ul class='attachments'></ul>"},n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.collection.on("add",function(e){return function(){return e.render()}}(this)),this.collection.on("remove",function(e){return function(){return e.render()}}(this))},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),this.collection.size()>0?this.$el.show():this.$el.hide(),this.collection.each(function(e){return function(t){var n;return n=new Works.AttachmentStrip({model:t}),e.$els.attachments.append(n.render().$el)}}(this)),this},n}(Academia.View)}.call(this),function(){this.Works.CoauthorEditView=Academia.View.extend({tagName:"div",className:"work edit_work_form clearfix",jstTemplate:"works/templates/coauthor_edit",elements:{coauthors_container:"div.coauthors_list_container",coauthor_tags_list:".coauthor_tags_list",authors_list:"div.authors_list",close_link:"a.cancel"},events:{"click %close_link":"close_clicked"},initialize:function(){return Academia.View.prototype.initialize.apply(this,arguments),this._set_up_coauthor_tags_view()},render:function(){return Academia.View.prototype.render.apply(this,arguments),this.coauthor_tags_view.setElement(this.$els.coauthor_tags_list).render(),$(document).on("pjax:start",function(e){return function(){return e.cancel()}}(this)),this},close_clicked:function(e){return e.preventDefault(),this._record_event("close_clicked"),$(".works_section").removeClass("editing"),this.trigger("close"),this.remove()},_set_up_coauthor_tags_view:function(){var e;return e=new Works.CoauthorTags([],{work_id:this.model.id,source:"work_editor",includeOwner:this.model.get("owner")}),e.fetch({dataType:"json"}),this.coauthor_tags_view=new NewProfile.CoauthorTagListView({collection:e,work_id:this.model.id})}})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorPicker=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.searchInput=e.searchInput,this.searchView=new Search.CoauthorSearch({el:this.searchInput,collection:this.collection}),this.inviteModalView=new Works.InviteCoauthorModal({collection:this.collection}).render(),e.instantSave&&this.saveOnAnyChanges(),this.searchView.$el.on("select2-footer-clicked",function(e){return function(){return e.footerClicked()}}(this))},n.prototype.footerClicked=function(){return this.searchInput.select2("close"),this.inviteModalView.show()},n.prototype.saveOnAnyChanges=function(){return this.listenTo(this.collection,"sort",_.debounce(function(e){return function(){return e.collection.saveOrdering()}}(this),500)),this.listenTo(this.collection,"add",function(){return function(e){return e.has("id")?void 0:e.save()}}(this)),this.listenTo(this.collection,"remove",function(){return function(e){return e.has("id")?e.destroy():void 0}}(this))},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTagEdit=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.call(this,{html:!0,placement:"top",show_delay:50,hide_delay:200,content:function(e){return function(){return e.content()}}(this),on_shown:function(e){return function(){return e.initUi(e._popover_el())}}(this)})},n.prototype.initUi=function(e){return this.ui={name:e.find(".js-works-coauthor-edit-name"),email:e.find(".js-works-coauthor-edit-email"),buttons:e.find(".js-works-coauthor-save-or-cancel"),save:e.find(".js-works-coauthor-save"),cancel:e.find(".js-works-coauthor-cancel"),errors:e.find(".js-works-coauthor-errors")},this._allowEdit()?this._initListeners():void 0},n.prototype._initListeners=function(){return this.ui.name.click(function(e){return function(){return e._editName()}}(this)),this.ui.name.hover(function(e){return function(){return e._editName()}}(this)),this.ui.email.click(function(e){return function(){return e._editEmail()}}(this)),this.ui.email.hover(function(e){return function(){return e._editEmail()}}(this)),this.ui.save.click(function(e){return function(){return e._save()}}(this)),this.ui.cancel.click(function(e){return function(){return e._hide()}}(this))},n.prototype._allowEdit=function(){return!this.model.has("tagged_user_id")},n.prototype.content=function(){return JST["works/templates/coauthor_tag_edit"]({tag:this.model})},n.prototype._editName=function(){return this._switchToButtons(),this.ui.name.attr("readonly",!1)},n.prototype._editEmail=function(){return this._switchToButtons(),this.ui.email.attr("readonly",!1)},n.prototype._switchToButtons=function(){return this.freeze(),this.ui.buttons.removeClass("hidden")},n.prototype._save=function(){var e,t,n;return e={},this.ui.name.is("readonly")||this.ui.name.val()===this.model.get("name")||(e.name=this.ui.name.val()),this.ui.email.is("readonly")||this.ui.email.val()===this.model.get("email")||(e.email=this.ui.email.val()),n=this.model.clone(),this.model.set(e,{validate:!0})?(n.rejectAsSuggestion(),this._hide()):(t=this.model.validationError)?this._showError(t):void 0},n.prototype._showError=function(e){return e.email?this.ui.email.parent().addClass("has-error"):this.ui.email.parent().removeClass("has-error"),e.name?this.ui.name.parent().addClass("has-error"):this.ui.name.parent().removeClass("has-error"),this.ui.errors.html(""),_(e).each(function(e){return function(t){return e.ui.errors.append($("<div/>")).addClass("alert alert-danger").attr("role","alert").text(t)}}(this))},n}(HoverPopover)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTagsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return null==e&&(e={}),_.defaults(e,{sortable:!0}),n.__super__.initialize.apply(this,arguments)},n.prototype.viewForModel=function(e){return new Works.CoauthorTagView(_({model:e}).extend(this.tagOptions))},n}(Works.SuggestableTagsView)}.call(this),function(){var e,t,n=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;this.Works.EditView=Academia.View.extend({tagName:"div",className:"work edit_work_form clearfix",jstTemplate:"works/templates/edit",elements:{form:"form",meta_links:"div.add_meta_links",attachments_list:".attachments_list",attachment_upload_button:".attachment_upload_button",urls_list:".urls_list",coauthors_container:"div.coauthors_list_container",coauthor_tags_list:".coauthor_tags_list",add_url_button:".add_url_button",research_interest_list:"div.profile_research_interest_list",authors_list:"div.authors_list",cancel_link:"a.cancel",save_link:"a.save",upload_container:".upload_container"},events:{"click %cancel_link":"cancel_clicked","click %save_link":"save_clicked","click %upload_container":"upload_file_clicked"},initialize:function(){var e;return Academia.View.prototype.initialize.apply(this,arguments),this.options.section&&this.model.set("section",this.options.section.get("name")),this._set_up_coauthor_tags_view(),this._set_up_form_view(),this._set_up_meta_links_view(),this._set_up_attachments(),this._set_up_urls(),this._set_up_research_interest_view(),(e=Academia.View)._upload_papers_clicked_recorded||(e._upload_papers_clicked_recorded=!1)},render:function(){return Academia.View.prototype.render.apply(this,arguments),this.coauthor_tags_view.setElement(this.$els.coauthor_tags_list).render(),this.form_view.setElement(this.$els.form).render(),this.meta_links_view.setElement(this.$els.meta_links).render(),this.add_attachment_button.setElement(this.$els.attachment_upload_button).render(),this.attachments_list.setElement(this.$els.attachments_list).render(),this.add_url_button.setElement(this.$els.add_url_button).render(),this.urls_list.setElement(this.$els.urls_list).render(),this.research_interest_view.setElement(this.$els.research_interest_list).render().edit_mode(),$(document).on("pjax:start",function(e){return function(){return e.cancel()}}(this)),-1!==window.location.search.indexOf("s=nav")&&Academia.View._upload_papers_clicked_recorded===!1&&(this._record_event("upload_papers_clicked"),Academia.View._upload_papers_clicked_recorded=!0),this},cancel:function(){return this.model.revert(),this.trigger("cancel"),this.remove()},upload_file_clicked:function(){return this._record_event("upload_file_clicked")},cancel_clicked:function(e){return e.preventDefault(),this._record_event("cancel_clicked"),$(".works_section").removeClass("editing"),this.cancel()},save_clicked:function(e){return e.preventDefault(),this.$els.save_link.attr("disabled")?void 0:(this.$els.save_link.attr("disabled","disabled"),this._record_event("save_clicked"),this.form_view.submit())},_set_up_coauthor_tags_view:function(){var e;return e=new Works.CoauthorTags([],{work_id:this.model.id,source:"work_editor",includeOwner:$current_user}),e.fetch({dataType:"jsonp"}),this.coauthor_tags_view=new NewProfile.CoauthorTagListView({collection:e,work_id:this.model.id})},_set_up_form_view:function(){return this.form_view=new Works.FormBuilder({sync_to_model:!0,model:this.model,source:this.options.source,record_events_for:this.options.record_events_for,error:function(e){return function(){return e.$els.save_link.removeAttr("disabled")}}(this),before_submit:function(e){return function(t,n){var i;return e.urls.add_pending()===!1?!1:e.model.isNew()?(i=/[?&]s=([^&#]*)/.exec(window.location.href),_.extend(n.params,{research_interests:e.research_interest_view.collection.as_json(),attachments:e.attachments,urls:e.urls,section_name:e.options.section.get("name"),source:e.options.source},null!=i?{original_source:i[1]}:void 0)):void 0}}(this),success:function(e){return function(){return e.trigger("save"),$(".works_section").removeClass("editing"),e.remove()}}(this)})},_set_up_meta_links_view:function(){return this.meta_links_view=new e({parent:this,model:this.model})},_set_up_attachments:function(){var e;return this.attachments=this.options.attachments?this.options.attachments:(e=new Academia.Collection,_.each(this.model.get("attachments"),function(){return function(t){return e.add(new Works.Attachment(t))}}(this)),e),this.attachments_list=new Works.AttachmentsList({collection:this.attachments}),this.add_attachment_button=new Works.AddAttachmentButton({collection:this.attachments,work_id:this.model.id,source:this.options.source,record_events_for:this.options.record_events_for,disable_during_upload:function(e){return function(){return e.$els.save_link}}(this)})},_set_up_urls:function(){return this.urls=new Works.Urls([],{work:this.model}),this.model.get("urls")&&this.urls.add(this.model.get("urls")),this.urls_list=new Works.UrlsList({collection:this.urls}),this.add_url_button=new Works.AddUrlButton({collection:this.urls,work_id:this.model.id})},_set_up_research_interest_view:function(){var e;return e=new NewProfile.Taggings([],{tag_type:"ResearchInterest",target_type:"Work",target_id:this.model.id||""}),this.model.get("research_interests")&&e.add(this.model.get("research_interests")),this.research_interest_view=new NewProfile.ResearchInterestListView({collection:e,record_events_for:this.options.record_events_for})}}),e=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,e),i.prototype.template=function(){return'<span class="add_more_label">Add More:</span> <span class="meta_links_links"></span>'},i.prototype.elements={links_span:".meta_links_links",add_meta_links:"a.add_meta",other_link:"a.other_link"},i.prototype.events={"click %add_meta_links":"add_meta_clicked","click %other_link":"other_link_hovered"},i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),this.model.on("added_metadata_field",function(e){return function(){return e.render()}}(this))},i.prototype.add_meta_clicked=function(e){var t;return e.preventDefault(),t=$(e.target).data("meta-field-name"),this.model.add_metadata_field(t)},i.prototype.other_link_hovered=function(e){return e.preventDefault(),this.create_popover()},i.prototype.render=function(){return this.fields_for_links().length>0||this.fields_for_popover().length>0?(i.__super__.render.apply(this,arguments),this.render_links(this.$els.links_span,this.fields_for_links()),this._find_elements()):this.remove(),this},i.prototype.render_links=function(e,t){return 0!==t.length||0!==this.fields_for_popover().length?(_.each(t,function(t){return function(n,i){return i>0&&e.append(", "),e.append(t.render_link(n))}}(this)),this.fields_for_popover().length>0?(t.length>0&&e.append(", "),e.append(this.render_other())):void 0):void 0},i.prototype.render_link=function(e){var t;return t=$('<a href="#" class="add_meta"></a>'),t.data("meta-field-name",e.name),t.text(e.label),t},i.prototype.render_other=function(){return'<a class="other_link" href="#">Other</a>'},i.prototype.create_popover=function(){return null==this.popover?(this.popover=new t({parent:this,element:this.$els.other_link,position:"bottom",model:this.model,render_links:function(e){return function(){var t,n,i,o,r;for(o=e.fields_for_popover(),r=[],n=0,i=o.length;i>n;n++)t=o[n],r.push(e.render_link(t));return r}}(this)}),this.popover.render().$el.insertAfter(this.$el),this.popover.on("remove",function(e){return function(){return e.popover=null}}(this))):void 0},i.prototype.fields_for_links=function(){return _.filter(this.unused_fields(),function(e){return function(t){return _.include(e.model.recommended_metadata_fields(),t.name)}}(this))},i.prototype.fields_for_popover=function(){return _.filter(this.unused_fields(),function(e){return function(t){return!_.include(e.model.recommended_metadata_fields(),t.name)}}(this))},i.prototype.unused_fields=function(){return _.filter(Works.FIELDS,function(e){return function(t){return!_.include(e.model.metadata_keys(),t.name)}}(this))},i}(Academia.View),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.template=function(){return"<table><tr></tr></table>"},t.prototype.elements={add_meta_link:"a.add_meta",container:"table tr"},t.prototype.events={"click %add_meta_link":"add_meta_clicked","click li":"li_clicked"},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.model.on("added_metadata_field",function(e){return function(){return e.$el.fadeOut(100,function(){return e.remove()})}}(this))},t.prototype.add_meta_clicked=function(e){return e.stopPropagation(),e.preventDefault(),this.options.parent.add_meta_clicked(e)},t.prototype.li_clicked=function(e){return e.stopPropagation(),e.preventDefault(),$(e.target).find("a").click()},t.prototype.render=function(){return t.__super__.render.apply(this,arguments),this.each_slice(this.options.render_links(),3,function(e){return function(t){return e.$els.container.append(e.render_list(t))}}(this)),this},t.prototype.render_list=function(e){var t,n,i,o;for(t=$("<ul></ul>"),n=0,i=e.length;i>n;n++)o=e[n],t.append($("<li></li>").append(o));return $("<td></td>").append(t)},t.prototype.each_slice=function(e,t,n){var i,o;for(i=0,o=[];i<e.length;)n(e.slice(i,i+t)),o.push(i+=t);return o},t}(Academia.PopoverHoverWidget)}.call(this),function(){var e;this.Works.FormBuilder=Academia.FormBuilder.extend({initialize:function(){return Academia.FormBuilder.prototype.initialize.apply(this,arguments),this._set_up_fields(),this._set_up_metadata_view()},form_data:function(){return this.$el.serializeNestedObject()},render:function(){return Academia.FormBuilder.prototype.render.apply(this,arguments),this.$el.append(this.metadata_view.render().$el),this},process_error_hash:function(e){return _.each(this.fields,function(){return function(t){return t.render_errors(e[t.name])}}(this)),this.metadata_view.process_error_hash(e),this._record_event("work_form_builder_error")},_set_up_fields:function(){return this.add_field("string",{name:"title",label:!1})},_set_up_metadata_view:function(){return this.metadata_view=new e({sync_to_model:!0,model:this.model}),this.model.on("added_metadata_field",function(e){return function(t){return e.metadata_view.render(),e.metadata_view.focus_field("metadata["+t+"]")}}(this))}}),e=Academia.FormBuilder.extend({tagName:"div",focus_field:function(e){var t;return null!=(t=_.find(this.fields,function(t){return t.name===e}))?t.focus():void 0},render:function(){return this._set_up_fields(),Academia.FormBuilder.prototype.render.apply(this,arguments)
},_set_up_fields:function(){return this.clear_fields(),_.each(this.model.metadata_fields(),function(e){return function(t){return e.add_field(t.type,{name:"metadata["+t.name+"]",label:t.label,field_name:t.name,value_fn:function(e){return e?(this.model.get("metadata")[this.options.field_name]=e,this.model.set({metadata:this.model.get("metadata")})):this.model.get("metadata")[this.options.field_name]}})}}(this))}})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.InviteCoauthorModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="bootstrap",n.prototype.template="works/templates/invite_coauthor_modal",n.prototype.events={"click .js-invite-coauthor-link":"addExternalCoauthor","keydown input":"handleKeydown"},n.prototype.initialize=function(){return this.model=new Works.CoauthorTag({source_details:{name:"manual",email:"manual"}})},n.prototype.render=function(){return this.$el.html(JST[this.template]()),this.setupSelectors(),$("body").append(this.$el),this},n.prototype.setupSelectors=function(){return this.ui={$modal:this.$("#coauthor-search-invite-coauthor-modal"),$coauthorNameInput:this.$("#add-coauthor-name"),$coauthorEmailInput:this.$("#add-coauthor-email"),$alertRow:this.$(".alert-box"),$alertList:this.$(".alert-list"),$formItems:this.$(".form-group")}},n.prototype.show=function(){return this.ui.$modal.modal("show"),this.ui.$coauthorNameInput.focus()},n.prototype.handleKeydown=function(e){return 13===e.keyCode?this.addExternalCoauthor():void 0},n.prototype.addExternalCoauthor=function(){return this.model.set("name",this.getName()),this.model.set("email",this.getEmail()),this.model.isValid()?(this.collection.add(this.model),this.ui.$modal.modal("hide"),this.resetModel()):this.alertValidationErrors()},n.prototype.resetModel=function(){return this.model=new Works.CoauthorTag({source_details:{name:"manual",email:"manual"}}),this.ui.$coauthorNameInput.val(""),this.ui.$coauthorEmailInput.val("")},n.prototype.alertValidationErrors=function(){return this.resetAlerts(),this.insertValidationAlerts(),this.ui.$alertRow.fadeIn()},n.prototype.resetAlerts=function(){return this.ui.$alertRow.hide(),this.ui.$formItems.removeClass("has-error"),this.ui.$alertList.html("")},n.prototype.insertValidationAlerts=function(){return _.each(this.model.validationError,function(e){return function(t,n){var i,o;return"email"===n?e.ui.$coauthorEmailInput.parent().addClass("has-error"):"name"===n&&e.ui.$coauthorNameInput.parent().addClass("has-error"),o=$("<span/>").html(t),i=$("<div/>").addClass("alert").addClass("alert-danger").attr("role","alert").html(o),e.ui.$alertList.append(i)}}(this)),this.model.unset("validationError")},n.prototype.getName=function(){var e,t;return t=this.ui.$coauthorNameInput.attr("placeholder"),e=this.ui.$coauthorNameInput.val(),t===e?"":e},n.prototype.getEmail=function(){var e,t;return t=this.ui.$coauthorEmailInput.attr("placeholder"),e=this.ui.$coauthorEmailInput.val(),t===e?"":e},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.MoveSectionPopover=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.jstTemplate="works/templates/move_section_popover",n.prototype.elements={new_section_link:".new_section",new_section_input:".new_section_input"},n.prototype.events={click:"stopPropagation","click li.section":"handle_section_click"},n.prototype.initialize=function(){return this.authorship=this.options.authorship,this.add_view=new NewProfile.AddSectionView({success:function(e){return function(t,n){return e.change_section(n.section.name)}}(this)})},n.prototype.render=function(){return n.__super__.render.call(this,{defaults:{current_section:this.authorship.get("section").name,section_names:NewProfile.sections().pluck("name")}}),this.add_view.setElement(this.$els.new_section_input).render(),this},n.prototype.handle_section_click=function(e){return e.stopPropagation(),this.change_section($(e.target).text())},n.prototype.change_section=function(e){var t;return t=this.authorship.section(),this.authorship.change_section(e,function(e){return function(n){var i,o;return NewProfile.sections().add_if_necessary(n.authorship.section),i=e.authorship.section(),0===t.get("works_count")?(o=n.authorship.section.id,_.defer(function(){return $("#"+Works.Section.left_menu_id(o)+" a").click()})):void 0}}(this))},n}(Academia.PopoverWidget)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.OrderingView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="ordering_controls",n.prototype.elements={top_icon:"i.fa.fa-arrow-up",up_icon:"i.fa.fa-chevron-up",down_icon:"i.fa.fa-chevron-down",bottom_icon:"i.fa.fa-arrow-down"},n.prototype.events={"click %top_icon":"move_to_top","click %up_icon":"move_up","click %down_icon":"move_down","click %bottom_icon":"move_to_bottom"},n.prototype.template=_.template("<span class='directions'> <i class='fa icon-dark fa-arrow-up' title='Move to top'></i> <i class='fa icon-dark fa-chevron-up' title='Move up'></i> <i class='fa icon-dark fa-chevron-down' title='Move down'></i> <i class='fa icon-dark fa-arrow-down' title='Move to bottom'></i> </span> <span class='handle'> <i class='fa icon-dark fa-bars'></i> </span>"),n.prototype.initialize=function(){return this.section=this.options.section,n.__super__.initialize.apply(this,arguments)},n.prototype.move_to_top=function(e){return e.preventDefault(),this.perform_move(function(e){return function(){return e.section.move_to_top(e.id)}}(this))},n.prototype.move_up=function(e){return e.preventDefault(),this.perform_move(function(e){return function(){return e.section.move_up(e.id)}}(this))},n.prototype.move_down=function(e){return e.preventDefault(),this.perform_move(function(e){return function(){return e.section.move_down(e.id)}}(this))},n.prototype.move_to_bottom=function(e){return e.preventDefault(),this.perform_move(function(e){return function(){return e.section.move_to_bottom(e.id)}}(this))},n.prototype.perform_move=function(e){return this.section.trigger("highlight_work_strip",this.id),e(),_.delay(function(e){return function(){return e.trigger("reorder_works_in_dom")}}(this),50)},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.PaperRankView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.workId=e.workId,this.container=e.container,this.setElement($(".js-paper-rank-view[data-paper-rank-work-id="+this.workId+"]")),this.postRender(),this.fetch(function(e){return function(t){return e.handleData(t)}}(this))},n.prototype.render=function(){},n.prototype.postRender=function(){return this.ui={$rankValue:this.$el.find(".js-paper-rank"),$container:$(this.container)}},n.prototype.fetch=function(e){return window.Academia.paperRanksFetcher.queue(this.workId,e)},n.prototype.handleData=function(e){var t;return t=JSON.parse(e),this.handlePaperRank(t)},n.prototype.handlePaperRank=function(e){return e.bragworthy?(this.insertValue(e.value),this.show()):void 0},n.prototype.insertValue=function(e){return this.ui.$rankValue.text(e.toFixed(1))},n.prototype.show=function(){return this.ui.$container.removeClass("hidden"),this.$el.removeClass("hidden")},n}(Backbone.View)}.call(this),function(){this.Works.ResearchInterestPicker=Backbone.View.extend({render:function(){return this.$el.html(JST[this.options.template]()),this.searchView=new Search.ResearchInterestSearch({el:this.$el.find("input"),collection:this.collection}),this.listenTo(this.searchView,"item-selected",this.addResearchInterest,this),this.listenTo(this.searchView,"item-removed",this.removeResearchInterest,this),this},addResearchInterest:function(e){return this.collection.length>=32?this.trigger("too_many_research_interests"):this.collection.push(e)},removeResearchInterest:function(e){return this.collection.remove(e)}})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.StripView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.elements={title:".title a",edit_link:".edit_work",move_section_link:".move_section_link",delete_link:".delete_work_link",owner_item:"[itemprop=author][data-owner=true]",add_file_from_work_strip:".add_file_from_work_strip"},n.prototype.events={"click %edit_link":"edit_link_clicked","click %add_file_from_work_strip":"add_file_link_clicked","click %move_section_link":"move_section_link_clicked","click %delete_link":"delete_link_clicked"},n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.collection=Works.works(),this.set_edit_permissions()},n.prototype.set_edit_permissions=function(){return this.editable=!1,$a.is_logged_in()?this.coauthor_can_edit()?this.editable=!0:this.add_tooltip(this.$els.edit_link,"Please contact "+this.owner_name()+" to make changes."):void 0},n.prototype.coauthor_can_edit=function(){return this.$el.data("coauthor_editable")||this.current_user_is_owner()},n.prototype.current_user_is_owner=function(){return this.owner_url()&&$current_user.url.replace(/^https?:\/\//,"")===this.owner_url().replace(/^https?:\/\//,"")},n.prototype.owner_name=function(){return this.$els.owner_item.find("span[itemprop=name]").text()},n.prototype.owner_url=function(){return this.$els.owner_item.find("a[itemprop=url]").attr("href")},n.prototype.add_tooltip=function(e,t){return e.attr("title",t),e.addClass("tooltip"),e.tooltip()},n.prototype.edit_link_clicked=function(e,t){return null==t&&(t="edit_link_clicked"),e.preventDefault(),this.editable?(this._record_event(t),$(".works_section").addClass("editing"),this.load_model(function(e){return function(){return e.current_user_is_owner()?e.render_owner_edit_view():e.render_coauthor_edit_view()}}(this))):void 0},n.prototype.add_file_link_clicked=function(e){return this.edit_link_clicked(e,"add_file_clicked")},n.prototype.move_section_link_clicked=function(e){var t;return e.preventDefault(),t=$(e.target),this.load_authorship(function(e){return function(){var n;return n=new Works.MoveSectionPopover({authorship:e.authorship,element:t,position:"right"}),n.render_and_show()}}(this))},n.prototype.delete_link_clicked=function(e){var t,n,i;return e.preventDefault(),t=$(e.target),n="Are you sure you want to delete this work?",i=t.parents(".work").find(".view-count").text(),"0"!==i&&(n+="\n"+i+" views will be forgotten!"),$w.confirm(n,{nextTo:t,warning_icon:!0},function(e){return function(){return e.load_model(function(){return e.model.destroy(),e.remove()})}}(this))},n.prototype.load_authorship=function(e){return this.authorship=new Works.Authorship({work_id:this.options.id}),this.authorship.fetch({success:function(t){return function(){return e&&e(t.authorship),t.authorship.on("change:section",function(){return t.remove()})}}(this)})},n.prototype.load_model=function(e){return this.collection.find(this.options.id,function(t){return function(n){return t.model=n,t.add_model_events(),e?e(n):void 0}}(this))},n.prototype.add_model_events=function(){return this.model.on("sync",function(e){return function(){return e.model.html?e.render(e.model.html):void 0}}(this)),this.model.on("remove",function(e){return function(){return e.remove()}}(this))},n.prototype.render_owner_edit_view=function(e){var t;return null==e&&(e="work_strip_edit"),t=new Works.EditView({model:this.model,source:e,record_events_for:"paper_uploads"}),t.on("cancel save",function(e){return function(){return e.$el.show()}}(this)),this.$el.hide(),t.render().$el.insertAfter(this.$el)},n.prototype.render_coauthor_edit_view=function(e){var t;return null==e&&(e="work_strip_edit"),t=new Works.CoauthorEditView({model:this.model,source:e,record_events_for:"paper_uploads"}),t.on("close",function(e){return function(){return e.$el.show()}}(this)),this.$el.hide(),t.render().$el.insertAfter(this.$el)},n.prototype.add_highlights=function(e){var t;return e.title&&this.$els.title.html(e.title),(e.summary||e.all_plain_text)&&(t=$('<div class="search_highlights"></div>'),this.$el.append(t)),e.summary&&t.append("<div>..."+e.summary+"...</div>"),e.all_plain_text?t.append("<div>..."+e.all_plain_text+"...</div>"):void 0},n}(Academia.StaticView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.AddUrlButton=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="add_url_button",n.prototype.events={click:"click"},n.prototype.template=function(){return"<button class='button upload'> Add Link <i class='fa fa-link'></i> </button>"},n.prototype.click=function(){return this.collection.trigger("edit")},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.NewUrlStrip=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="li",n.prototype.className="editable",n.prototype.jstTemplate="works/templates/urls/url_strip",n.prototype.elements={button:".url_field button",url_input_field:".url_field input",url:".url",errors:".error_messages"},n.prototype.events={"keyup %url_input_field":"update_url","click %button":"save_url","blur %url_input_field":"remove_if_url_empty"},n.prototype.initialize=function(){return this.model=this.collection.pending,this.listenTo(this.model,"invalid",this.render)},n.prototype.render=function(){var e;return n.__super__.render.apply(this,arguments),this.$els.url_input_field.val(this.model.get("url")),(null!=(e=this.model.validationError)?e.url:void 0)?(this.$els.errors.html(this.model.validationError.url[0]),this.$els.errors.show()):this.$els.errors.hide(),this.focus(),this},n.prototype.focus=function(){return this.$els.url_input_field.focus()},n.prototype.update_url=function(e){return 13===e.keyCode?this.save_url():8!==e.keyCode&&46!==e.keyCode||this.model.get("url")?this.model.set({url:this.$els.url_input_field.val()}):this.remove_url()},n.prototype.save_url=function(){return this.collection.add_pending()},n.prototype.remove_url=function(){return this.model.destroy({success:function(e){return function(){return e.remove()}}(this)})},n.prototype.remove_if_url_empty=function(){return this.$els.url_input_field.val()?void 0:this.remove_url()},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.UrlStrip=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="li",n.prototype.jstTemplate="works/templates/urls/url_strip",n.prototype.elements={remove_icon:"i.fa.fa-times"},n.prototype.events={"click %remove_icon":"remove_url"},n.prototype.remove_url=function(){return this.model.destroy({success:function(e){return function(){return e.remove()}}(this)})},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.UrlsList=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="urls_list",n.prototype.elements={urls:".urls"},n.prototype.template=function(){return"<label>Links:</label> <ul class='urls'></ul>"},n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.listenTo(this.collection,"add remove sync",this.render),this.listenTo(this.collection,"edit",this.start_editing)},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),this.editing=!1,this.collection.size()>0?this.$el.show():this.$el.hide(),this.collection.each(function(e){return function(t){var n;return n=new Works.UrlStrip({model:t}),e.$els.urls.append(n.render().$el)}}(this)),this},n.prototype.start_editing=function(){var e;if(!this.editing)return this.editing=!0,this.$el.show(),this.collection.reset_pending(),this.collection.pending.on("destroy",function(e){return function(){return e.render()}}(this)),e=new Works.NewUrlStrip({collection:this.collection}),this.$els.urls.append(e.render().$el),e.focus()},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTags=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Works.CoauthorTag,n.prototype.initialize=function(e,t){return null==e&&(e=[]),null==t&&(t={}),this.workId=t.work_id,this.source=t.source,this.on("remove",function(){return function(e){return e.rejectAsSuggestion()}}(this)),this.comparator=function(e){return e.has("display_order")?e.get("display_order"):1/0},(this.owner=t.includeOwner)&&(e.push(this._dummyOwnerAuthorTag()),this.on("sync",function(e){return function(){return e._addDummyOwnerAuthorTag()}}(this))),e=_.map(e,function(e){return function(t){return e._prepareModel(t)}}(this)),this._lockNonEditableTags(e),this.on("sync",function(e){return function(){return e._lockNonEditableTags()}}(this))},n.prototype._prepareModel=function(e){return(e=n.__super__._prepareModel.apply(this,arguments))?(null==this.source||e.has("source")||e.set("source",this.source),null==this.workId||e.has("work_id")||e.set("work_id",this.workId),e.has("display_order")||e.set("display_order",this.length),e):void 0},n.prototype._addDummyOwnerAuthorTag=function(){return this.add(this._dummyOwnerAuthorTag(),{silent:!0}),this.sort()},n.prototype._dummyOwnerAuthorTag=function(e){return null==e&&(e=this.owner),new Works.CoauthorTag({id:e.id,name:e.display_name,email:e.email,display_order:0,locked:!0})},n.prototype._lockNonEditableTags=function(e){return null==e&&(e=this.models),_.each(e,function(e){return e.has("tagging_user_id")&&e.get("tagging_user_id")!==$current_user.id?e.set("locked",!0):void 0})},n.prototype.url=function(){return $r.api_v0_work_co_author_tags_path({subdomain_param:"api",work_id:this.workId})},n.prototype.parse=function(e){return e.co_author_tags},n.prototype.saveOrdering=function(){return $.ajax({type:"PUT",url:$r.set_order_api_v0_work_co_author_tags_path({subdomain_param:"api",work_id:this.workId}),data:{ordered_emails:this.invoke("uniqueEmail")}})},n}(Backbone.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.ResearchInterests=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e,t){return this.workId=null!=t?t.work_id:void 0,this.on("remove",function(e){return function(t){return e.rejectAsSuggestion(t)}}(this)),n.__super__.initialize.apply(this,arguments)},n.prototype.url=function(){return $r.api_v0_taggings_path({subdomain_param:"api",tag_type:"ResearchInterest",target_type:"Work",target_id:this.workId})},n.prototype.rejectAsSuggestion=function(e){return this.workId&&e.has("id")?$.post($r.api_v0_work_research_interest_reject_suggestion_path({work_id:this.workId,research_interest_id:e.get("id"),subdomain_param:"api"})):void 0},n.prototype.followersReached=function(){var e;return e=0,this.each(function(){return function(t){return e+=t.get("followers")}}(this)),e},n}(Backbone.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.Sections=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Works.Section,n.prototype.initialize=function(){return this.on("change:count",function(e){return function(t){return t.get("works_count")<=0?e.remove(t):void 0}}(this))},n.prototype.by_name=function(e){return this.where({name:e})[0]},n.prototype.exists=function(e){return _.include(this.pluck("name"),e)},n.prototype.suggested=function(){var e,t,n,i;n=Works.SECTIONS,i=[];for(t in n)e=n[t],this.exists(t)||"Other"===t||i.push(t);return i},n.prototype.add_if_necessary=function(e){return this.exists(e.name)?void 0:this.add(e)},n}(Academia.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestedClusters=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url=function(){return $r.clusters_api_v0_suggestions_works_url()},n.prototype.model=Works.SuggestedCluster,n.prototype.initialize=function(e,t){return this.source=null!=t?t.source:void 0,this.someConfidenceThreshold=(null!=t?t.someConfidenceThreshold:void 0)||.25,this.highConfidenceThreshold=(null!=t?t.highConfidenceThreshold:void 0)||.75,this.fetched=!!(e&&e.length>0),this.listenForFetch(),this.saveOperations=[],n.__super__.initialize.apply(this,arguments)},n.prototype.listenForFetch=function(){return this.on("request",function(e){return function(){return e.fetched=!1,e.fetching=!0}}(this)),this.on("sync error",function(e){return function(){return e.fetching=!1,e.fetched=!0}}(this))},n.prototype.fetch=function(e){return null==e&&(e={}),this.fetching?void 0:(e.dataType="jsonp",n.__super__.fetch.call(this,e))},n.prototype.parse=function(e){return _(e.clusters||e).map(function(){return function(e){return new Works.SuggestedCluster(e,{parse:!0})}}(this))},n.prototype.getHighConfidenceWorks=function(){return _.chain(this.getHighConfidenceClusters()).map(function(e){return e.get("papers").models}).flatten().value()},n.prototype.getTopUnclaimedWorks=function(e){return _.chain(this.getHighConfidenceWorks()).filter(function(e){return e.get("found_authors").length>0}).filter(function(e){return!e.has("work_id")}).sortBy(function(e){return-e.get("found_authors").length}).first(e).value()},n.prototype.getTotalClaimedCount=function(){return this.reduce(function(e,t){return e+t.get("papers").where({claimStatus:"claim",decided:!0}).length},0)},n.prototype.getHighConfidenceClusters=function(){return this.filter(function(e){return function(t){return t.get("confidence")>=e.highConfidenceThreshold}}(this))},n.prototype.whenAllSaves=function(){return $a.admin_log("Waiting on "+this.saveOperations.length+" save operations"),$.when.apply($,this.saveOperations)},n.prototype.groupHighConfidenceClusters=function(e){var t,n,i,o,r,s;return r=_(e).reduce(function(e,t){return e+t.get("papers").length},0),0>=r?[]:r>20?(t=[],i=[],n=0,o=0,_(e).each(function(e){return n>o?(i.push(e),o+=e.get("papers").length):(t.push(e),n+=e.get("papers").length)}),s=[Works.SuggestedCluster.mergeIntoOne(t)],i.length>0&&s.push(Works.SuggestedCluster.mergeIntoOne(i)),s):[Works.SuggestedCluster.mergeIntoOne(e)]},n.prototype.getSomeConfidenceClusters=function(){return this.filter(function(e){return function(t){return t.get("confidence")>e.someConfidenceThreshold&&t.get("confidence")<e.highConfidenceThreshold}}(this))},n.prototype.getNoConfidenceClusters=function(){return this.filter(function(e){return function(t){return t.get("confidence")<=e.someConfidenceThreshold}}(this))},n.prototype.organizeByConfidenceAndUpdateDefaults=function(e){var t,n,i,o;return null==e&&(e={}),_.defaults(e,{showLowConfidence:!1}),t=this.getHighConfidenceClusters(),o=this.getSomeConfidenceClusters(),i=this.getNoConfidenceClusters(),this.set(this.groupHighConfidenceClusters(t)),e.showLowConfidence||_(o).each(function(e){return e.get("papers").each(function(e){return e.set("claimStatus","anticlaim")})}),o.length>0&&this.add(o),i.length>0&&e.showLowConfidence?(n=Works.SuggestedCluster.mergeIntoOne(i),n.get("papers").invoke("set",{claimStatus:"anticlaim"}),this.add(n)):void 0},n}(Backbone.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestedCoauthors=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url=function(){return $r.api_v0_suggestions_coauthors_url()},n.prototype.model=Works.SuggestedCoauthor,n.prototype.initialize=function(e,t){return this.source=null!=t?t.source:void 0,n.__super__.initialize.apply(this,arguments)},n.prototype.parse=function(e){return _(e).map(function(e){return function(t){return null!=e.source&&(t.source=e.source),new Works.SuggestedCoauthor(t,{parse:!0})}}(this))},n.prototype.comparator=function(e){return e.get("tags").length},n.prototype.markAllAsRejected=function(){return _(this.models).each(function(e){return e.set("accept",!1)})},n.prototype.hasExpandedCoauthor=function(){return this.where({isExpanded:!0}).length>0},n.prototype.flattenedTagsWithAcceptState=function(){var e;return e=_(this.models).map(function(e){return _(e.get("tags")).map(function(){return function(t){return t.accepted=e.get("accept").toString(),t.source=e.get("source"),t}}(this))}),_.flatten(e)},n.prototype.batchSaveSuggestions=function(){var e;return e=this.flattenedTagsWithAcceptState(),$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:$r.batch_create_api_v0_suggestions_coauthors_path({subdomain_param:"api"}),data:JSON.stringify({coauthor_tags:e}),complete:function(e){return function(){return e.trigger("batch-saved")}}(this)})},n}(Backbone.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestedWorks=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Works.SuggestedWork,n.prototype.url=$r.api_v0_suggestions_works_path({subdomain_param:"api"}),n.prototype.initialize=function(e,t){return this.cluster=null!=t?t.cluster:void 0},n.prototype.parse=function(e){return null==(null!=e?e.works:void 0)?[]:_(null!=e?e.works:void 0).map(function(e){return function(t){return new Works.SuggestedWork(t,{collection:e})}}(this))},n}(Backbone.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Works.SuggestionsByCoauthor=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url=$r.by_coauthor_api_v0_suggestions_works_url(),n.prototype.model=Works.SuggestedCoauthor,n.prototype.initialize=function(e,t){return this.source=null!=t?t.source:void 0,this.lowConfidenceThreshold=.25,this.mediumConfidenceThreshold=.5,this.fetched=!!(e&&e.length>0),this.listenForFetch(),n.__super__.initialize.apply(this,arguments)},n.prototype.listenForFetch=function(){return this.on("request",function(e){return function(){return e.fetched=!1,e.fetching=!0}}(this)),this.on("sync error",function(e){return function(){return e.fetching=!1,e.fetched=!0}}(this))},n.prototype.fetch=function(e){return null==e&&(e={}),this.fetching?void 0:(e.dataType="jsonp",n.__super__.fetch.call(this,e))},n.prototype.parse=function(e){return this.coauthor_pagination="yes"===e.coauthor_pagination,_(e.co_authors).map(function(){return function(e){return new Works.SuggestedCoauthor(_.extend({acceptedCoauthors:!0},e))}}(this))},n.prototype.save=function(){return $.when(this._saveAccepted(),this._saveRejected())},n.prototype._saveAccepted=function(){var e,t,n;return n=this.acceptedCoauthors(),n.length<=0?(t=new $.Deferred,t.resolve(),t):(_(n).each(function(e){return e.set("paper_ids",_(e.get("papers")).pluck("id"))}),e=this.paperIdsFromCoauthors(n),this._postClaim({papers:e,tagged_coauthors:n,claim_method:"claim"}))},n.prototype._saveRejected=function(){var e,t,n,i,o;return n=_.filter(this.rejectedCoauthors(),function(e){return e.hasEmail()}),n.length<=0?(t=new $.Deferred,t.resolve(),t):(i=this.paperIdsFromCoauthors(n),e=this.paperIdsFromCoauthors(this.acceptedCoauthors()),o=_.difference(i,e),this._postClaim({papers:o,claim_method:"anticlaim"}))},n.prototype._postClaim=function(e){return $.ajax({url:$r.api_v0_paper_claims_path({subdomain_param:"api"}),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(_.extend({source:this.source},e))})},n.prototype.acceptedCoauthors=function(){return this.where({claimStatus:"claim",optedIn:!0})},n.prototype.rejectedCoauthors=function(){return this.where({claimStatus:"anticlaim",optedIn:!0})},n.prototype.paperIdsFromCoauthors=function(e){return _.chain(e).map(function(e){return e.get("papers")}).flatten().pluck("id").uniq().value()},n.prototype.organizeByConfidence=function(){var e,t,n;return e=this.filter(function(e){return e.get("confidence")>=this.mediumConfidenceThreshold},this),n=this.filter(function(e){return e.get("confidence")>this.lowConfidenceThreshold&&e.get("confidence")<this.mediumConfidenceThreshold},this),t=this.filter(function(e){return e.get("confidence")<=this.lowConfidenceThreshold},this),e.length>0?(this.set(e),n.length>0&&e.length<25?_.each(n,function(e){return function(t){return t.set({claimStatus:"anticlaim"}),e.add(t)}}(this)):void 0):n.length>0?(_.each(n,function(e){return e.set({claimStatus:"anticlaim"})}),this.set(n)):t.length>0?(_.each(t,function(e){return e.set({claimStatus:"anticlaim"})}),this.set(t)):this.reset()},n.prototype.countsByConfidence=function(e){var t,n,i,o;return null==e&&(e=!1),t=this.filter(function(t){return t.get("confidence")>=this.mediumConfidenceThreshold&&("claim"===t.get("claimStatus")||!e)},this),o=this.filter(function(t){return t.get("confidence")>this.lowConfidenceThreshold&&t.get("confidence")<this.mediumConfidenceThreshold&&("claim"===t.get("claimStatus")||!e)},this),n=this.filter(function(t){return t.get("confidence")<=this.lowConfidenceThreshold&&("claim"===t.get("claimStatus")||!e)},this),i={high_conf:t.length,some_conf:o.length,low_conf:n.length}},n.prototype.numClaimed=function(){return this.filter(function(e){return e.get("optedIn")&&e.isClaimed()}).length},n.prototype.allClaimed=function(){return _.every(this.visibleSuggestions(),function(e){return e.get("optedIn")&&e.isClaimed()})},n.prototype.keepOnlyAcceptedNameOnlySuggestions=function(){return this.set(this.where({encrypted_email:null,claimStatus:"claim",optedIn:!0}))},n.prototype.keepOnlyNameOnlySuggestionsWithValidEmails=function(){return this.set(this.filter(function(e){return e.hasValidEmail()}))},n.prototype.visibleSuggestions=function(){return this.filter(function(e){return e.get("optedIn")})},n.prototype.matchContacts=function(e){return this.numMatchedContacts=0,_.each(e,function(e){return function(t,n){var i;return i=e.findWhere({name:n}),i.hasValidEmail()?void 0:(i.set("email",t),e.numMatchedContacts+=1)}}(this)),Academia.RegPath.eventDispatcher.trigger("nameOnlyCoauthors:contactsImported")},n}(Backbone.Collection)}.call(this),function(){Works.Urls=Academia.Collection.extend({model:Works.Url,comparator:"id",initialize:function(e,t){return this.work=t.work,this.on("add",function(e){return function(t){return t.set({work_id:e.work.id},{silent:!0}),t.isNew()&&!e.work.isNew()?t.save():void 0}}(this))},reset_pending:function(){return this.pending=new Works.Url},add_pending:function(){return this.pending&&this.pending.get("url")?this.pending.isValid()?(this.add(this.pending),this.reset_pending(),!0):!1:void 0
}})}.call(this),function(){this.Works.Works=Academia.Collection.extend({model:Works.Work,url:function(){return $r.api_v0_user_works_url("undefined"==typeof $current_user||null===$current_user?{user_id:$viewed_user.id}:{user_id:$current_user.id})}})}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/attachments/attachment_strip"]=function(e){var t,n=[],i=e||{};return function(i){n.push('<span class="info">'),e.file_type&&n.push("["+jade.escape(null==(t=i)?"":t)+"]"),n.push("</span>"+jade.escape(null==(t=e.file_name||e.url)?"":t)+'<i class="fa icon-dark fa-times remove"></i>')}.call(this,"file_type"in i?i.file_type:"undefined"!=typeof file_type?file_type:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/coauthor_edit"]=function(e){var t=[],n=e||{};return function(e){t.push('<form class="clearfix"><div class="input input_title"><input name="title" disabled="disabled"'+jade.attr("value",e,!0,!1)+'/></div></form><div class="work_editable_list_container clearfix coauthors_list_container"><div class="work_editable_list_label">Authors:</div><div class="coauthor_tags_list"></div></div><div class="clearfix"><div class="pull-right"><a href="#" class="cancel">Close</a></div></div>')}.call(this,"title"in n?n.title:"undefined"!=typeof title?title:void 0),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/coauthor_tag_edit"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div class="container-fluid works-coauthor-edit-popover"><div class="row js-works-coauthor-errors"></div><div class="row"><input readonly="readonly"'+jade.attr("value",e.get("name"),!0,!1)+' class="form-control input-sm input-unstyled-while-readonly text-bold js-works-coauthor-edit-name"/></div><div class="row">'),n.push(e.has("tagged_user_id")&&e.has("affiliation")?'<span class="form-control input-sm input-unstyled-while-readonly text-slim">'+jade.escape(null==(t=e.get("affiliation"))?"":t)+"</span>":e.has("tagged_user_id")?'<span class="form-control input-sm input-unstyled-while-readonly text-slim">'+jade.escape(null==(t=e.get("email"))?"":t)+'&nbsp; &nbsp;<i class="fa fa-check"></i></span>':'<input readonly="readonly"'+jade.attr("value",e.get("email"),!0,!1)+' class="form-control input-sm input-unstyled-while-readonly text-slim js-works-coauthor-edit-email"/>'),n.push('</div><div class="row padding-top-1x hidden js-works-coauthor-save-or-cancel"><div class="col-xs-6 text-left"><div class="row"><a class="btn btn-sm btn-none text-gray-light js-works-coauthor-cancel">Cancel</a></div></div><div class="col-xs-6 text-right"><div class="row"><button class="btn btn-sm btn-success js-works-coauthor-save">Save</button></div></div></div></div>')}.call(this,"tag"in i?i.tag:"undefined"!=typeof tag?tag:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/edit"]=function(){var e=[];return e.push('<div class="add_file clearfix"><div class="attachment_upload_button"></div></div><form class="clearfix inline-labels"></form><div class="work_editable_list_container clearfix coauthors_list_container"><div class="work_editable_list_label">Authors:</div><div class="coauthor_tags_list"></div></div><div class="work_editable_list_container clearfix"><div class="work_editable_list_label">Research Interests:</div><div class="profile_research_interest_list"></div></div><div class="add_meta_links clearfix"></div><div class="attachments_list list clearfix"></div><div class="urls_list list clearfix"></div><div class="clearfix"><div class="action_links"><div class="right"><a href="#" class="cancel">Cancel</a><a href="#" class="save button blue">Save</a></div><div class="left"><div class="add_url_button"></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/full_screen_modal"]=function(e){var t=[],n=e||{};return function(e){t.push('<div class="bootstrap"><div class="container-fluid"><div class="row full-screen-modal-header"><div class="col-xs-3 vcenter margin-vertical-5x"><i class="close-full-screen-modal clickable fa fa-times fa-2x"></i><i class="close-full-screen-modal-refresh clickable fa fa-times fa-2x"></i></div><div class="col-xs-6 vcenter"><img'+jade.attr("src",""+e("academia-logo-redesign-2015.svg"),!0,!1)+jade.attr("onerror","this.onerror=null;this.src="+e("academia-logo-redesign-2015.png"),!0,!1)+' class="Logo center-block margin-vertical-6x"/></div></div><div class="row full-screen-modal-page center-block"><div class="col-md-12"><div class="row"><div class="col-xs-12"><div class="full-screen-modal-page-header text-center"><h1 class="text-base-color text-slim"></h1></div></div></div><div class="row"><div class="col-xs-12"><div class="full-screen-modal-page-content"></div></div></div></div></div></div></div>')}.call(this,"$image_url"in n?n.$image_url:"undefined"!=typeof $image_url?$image_url:void 0),t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/invite_coauthor_modal"]=function(){var e=[];return e.push('<div id="coauthor-search-invite-coauthor-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-header"><button aria-label="Close" data-dismiss="modal" type="button" class="close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title text-center"><strong>Invite Co-Authors</strong></h4></div><div class="modal-body"><div class="row alert-box text-center"><div class="col-xs-12 alert-list"></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label for="add-coauthor-name">Name</label><input type="text" id="add-coauthor-name" placeholder="add co-author name..." class="form-control"/></div></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label for="add-coauthor-email">Email</label><input type="text" id="add-coauthor-email" placeholder="add co-author email..." class="form-control"/></div></div></div><div class="row text-center"><div class="col-xs-12"><button type="button" class="btn btn-lg btn-none js-invite-coauthor-link"><i class="fa-plus fa text-gray-dark"></i><span class="h5 text-bold text-gray-dark">&nbsp;&nbsp;ADD CO-AUTHOR</span></button></div></div></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/move_section_popover"]=function(e){var t,n=[],i=e||{};return function(e,i,o){n.push('<div class="work_move_section"><h3>Currently in <strong>'+jade.escape(null==(t=i)?"":t)+"</strong></h3><ul><lh>Move to:</lh>"),e.each(o,function(e){i!=e&&n.push('<li class="section">'+jade.escape(null==(t=e)?"":t)+"</li>")}),n.push('</ul><div>Or move to a new section:<div class="new_section_input input"></div></div></div>')}.call(this,"_"in i?i._:"undefined"!=typeof _?_:void 0,"current_section"in i?i.current_section:"undefined"!=typeof current_section?current_section:void 0,"section_names"in i?i.section_names:"undefined"!=typeof section_names?section_names:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/suggestable_tag"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<span class="text-bold text-gray-dark">'+jade.escape(null==(t=e.name)?"":t)+"&nbsp;&nbsp;"),e.locked||n.push('<a type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Remove</span></a>'),n.push("</span>")}.call(this,"model"in i?i.model:"undefined"!=typeof model?model:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["works/templates/urls/url_strip"]=function(e){var t,n=[];return n.push('<div class="url_field input"><input type="text"/><button class="button">Add</button></div><div class="url">'+jade.escape(null==(t=e.url)?"":t)+'</div><div class="error_messages hidden"></div><i class="fa icon-dark fa-times"></i>'),n.join("")}}.call(this),function(){var e="undefined"!=typeof FS;if(e&&$a.is_logged_in()){var t={id_int:c.User.current.id,displayName:c.User.current.display_name,email:c.User.current.email};_.each(c.User.current.active_rollout_features,function(e){var n="rollout_"+e,i=n.replace(/_([a-z])/g,function(e){return e[1].toUpperCase()}),o=i+"_bool";t[o]=!0}),FS.identify(c.User.current.id,t)}}(),window.Aedu=window.Aedu||{},window.Aedu.Ajax={},window.Aedu.Reducers={},window.Aedu.ActionCreators={},function(){"use strict";var e=function(e){return e?_.reduce(_.keys(e).sort(),function(t,n){return t+n+JSON.stringify(e[n])},""):"{}"};Aedu.Ajax.cachePromise=function(t){var n={};return function(i){var o=e(i);if(n[o])return n[o];var r=t(i);return n[o]=r,r.fail(function(){delete n[o]}),r}}}(),function(){"use strict";Aedu.Ajax.AllTimeHitsByCountryService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.all_time_hits_by_country_api_v0_user_stats_path(t))}),Aedu.Ajax.HitsService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.hits_api_v0_user_stats_path(t))}),Aedu.Ajax.DownloadsService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.downloads_api_v0_user_stats_path(t))}),Aedu.Ajax.PercentilesService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.api_v0_works_percentiles_path(t))}),Aedu.Ajax.WorksService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.works_api_v0_user_stats_path(t))}),Aedu.Ajax.AllTimeHitsByRefererService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.all_time_referer_hit_counts_api_v0_user_stats_path(t))}),Aedu.Ajax.PercentilesService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.thirty_day_percentiles_api_v0_user_stats_path(t))})}(),window.Aedu.ActionTypes={UPDATE_READ_EVENTS_META:"UPDATE_READ_EVENTS_META",UPDATE_READ_EVENT:"UPDATE_READ_EVENT",BATCH_ADD_READ_EVENT:"BATCH_ADD_READ_EVENT",AnalyticsDashboard:{BATCH_ADD_HIT:"ANALYTICS_DASHBOARD__BATCH_ADD_HIT",UPDATE_HITS_META:"ANALYTICS_DASHBOARD__UPDATE_HITS_META",BATCH_ADD_OLD_HIT:"ANALYTICS_DASHBOARD__BATCH_ADD_OLD_HIT",UPDATE_OLD_HITS_META:"ANALYTICS_DASHBOARD__UPDATE_OLD_HITS_META",BATCH_ADD_COUNTRY:"ANALYTICS_DASHBOARD__BATCH_ADD_COUNTRY",UPDATE_COUNTRIES_META:"ANALYTICS_DASHBOARD__UPDATE_COUNTRIES_META",BATCH_ADD_DOWNLOAD:"ANALYTICS_DASHBOARD__BATCH_ADD_DOWNLOAD",UPDATE_DOWNLOADS_META:"ANALYTICS_DASHBOARD__UPDATE_DOWNLOADS_META",BATCH_ADD_OLD_DOWNLOAD:"ANALYTICS_DASHBOARD__BATCH_ADD_OLD_DOWNLOAD",UPDATE_OLD_DOWNLOADS_META:"ANALYTICS_DASHBOARD__UPDATE_OLD_DOWNLOADS_META",BATCH_ADD_REFERER_PAIR:"ANALYTICS_DASHBOARD__BATCH_ADD_REFERER_PAIR",UPDATE_REFERER_PAIRS_META:"ANALYTICS_DASHBOARD__UPDATE_REFERER_PAIRS_META",SET_DISPLAYED_DATES:"ANALYTICS_DASHBOARD__SET_DISPLAYED_DATES",UPDATE_WORKS_META:"ANALYTICS_DASHBOARD__UPDATE_WORKS_META",BATCH_ADD_WORK:"ANALYTICS_DASHBOARD__BATCH_ADD_WORK",UPDATE_DOCS_META:"ANALYTICS_DASHBOARD__UPDATE_DOCS_META",BATCH_ADD_DOC:"ANALYTICS_DASHBOARD__BATCH_ADD_DOC",BATCH_ADD_READER_RESEARCH_INTEREST:"ANALYTICS_DASHBOARD__BATCH_ADD_READER_RESEARCH_INTEREST",UPDATE_READER_RESEARCH_INTERESTS_META:"ANALYTICS_DASHBOARD__UPDATE_READER_RESEARCH_INTERESTS_META",BATCH_ADD_PERCENTILE:"ANALYTICS_DASHBOARD__BATCH_ADD_PERCENTILE",UPDATE_PERCENTILES_META:"ANALYTICS_DASHBOARD__UPDATE_PERCENTILES_META",BATCH_ADD_RESEARCH_INTEREST_PERCENTILE:"ANALYTICS_DASHBOARD__BATCH_ADD_RESEARCH_INTEREST_PERCENTILE",UPDATE_RESEARCH_INTEREST_PERCENTILES_META:"ANALYTICS_DASHBOARD__UPDATE_RESEARCH_INTEREST_PERCENTILES_META"}},window.Aedu.WorkConstants={CV_WORK_ID:-1},window.Aedu.ActionCreators.AnalyticsDashboard={},function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Countries.meta.exhausted&&!t().AnalyticsDashboard.Countries.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_COUNTRIES_META,meta:{fetching:!0}});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);$.when(Aedu.Ajax.HitsService(n),Aedu.Ajax.AllTimeHitsByCountryService()).done(function(t,n){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_COUNTRIES_META,meta:{fetching:!1,exhausted:!0,errorFetching:!1}});var i=Aedu.ModelCreators.Countries(t[0].hits,n[0].countries.totals);e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_COUNTRY,countries:i})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_COUNTRIES_META,meta:{fetching:!1,errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.Countries={fetch:e}}(),function(){"use strict";var e={start:moment().subtract(30,"days").format(),finish:moment().format()},t=function(){var t=_.chain($a.decompose_url(location.href)[1]).object().pick("start","finish").value();return _.chain(t).defaults(e).map(function(e,t){return[t,new Date(e)]}).object().value()},n=function(){return function(e,n){var i=t(),o=n().AnalyticsDashboard.DisplayedDates;_.isEqual(i,o)||e({type:Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES,start:i.start,finish:i.finish})}};Aedu.ActionCreators.AnalyticsDashboard.DisplayedDates={initialize:n}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Docs.meta.exhausted&&!t().AnalyticsDashboard.Docs.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOCS_META,meta:{fetching:!0}});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.ModelFetchers.Docs(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_DOC,docs:t}),e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOCS_META,meta:{fetching:!1,exhausted:!0,fetchingError:!1}})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOCS_META,meta:{fetching:!1,errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.Docs={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Downloads.meta.exhausted&&!t().AnalyticsDashboard.Downloads.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOWNLOADS_META,meta:{fetching:!0}});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.Ajax.DownloadsService(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOWNLOADS_META,meta:{fetching:!1,exhausted:!0}}),e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_DOWNLOAD,downloads:t.downloads})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOWNLOADS_META,meta:{errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.Downloads={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Hits.meta.exhausted&&!t().AnalyticsDashboard.Hits.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_HITS_META,meta:{fetching:!0}});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.Ajax.HitsService(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_HITS_META,meta:{fetching:!1,exhausted:!0}}),e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_HIT,hits:t.hits})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_HITS_META,meta:{errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.Hits={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){t().AnalyticsDashboard.Percentiles.meta.exhausted||t().AnalyticsDashboard.Percentiles.meta.fetching||(e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_PERCENTILES_META,meta:{fetching:!0}}),$.when(Aedu.Ajax.PercentilesService()).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_PERCENTILES_META,meta:{fetching:!1,exhausted:!0,errorFetching:!1}}),e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_PERCENTILE,percentiles:t.percentiles})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_PERCENTILES_META,meta:{fetching:!1,errorFetching:!0}})}))}};Aedu.ActionCreators.AnalyticsDashboard.Percentiles={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.PreviousDateRangeDownloads.meta.exhausted&&!t().AnalyticsDashboard.PreviousDateRangeDownloads.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_DOWNLOADS_META,meta:{fetching:!0}});var n=t().AnalyticsDashboard.DisplayedDates,i=Analytics.Utilities.dateParams({start:moment(n.start).subtract(n.dayCount,"days").toDate(),finish:moment(n.finish).subtract(n.dayCount,"days").toDate()});Aedu.Ajax.DownloadsService(i).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_DOWNLOADS_META,meta:{fetching:!1,exhausted:!0}}),e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_OLD_DOWNLOAD,downloads:t.downloads})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_DOWNLOADS_META,meta:{errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.PreviousDateRangeDownloads={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.PreviousDateRangeHits.meta.exhausted&&!t().AnalyticsDashboard.PreviousDateRangeHits.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_HITS_META,meta:{fetching:!0}});var n=t().AnalyticsDashboard.DisplayedDates,i=Analytics.Utilities.dateParams({start:moment(n.start).subtract(n.dayCount,"days").toDate(),finish:moment(n.finish).subtract(n.dayCount,"days").toDate()});Aedu.Ajax.HitsService(i).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_HITS_META,meta:{fetching:!1,exhausted:!0}}),e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_OLD_HIT,hits:t.hits})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_HITS_META,meta:{errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.PreviousDateRangeHits={fetch:e}}(),function(){"use strict";var e=5e3,t=function(){return function(t,n){if(!n().AnalyticsDashboard.ReaderResearchInterests.meta.exhausted&&!n().AnalyticsDashboard.ReaderResearchInterests.meta.fetching){t({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_READER_RESEARCH_INTERESTS_META,meta:{fetching:!0}});var i=Analytics.Utilities.dateParams(n().AnalyticsDashboard.DisplayedDates);!function o(){var n=_.extend({subdomain_param:"api",user_id:Aedu.User.viewed.id},i);$.getJSON($r.reader_research_interests_api_v0_user_stats_path(n)).done(function(n){return"processing"===n.status?void setTimeout(o,e):(t({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_READER_RESEARCH_INTERESTS_META,meta:{fetching:!1,exhausted:!0}}),void t({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_READER_RESEARCH_INTEREST,readerResearchInterests:n.reader_research_interests}))}).fail(function(){t({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_READER_RESEARCH_INTERESTS_META,meta:{errorFetching:!0}})})}()}}};Aedu.ActionCreators.AnalyticsDashboard.ReaderResearchInterests={fetch:t}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.RefererPairs.meta.exhausted&&!t().AnalyticsDashboard.RefererPairs.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_REFERER_PAIRS_META,meta:{fetching:!0}});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);$.when(Aedu.Ajax.AllTimeHitsByRefererService(),Aedu.Ajax.HitsService(n),Aedu.Ajax.WorksService(n)).done(function(t,n,i){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_REFERER_PAIRS_META,meta:{fetching:!1,exhausted:!0,errorFetching:!1}});var o=Aedu.ModelCreators.RefererPairs(t[0].referer_hit_counts,n[0].hits,i[0].works);e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_REFERER_PAIR,refererPairs:o})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_REFERER_PAIRS_META,meta:{fetching:!1,errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.RefererPairs={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){t().AnalyticsDashboard.ResearchInterestPercentiles.meta.exhausted||t().AnalyticsDashboard.ResearchInterestPercentiles.meta.fetching||(e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_RESEARCH_INTEREST_PERCENTILES_META,meta:{fetching:!0}}),$.when(Aedu.Ajax.PercentilesService()).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_RESEARCH_INTEREST_PERCENTILES_META,meta:{fetching:!1,exhausted:!0,errorFetching:!1}}),e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_RESEARCH_INTEREST_PERCENTILE,researchInterestPercentiles:t.research_interest_percentiles})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_RESEARCH_INTEREST_PERCENTILES_META,meta:{fetching:!1,errorFetching:!0}})}))}};Aedu.ActionCreators.AnalyticsDashboard.ResearchInterestPercentiles={fetch:e}}(),function(){"use strict";var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Works.meta.exhausted&&!t().AnalyticsDashboard.Works.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_WORKS_META,meta:{fetching:!0}});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.ModelFetchers.Docs(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_WORKS_META,meta:{fetching:!1,exhausted:!0,fetchingError:!1}});var n=_.find(t,function(e){return e.id===Aedu.WorkConstants.CV_WORK_ID});e({type:Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_WORK,works:_.without(t,n)})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.UPDATE_WORKS_META,meta:{fetching:!1,errorFetching:!0}})})}}};Aedu.ActionCreators.AnalyticsDashboard.Works={fetch:e}}(),function(){"use strict";var e=function(e){return function(t,n){var i=_.findWhere(n().ReadEvents.models,{id:e});t({type:Aedu.ActionTypes.UPDATE_READ_EVENT,readEvent:{id:i.id,likeToggleRequestFired:!0}}),$.ajax({type:"POST",url:$r.api_v0_reader_message_like_message_path({subdomain_param:"api",reader_message_id:i.reader_message.id})}).success(function(){t({type:Aedu.ActionTypes.UPDATE_READ_EVENT,readEvent:{id:i.id,reader_message:_.extend({},i.reader_message,{liked:!i.reader_message.liked}),likeToggleRequestFired:!1}})}).fail(function(){t({type:Aedu.ActionTypes.ADD_READ_EVENT,readEvent:{id:i.id,likeToggleRequestFired:!1}})})}},t=function(e,t){var n={user_id:$current_user.id,subdomain_param:"api"};return t().ReadEvents.meta.cursor&&(n.cursor=t().ReadEvents.meta.cursor),$.getJSON($r.read_events_api_v0_user_stats_path(n)).done(function(t){e({type:Aedu.ActionTypes.UPDATE_READ_EVENTS_META,meta:{cursor:t.read_events.cursor,exhausted:t.read_events.exhausted}}),e({type:Aedu.ActionTypes.BATCH_ADD_READ_EVENT,readEvents:t.read_events.models})})},n=function(){return function(e,n){if(!n().ReadEvents.meta.exhausted&&!n().ReadEvents.meta.fetching){e({type:Aedu.ActionTypes.UPDATE_READ_EVENTS_META,meta:{fetching:!0}});var i=_.filter(n().ReadEvents.models,function(e){return e.has_reader_message}).length,o=i+10;!function r(){t(e,n).done(function(){var t=_.filter(n().ReadEvents.models,function(e){return e.has_reader_message}).length,i=t>=o||n().ReadEvents.meta.exhausted;return i?void e({type:Aedu.ActionTypes.UPDATE_READ_EVENTS_META,meta:{fetching:!1}}):r()})}()}}},i=function(){return function(e,n){if(!n().ReadEvents.meta.exhausted&&!n().ReadEvents.meta.fetching){e({type:Aedu.ActionTypes.UPDATE_READ_EVENTS_META,meta:{fetching:!0}});var i=n().ReadEvents.models.length,o=i+10;!function r(){t(e,n).done(function(){var t=n().ReadEvents.models.length,i=t>=o||n().ReadEvents.meta.exhausted;return i?void e({type:Aedu.ActionTypes.UPDATE_READ_EVENTS_META,meta:{fetching:!1}}):r()})}(),fetch()}}};window.Aedu.ActionCreators.ReadEvents={toggleLiked:e,fetchAll:i,fetchReaderMessages:n}}(),window.Aedu.Reducers.AnalyticsDashboard={},function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.Countries=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_COUNTRY:return _.extend({},t,{models:t.models.concat(n.countries)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_COUNTRIES_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){"use strict";var e={start:null,finish:null,dayCount:null},t=function(e,t){var n=moment(t).diff(moment(e));return Math.round(n/1e3/60/60/24)};Aedu.Reducers.AnalyticsDashboard.DisplayedDates=function(n,i){switch(n=n||e,i.type){case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return _.extend({},n,{start:i.start,finish:i.finish,dayCount:t(i.start,i.finish)});default:return n}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1}};Aedu.Reducers.AnalyticsDashboard.Docs=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_DOC:return _.extend({},t,{models:t.models.concat(n.docs)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOCS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1}};Aedu.Reducers.AnalyticsDashboard.Downloads=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_DOWNLOAD:return _.extend({},t,{models:t.models.concat(n.downloads)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_DOWNLOADS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.Hits=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_HIT:return _.extend({},t,{models:t.models.concat(n.hits)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_HITS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.Percentiles=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_PERCENTILE:return _.extend({},t,{models:t.models.concat(n.percentiles)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_PERCENTILES_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeDownloads=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_OLD_DOWNLOAD:return _.extend({},t,{models:t.models.concat(n.downloads)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_DOWNLOADS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeHits=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_OLD_HIT:return _.extend({},t,{models:t.models.concat(n.hits)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_OLD_HITS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){"use strict";var e={perPageCounts:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.ReaderResearchInterests=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_READER_RESEARCH_INTEREST:return _.extend({},t,{perPageCounts:t.perPageCounts.concat(n.readerResearchInterests)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_READER_RESEARCH_INTERESTS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.RefererPairs=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_REFERER_PAIR:return _.extend({},t,{models:t.models.concat(n.refererPairs)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_REFERER_PAIRS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.ResearchInterestPercentiles=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_RESEARCH_INTEREST_PERCENTILE:return _.extend({},t,{models:t.models.concat(n.researchInterestPercentiles)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_RESEARCH_INTEREST_PERCENTILES_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){"use strict";var e={models:[],meta:{exhausted:!1,fetching:!1}};Aedu.Reducers.AnalyticsDashboard.Works=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.BATCH_ADD_WORK:return _.extend({},t,{models:t.models.concat(n.works)});case Aedu.ActionTypes.AnalyticsDashboard.UPDATE_WORKS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){"use strict";var e={models:[],meta:{cursor:null,exhausted:!1,fetching:!1}};Aedu.Reducers.ReadEvents=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.BATCH_ADD_READ_EVENT:return _.extend({},t,{models:t.models.concat(n.readEvents)});case Aedu.ActionTypes.UPDATE_READ_EVENT:var i=_.map(t.models,function(e){return e.id===n.readEvent.id?_.extend({},e,n.readEvent):e});return _.extend({},t,{models:i});case Aedu.ActionTypes.UPDATE_READ_EVENTS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){"use strict";window.Aedu=window.Aedu||{},window.Aedu.ReduxStore=Redux.createStore(Redux.combineReducers({ReadEvents:Aedu.Reducers.ReadEvents,AnalyticsDashboard:Redux.combineReducers({Countries:Aedu.Reducers.AnalyticsDashboard.Countries,Hits:Aedu.Reducers.AnalyticsDashboard.Hits,PreviousDateRangeHits:Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeHits,DisplayedDates:Aedu.Reducers.AnalyticsDashboard.DisplayedDates,Works:Aedu.Reducers.AnalyticsDashboard.Works,Docs:Aedu.Reducers.AnalyticsDashboard.Docs,Downloads:Aedu.Reducers.AnalyticsDashboard.Downloads,PreviousDateRangeDownloads:Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeDownloads,ReaderResearchInterests:Aedu.Reducers.AnalyticsDashboard.ReaderResearchInterests,RefererPairs:Aedu.Reducers.AnalyticsDashboard.RefererPairs,Percentiles:Aedu.Reducers.AnalyticsDashboard.Percentiles,ResearchInterestPercentiles:Aedu.Reducers.AnalyticsDashboard.ResearchInterestPercentiles})}),Redux.compose(Redux.applyMiddleware(ReduxThunk),window.devToolsExtension?window.devToolsExtension():_.identity))}(),function(){"use strict";var e=function(e,t){e=_.filter(e,function(e){return e.visitor&&e.visitor.country});var n=function(e){return e?e.toLowerCase():"Unknown"},i=_.uniq(_.flatten([_.map(e,function(e){return n(e.visitor.country.code)}),_.map(t,function(e){return n(e.country_code)})],!0)),o=_.map(i,function(e){return{countryCode:e,thirtyDayViews:0,cities:[],uniqueVisitors:{}}});return _.each(e,function(e){var t=e.visitor.city,i=_.findWhere(o,{countryCode:n(e.visitor.country.code)});if(t&&i){var r=_.findWhere(i.cities,{name:t});r||(r={name:t,thirtyDayViews:0,uniqueVisitors:{}},i.cities.push(r))}}),_.each(e,function(e){var t=_.findWhere(o,{countryCode:n(e.visitor.country.code)});if(t){t.thirtyDayViews+=1,t.uniqueVisitors[e.visitor.id]=!0;var i=e.visitor.city;if(i){var r=_.findWhere(t.cities,{name:i});r.thirtyDayViews+=1,r.uniqueVisitors[e.visitor.id]=!0}}}),_.each(t,function(e){var t=_.findWhere(o,{countryCode:n(e.country_code)});t.allTimeViews=parseInt(e.all_time_hit_count,10)}),_.each(o,function(e){e.uniqueVisitors=_.size(e.uniqueVisitors),_.each(e.cities,function(e){e.uniqueVisitors=_.size(e.uniqueVisitors)})}),o},t=function(e,t,n){function i(e,t){var n=_.findWhere(r,{workId:e,refererUrl:t});return n||(n={workId:e,refererUrl:t},r.push(n)),n}function o(e,t){var o=_.filter(e,function(e){return e.referer&&e.referer.url?"ExternalPage"==e.source.type||"ExternalSocial"==e.source.type:void 0});return _.each(o,function(e){var t=e.page.work_id||-1,n=e.referer.url,o=i(t,n);o.thirtyDayViews=o.thirtyDayViews?o.thirtyDayViews+1:1}),_.each(t,function(e,t){var n="Profile"==t?-1:parseInt(t);_.each(e,function(e,t){var o=i(n,t);
o.allTimeViews=e.all_time_views})}),_.each(r,function(e){if(-1===e.workId)e.targetPageTitle="Profile",e.targetPageUrl=Aedu.User.current.url;else{var t=_.find(n,function(t){return parseInt(t.id,10)==parseInt(e.workId,10)});e.targetPageTitle=t&&t.title,e.targetPageUrl=t&&t.internal_url}}),r}var r=[];return o(t,e)},n=function(e,t,n,i,o){var r=_.map(e,function(e){return _.clone(e)}),s={allTimeDownloads:void 0,allTimeViews:void 0,id:Aedu.WorkConstants.CV_WORK_ID,internal_url:$viewed_user.url+"/CurriculumVitae",title:"Curriculum Vitae"};r.push(s);var a=_.groupBy(i,"work_id"),c=_.groupBy(t,function(e){return e.page&&e.page.work_id}),u=_.groupBy(n,"work_id");return _.each(r,function(e){var t=a[e.id]||[],n=c[e.id]||[],i=u[e.id]||[],r=o[e.id];e.thirtyDayDownloads=t.length,e.thirtyDayViews=n.length,e.thirtyDayUniques=_.size(_.groupBy(n,function(e){return e.visitor.id})),e.countries=Aedu.ModelCreators.Countries(n,i),e.thirtyDayPercentile=r,e.allTimeDownloads=e.all_time_downloads,delete e.all_time_downloads,e.allTimeViews=e.all_time_views,delete e.all_time_views}),r};Aedu.ModelCreators={Countries:e,RefererPairs:t,Docs:n}}(),function(){"use strict";var e=function(e){var t=$.Deferred();return $.when(Aedu.Ajax.WorksService(),Aedu.Ajax.HitsService(e),Aedu.Ajax.AllTimeHitsByCountryService(),Aedu.Ajax.DownloadsService(e),Aedu.Ajax.PercentilesService()).done(function(e,n,i,o,r){t.resolve(Aedu.ModelCreators.Docs(e[0].works,n[0].hits,i[0].countries.by_work,o[0].downloads,r[0].percentiles))}).fail(t.reject),t};Aedu.ModelFetchers={Docs:e}}(),function(){var e,t,n,i,o,r,s;this.Components||(this.Components={}),(e=this.Components).Modals||(e.Modals={}),(t=this.Components).Basic||(t.Basic={}),(n=this.Components).Compound||(n.Compound={}),(i=this.Components).Buttons||(i.Buttons={}),(o=this.Components).Application||(o.Application={}),(r=this.Components.Application).Ads||(r.Ads={}),(s=this.Components.Application).User||(s.User={}),window.define=null}.call(this),ReactUtils={showModal:function(e,t){var n=_.uniqueId("js-bootstrap-modal-"),i=_.extend({},t,{modalId:n}),o=React.createElement(e,i),r=document.createElement("div"),s=$("body")[0],a=function(){s.removeChild(r)},c=React.createElement(Components.Modals.ModalBase,{modalId:n,modalView:o,onClose:a});s.appendChild(r),React.render(c,r)},prepareMoar:function(e){$(e).each(function(e,t){var n=React.createElement(Components.Application.Ads.Google,{width:$(t).data("width"),height:$(t).data("height"),slot:$(t).data("slot").toString()});ReactDOM.render(n,t)})}},this.Components.Utils=ReactUtils,this.Components.Application.Ads.Google=React.createClass({displayName:"Google",propTypes:{height:React.PropTypes.string,width:React.PropTypes.string,client:React.PropTypes.string.isRequired,slot:React.PropTypes.string.isRequired},getDefaultProps:function(){return{height:"100%",width:"100%",client:"ca-pub-5676204214023051"}},getKey:function(){return this.props.client+"-"+this.props.slot},render:function(){var e={display:"inline-block",height:this.props.height,width:this.props.width};return React.createElement("ins",{className:"adsbygoogle",key:this.getKey(),style:e,"data-ad-client":this.props.client,"data-ad-slot":this.props.slot})},loadScript:function(){if(!window.moarGoogleLoaded){var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";var t=document.getElementsByTagName("head")[0];t.appendChild(e),window.moarGoogleLoaded=!0}},componentDidMount:function(){this.loadScript(),(window.adsbygoogle=window.adsbygoogle||[]).push({})}}),function(){this.Components.Application.User.ProfilePreviewAffiliation=React.createClass({displayName:"ProfilePreviewAffiliation",propTypes:function(){return{profile:React.propTypes.object.isRequired}},render:function(){var e,t,n;return e=React.createElement(Components.Basic.Avatar,{profile:this.props.profile,className:"u-mr2x"}),t=this.props.profile.display_name,n=React.createElement("div",null," ",this.props.profile.university," "),React.createElement(Components.Compound.ImageHeaderSubtext,{image:e,header:t,subtext:n,url:this.props.profile.url,className:"u-m0x"})}})}.call(this),function(){this.Components.Application.User.ProfilePreviewLabel=React.createClass({displayName:"ProfilePreviewLabel",propTypes:function(){return{profile:React.propTypes.object.isRequired,label:React.propTypes.string.isRequired}},render:function(){var e;return e=React.createElement(Components.Basic.Avatar,{profile:this.props.profile,className:"u-mr2x"}),React.createElement(Components.Compound.ImageLabel,{image:e,label:this.props.label,url:this.props.profile.url,className:"u-m0x"})}})}.call(this),function(){this.Components.Application.User.ProfilePreviewTimestamp=React.createClass({displayName:"ProfilePreviewTimestamp",propTypes:function(){return{profile:React.propTypes.object.isRequired,timestamp:React.propTypes.number.isRequired}},render:function(){var e,t,n,i;return e=React.createElement(Components.Basic.Avatar,{profile:this.props.profile,className:"u-mr2x"}),t=this.props.profile.display_name,i=$h.timeAgoInWords(new Date(this.props.timestamp),{shortened:!0}),n=React.createElement("div",{className:"timestamp"},i," ago"),React.createElement(Components.Compound.ImageHeaderSubtext,{image:e,header:t,subtext:n,url:this.props.profile.url,className:"u-m0x"})}})}.call(this),function(){this.Components.Basic.Avatar=React.createClass({displayName:"Avatar",statics:{SIZE:{smallest:"Avatar--xxs",smaller:"Avatar--xs",small:"Avatar--sm",medium:"Avatar--md",large:"Avatar--lg",larger:"Avatar--xl"}},propTypes:function(){return{profile:React.propTypes.object.isRequired,size:React.propTypes.string}},getDefaultProps:function(){return{size:"Avatar--md"}},render:function(){var e;return e="Avatar "+this.props.size,React.createElement("img",{src:this.props.profile.photo,className:e})}})}.call(this),function(){this.Components.Basic.Spinner=React.createClass({displayName:"Spinner",statics:{SIZE:{smallest:"",smaller:"fa-lg",small:"fa-2x",medium:"fa-3x",large:"fa-4x",larger:"fa-5x"}},propTypes:function(){return{size:React.propTypes.string}},getDefaultProps:function(){return{size:""}},render:function(){var e;return e="fa fa-spinner fa-spin "+this.props.size,React.createElement("div",{className:e})}})}.call(this),function(){this.Components.Buttons.Cancel=React.createClass({displayName:"Cancel",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func,text:React.propTypes.string}},getDefaultProps:function(){return{text:"Cancel"}},render:function(){return React.createElement("button",{className:"Button Button--inverseGray",onClick:this.onClick},this.props.text)}})}.call(this),function(){this.Components.Buttons.Close=React.createClass({displayName:"Close",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func}},render:function(){return React.createElement("span",{className:"u-clickable u-fs20",onClick:this.onClick},"\xd7")}})}.call(this),function(){this.Components.Buttons.Confirm=React.createClass({displayName:"Confirm",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func,text:React.propTypes.string}},getDefaultProps:function(){return{text:"Confirm"}},render:function(){return React.createElement("button",{className:"Button Button--green",onClick:this.onClick},this.props.text)}})}.call(this),function(){this.Components.Buttons.Delete=React.createClass({displayName:"Delete",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func}},render:function(){return React.createElement("i",{className:"fa fa-times u-clickable u-displayInline",onClick:this.onClick})}})}.call(this),function(){this.Components.Buttons.Edit=React.createClass({displayName:"Edit",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func}},render:function(){return React.createElement("i",{className:"fa fa-pencil u-clickable u-displayInline",onClick:this.onClick})}})}.call(this),function(){this.Components.Compound.CheckboxLabel=React.createClass({displayName:"CheckboxLabel",propTypes:function(){return{label:React.propTypes.string.isRequired,labelClasses:React.propTypes.string.isRequired,onChange:React.propTypes.func,initChecked:React.propType.bool,disabled:React.propType.bool}},getDefaultProps:function(){return{initChecked:!1}},getInitialState:function(){return{checked:this.props.initChecked}},checkboxClicked:function(e){return this.props.disabled?void 0:(this.setState({checked:e.target.checked}),this.props.onChange?this.props.onChange(e.target.checked):void 0)},render:function(){var e;return e="clickable "+this.props.labelClasses,React.createElement("label",{className:e},React.createElement("input",{type:"checkbox",className:"Checkbox u-mr2x",onChange:this.checkboxClicked,checked:this.state.checked,disabled:this.props.disabled,ref:"checkbox"}),this.props.label)}})}.call(this),function(){this.Components.Compound.EditDelete=React.createClass({displayName:"EditDelete",propTypes:function(){return{onEdit:React.propTypes.func,onDelete:React.propTypes.func}},render:function(){return React.createElement("div",null,React.createElement(Components.Buttons.Delete,{handler:this.props.onDelete}),"\xa0",React.createElement(Components.Buttons.Edit,{handler:this.props.onEdit}))}})}.call(this),function(){this.Components.Compound.Facepile=React.createClass({displayName:"Facepile",propTypes:function(){return{profiles:React.propTypes.array.isRequired,maxProfiles:React.propTypes.number}},getDefaultProps:function(){return{maxProfiles:4}},render:function(){var e,t,n,i,o,r,s;for(r=Components.Basic.Avatar.SIZE.smallest,i=0,s=[],o=this.props.profiles,e=0,t=o.length;t>e;e++)if(n=o[e],s.push(React.createElement("span",{className:"u-mr1x"},React.createElement(Components.Basic.Avatar,{profile:n,key:"fp_"+n.id,size:r}))),++i>=this.props.maxProfiles){i!==this.props.profiles.length&&s.push(" ...");break}return React.createElement("span",null,s)}})}.call(this),function(){this.Components.Compound.ImageHeaderSubtext=React.createClass({displayName:"ImageHeaderSubtext",propTypes:function(){return{image:React.propTypes.element.isRequired,header:React.propTypes.string,subtext:React.propTypes.string,url:React.propTypes.string}},getDefaultProps:function(){return{header:"Hello, world!",subtext:"Hello, world!"}},render:function(){var e,t;return e=null,t=null,this.props.url?(e=React.createElement("a",{href:this.props.url,className:"h4 Media-heading"}," ",this.props.header," "),t=React.createElement("a",{href:this.props.url,className:"pull-left"}," ",this.props.image," ")):(e=React.createElement("span",{className:"h4 media-heading"}," ",this.props.header," "),t=this.props.image),React.createElement("div",{className:"Media"},React.createElement("div",{className:"Media--left Media--middle"},t),React.createElement("div",{className:"Media-body Media--middle u-taLeft"},e,React.createElement("span",{className:"u-tcGray"}," ",this.props.subtext)))}})}.call(this),function(){this.Components.Compound.ImageLabel=React.createClass({displayName:"ImageLabel",propTypes:function(){return{image:React.propTypes.element.isRequired,label:React.propTypes.string,url:React.propTypes.string}},getDefaultProps:function(){return{label:"Hello, world! Test."}},render:function(){var e;return e=null,e=this.props.url?React.createElement("a",{href:this.props.url,className:"pull-left"}," ",this.props.image," "):this.props.image,React.createElement("div",{className:"Media"},React.createElement("div",{className:"Media--left Media--middle"},e),React.createElement("div",{className:"Media-body Media--middle u-taLeft"},this.props.label))}})}.call(this),function(){this.Components.Compound.TextInputWithConfirm=React.createClass({displayName:"TextInputWithConfirm",propTypes:function(){return{initialText:React.propTypes.string.isRequired,onCancel:React.propTypes.func,onConfirm:React.propTypes.func}},getInitialState:function(){return{text:this.props.initialText}},cancelHandler:function(){return this.props.onCancel?this.props.onCancel(this.state.text):void 0},confirmHandler:function(){return this.props.onConfirm?this.props.onConfirm(this.state.text):void 0},valueChange:function(e){return this.setState({text:e.target.value})},render:function(){return React.createElement("div",{className:"clearfix"},React.createElement("textarea",{className:"TextArea",defaultValue:this.props.initialText,value:this.state.text,onChange:this.valueChange}),React.createElement("br",null),React.createElement("div",{className:"u-floatRight"},React.createElement(Components.Buttons.Cancel,{handler:this.cancelHandler}),"\xa0",React.createElement(Components.Buttons.Confirm,{handler:this.confirmHandler})))}})}.call(this),function(){this.Components.Modals.BodyClose=React.createClass({displayName:"BodyClose",propTypes:function(){},getDefaultProps:function(){},render:function(){return React.createElement("div",null,React.createElement("div",{className:"u-p2x"},this.closeButton()),this.props.children)},closeButton:function(){return React.createElement("button",{className:"close","aria-label":"Close","data-dismiss":"modal",type:"button"},React.createElement("span",{className:"u-clickable u-fs24"},"\xd7"))}})}.call(this),function(){this.Components.Modals.BodyOnly=React.createClass({displayName:"BodyOnly",render:function(){return React.createElement("div",null,React.createElement("div",{className:"modal-body u-p0x"},this.props.children))}})}.call(this),function(){this.Components.Modals.ConfirmOrCancel=React.createClass({displayName:"ConfirmOrCancel",propTypes:function(){return{message:React.propTypes.element,onConfirm:React.propTypes.func.isRequired,onCancel:React.propTypes.func}},getDefaultProps:function(){return{message:React.createElement("label",null," Are you sure? ")}},render:function(){return React.createElement(Components.Modals.HeaderBodyClose,{header:this.props.message})},buttons:function(){return React.createElement("div",{className:"clearfix"},React.createElement("div",{className:"u-floatRight"},React.createElement(Components.Buttons.Cancel,{handler:this.props.onCancel}),"\xa0",React.createElement(Components.Buttons.Confirm,{handler:this.props.onConfirm})))}})}.call(this),function(){this.Components.Modals.HeaderBodyClose=React.createClass({displayName:"HeaderBodyClose",propTypes:function(){return{header:React.propTypes.element,body:React.propTypes.element}},getDefaultProps:function(){return{header:React.createElement("label",null," Header "),body:React.createElement("label",null," Body ")}},render:function(){return React.createElement("div",null,React.createElement("div",{className:"modal-header u-border0"},React.createElement("button",{className:"close","aria-label":"Close","data-dismiss":"modal",type:"button"},React.createElement(Components.Buttons.Close,{"aria-hidden":"true"})),this.props.header),React.createElement("div",{className:"modal-body u-p0x"},this.props.body))}})}.call(this),function(){this.Components.Modals.ModalBase=React.createClass({displayName:"ModalBase",propTypes:function(){return{modalView:React.propTypes.element.isRequired,onClose:React.propTypes.func,modalId:React.propType.number}},componentDidMount:function(){var e;return e=$("#"+this.props.modalId),e.modal("show"),e.on("hidden.bs.modal",this.props.onClose)},close:function(){return $("#"+this.props.modalId).modal("hide")},render:function(){return React.createElement("div",{className:"ds-Modal modal",id:this.props.modalId,tabIndex:"-1"},React.createElement("div",{className:"modal-dialog"},React.createElement("div",{className:"modal-content"},this.props.modalView)))}})}.call(this),function(){var e;(e=this.Flux).Certifications||(e.Certifications={})}.call(this),function(){var e,t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;e=function(e){function n(){n.__super__.constructor.call(this),this.dispatcherCallback("certifier-nominate",this.onCertifierNominate),this.dispatcherCallback("certifier-remove-nomination",this.onCertifierRemoveNomination),this.dispatcherCallback("certifier-nominations-confirm",this.onCertifierNominationsConfirm)}return t(n,e),n.MAX_NOMINATIONS=3,n.prototype.nominations=function(){return this.nominationsList},n.prototype.totalNominations=function(){return this.preexistingNominations?n.MAX_NOMINATIONS-this.preexistingNominations.length:n.MAX_NOMINATIONS},n.prototype.nominationsLeft=function(){var e;return e=0,this.nominationsList&&this.preexistingNominations&&(e=this.nominationsList.length+this.preexistingNominations.length),n.MAX_NOMINATIONS-e},n.prototype.madeNominations=function(){return this.nominationsList.length>0},n.prototype.takenNominations=function(){return this.nominationsList},n.prototype.onCertifierNominate=function(e){return this.nominationsLeft()>0?(this.nominationsList.push(e.nominatedProfile),this.emitChange()):void 0},n.prototype.onCertifierRemoveNomination=function(e){return this.removeNomination(e.removedProfile),this.emitChange()},n.prototype.onCertifierNominationsConfirm=function(){return this.madeNominations()?this.createNominationsAndRedirect():this.nextPage()},n.prototype.hasData=function(){return null!=this.nominationsList},n.prototype.loadData=function(){var e,t,n;return n=$r.api_v0_certifications_certifier_nominations_path({subdomain_param:"api",nominator_id:Aedu.User.current.id}),t=function(e){return function(t){return e.nominationsList=[],e.preexistingNominations=t.certifier_nominations,e.emitChange()}}(this),e=function(){return function(){return alert("Something went wrong. Please try again in a few moments.")}}(this),this.readFromUrl(n,t,e)},n.prototype.removeNomination=function(e){return this.nominationsList=_.reject(this.nominationsList,function(t){return t.id===e.id})},n.prototype.createNominationsAndRedirect=function(){var e,t,n,i,o;return n=_.map(this.nominationsList,function(e){return e.id}),o=$r.api_v0_certifications_certifier_nominations_path,e={subdomain_param:"api",nominee_ids:n,nominator_id:Aedu.User.current.id},i=function(e){return function(){return e.nextPage()}}(this),t=function(){return function(){return alert("Could not connect to server to complete nomination process. Please try again.")}}(this),this.createAtUrl(o,e,i,t)},n.prototype.nextPage=function(){return document.location="/recommendations/suggestions"},n}(Flux.Store),Flux.Certifications.CertifierNominationsStore=new e}.call(this),function(){var e,t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;e=function(e){function n(){n.__super__.constructor.call(this),this.dispatcherCallback("certification-create",this.onCertify)}return t(n,e),n.prototype.hasData=function(){return!1},n.prototype.loadData=function(){},n.prototype.onCertify=function(e){var t,n,i,o;return t={work_id:e.workId,url:e.url,comment:e.commentBody,details:e.details,source:e.source},o=$r.api_v0_certifications_certifications_path,i=function(e){return function(n){return e.notifyCertificationCreated(n),e.emitChange({request:t,success:!0})}}(this),n=function(e){return function(n){var i,o;$a.admin_log("Error creating certification",n),o=null;try{o=JSON.parse(n.responseText).errors||[]}catch(r){i=r,o=[]}return e.emitChange({request:t,success:!1,errors:o})}}(this),this.createAtUrl(o,t,i,n)},n.prototype.notifyCertificationCreated=function(e){return"Work"===e.certifiee_type?Flux.Dispatcher.dispatch({actionType:"work-certification-create",certification:e}):void 0},n}(Flux.Store),Flux.Certifications.NewCertificationStore=new e}.call(this),function(){var e,t=function(e,t){function i(){this.constructor=e}for(var o in t)n.call(t,o)&&(e[o]=t[o]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;e=function(e){function n(){n.__super__.constructor.call(this),this.dataByWorkId={},this.dispatcherCallback("work-certification-edit-comment",this.onCommentEdit),this.dispatcherCallback("work-certification-delete",this.onCertificationDelete),this.dispatcherCallback("work-certification-create",this.onWorkCertified)}return t(n,e),n.prototype.certifications=function(e){return this.dataByWorkId[e]},n.prototype.certifiers=function(e){return _.map(this.certifications(e),function(e){return e.user})},n.prototype.isCertifiedByCurrentUser=function(e){return _.find(this.dataByWorkId[e],function(e){return e.user.id===Aedu.User.current.id})},n.prototype.currentUserAlreadyCertified=function(e){return this.isCertifiedByCurrentUser(e)},n.prototype.onCommentEdit=function(e){var t,n;return t=this.certificationInfo(e.workId,e.certificationId),t.comment||(t.comment={}),n=t.comment.body,t.comment.body=e.commentText,this.emitChange(),this.requestCommentUpdate(e.workId,e.certificationId,e.commentText,n)},n.prototype.onCertificationDelete=function(e){var t;return t=this.certificationInfo(e.workId,e.certificationId),this.removeCertificationById(e.workId,e.certificationId),this.emitChange(),this.requestCertificationDelete(e.workId,e.certificationId,t)},n.prototype.onWorkCertified=function(e){var t,n,i;return n=e.certification,n.user=Aedu.User.current,i=n.certifiee.id,(t=this.dataByWorkId)[i]||(t[i]=[]),this.dataByWorkId[i].push(n),this.emitChange()},n.prototype.loadData=function(e){var t;return t=$r.api_v0_certifications_work_certifications_path({subdomain_param:"api",id:e}),this.readFromUrl(t,this.workFetchSuccess(e),this.workFetchError(e))},n.prototype.hasData=function(e){return null!=this.dataByWorkId[e]},n.prototype.certificationById=function(e,t){return _.find(e,function(e){return e.id===t})},n.prototype.removeCertificationById=function(e,t){var n;return n=_.reject(this.dataByWorkId[e],function(e){return e.id===t}),this.dataByWorkId[e]=n},n.prototype.certificationInfo=function(e,t){return this.certificationById(this.dataByWorkId[e],t)},n.prototype.workFetchSuccess=function(e){var t;return t=function(t){return function(n){return t.dataByWorkId[e]=t.processFetchedData(n),t.emitChange()}}(this)},n.prototype.processFetchedData=function(e){var t,n,i,o;for(o=e.work_certifications,n=0,i=o.length;i>n;n++)t=o[n],t.comment||(t.comment={body:""});return o},n.prototype.workFetchError=function(){var e;return e=function(e){return $a.admin_log("Error fetching certifications",e)}},n.prototype.requestCommentUpdate=function(e,t,n,i){var o,r,s,a;return o={comment:n,id:t},a=$r.api_v0_certifications_certification_path({id:t,subdomain_param:"api"}),s=function(){},r=function(n){return function(){var o;return alert("Comment edit failed. Please try again."),o=n.certificationInfo(e,t),o.comment.body=i,n.emitChange()}}(this),this.updateAtUrl(a,o,s,r)},n.prototype.requestCertificationDelete=function(e,t,n){var i,o,r;return r=$r.api_v0_certifications_certification_path({id:t,subdomain_param:"api"}),o=function(){},i=function(t){return function(){return alert("Could not retract recommendation. Please try again."),t.dataByWorkId[e].push(n),t.emitChange()}}(this),this.deleteAtUrl(r,o,i)},n}(Flux.Store),Flux.Certifications.WorkCertificationsStore=new e}.call(this),function(e){if("undefined"!=typeof module&&module.exports)module.exports=e(this);else if("function"==typeof define&&define.amd){var t=this;define("i18n",function(){return e(t)})}else this.I18n=e(this)}(function(e){"use strict";var t=e&&e.I18n||{},n=Array.prototype.slice,i=function(e){return("0"+e.toString()).substr(-2)},o={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},r={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},s={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},a={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},c=[null,"kb","mb","gb","tb"],u={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};return t.reset=function(){this.defaultLocale=u.defaultLocale,this.locale=u.locale,this.defaultSeparator=u.defaultSeparator,this.placeholder=u.placeholder,this.fallbacks=u.fallbacks,this.translations=u.translations,this.missingBehaviour=u.missingBehaviour,this.missingTranslationPrefix=u.missingTranslationPrefix},t.initializeOptions=function(){"undefined"==typeof this.defaultLocale&&null!==this.defaultLocale&&(this.defaultLocale=u.defaultLocale),"undefined"==typeof this.locale&&null!==this.locale&&(this.locale=u.locale),"undefined"==typeof this.defaultSeparator&&null!==this.defaultSeparator&&(this.defaultSeparator=u.defaultSeparator),"undefined"==typeof this.placeholder&&null!==this.placeholder&&(this.placeholder=u.placeholder),"undefined"==typeof this.fallbacks&&null!==this.fallbacks&&(this.fallbacks=u.fallbacks),"undefined"==typeof this.translations&&null!==this.translations&&(this.translations=u.translations)},t.initializeOptions(),t.locales={},t.locales.get=function(e){var n=this[e]||this[t.locale]||this["default"];return"function"==typeof n&&(n=n(e)),n instanceof Array==!1&&(n=[n]),n},t.locales["default"]=function(e){var n,i=[],o=[];return e&&i.push(e),!e&&t.locale&&i.push(t.locale),t.fallbacks&&t.defaultLocale&&i.push(t.defaultLocale),i.forEach(function(e){n=e.split("-")[0],~o.indexOf(e)||o.push(e),t.fallbacks&&n&&n!==e&&!~o.indexOf(n)&&o.push(n)}),i.length||i.push("en"),o},t.pluralization={},t.pluralization.get=function(e){return this[e]||this[t.locale]||this["default"]},t.pluralization["default"]=function(e){switch(e){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},t.currentLocale=function(){return this.locale||this.defaultLocale},t.isSet=function(e){return void 0!==e&&null!==e},t.lookup=function(e,t){t=this.prepareOptions(t);{var n,i,o,r=this.locales.get(t.locale).slice();r[0]}for(e=this.getFullScope(e,t);r.length;)if(n=r.shift(),i=e.split(this.defaultSeparator),o=this.translations[n]){for(;i.length&&(o=o[i.shift()],void 0!==o&&null!==o););if(void 0!==o&&null!==o)return o}return this.isSet(t.defaultValue)?t.defaultValue:void 0},t.meridian=function(){var e=this.lookup("time"),t=this.lookup("date");return e&&e.am&&e.pm?[e.am,e.pm]:t&&t.meridian?t.meridian:o.meridian},t.prepareOptions=function(){for(var e,t=n.call(arguments),i={};t.length;)if(e=t.shift(),"object"==typeof e)for(var o in e)e.hasOwnProperty(o)&&(this.isSet(i[o])||(i[o]=e[o]));return i},t.createTranslationOptions=function(e,t){var n=[{scope:e}];return this.isSet(t.defaults)&&(n=n.concat(t.defaults)),this.isSet(t.defaultValue)&&(n.push({message:t.defaultValue}),delete t.defaultValue),n},t.translate=function(e,t){t=this.prepareOptions(t);var n,i=this.createTranslationOptions(e,t),o=i.some(function(e){return this.isSet(e.scope)?n=this.lookup(e.scope,t):this.isSet(e.message)&&(n=e.message),void 0!==n&&null!==n?!0:void 0},this);return o?("string"==typeof n?n=this.interpolate(n,t):n instanceof Object&&this.isSet(t.count)&&(n=this.pluralize(t.count,n,t)),n):this.missingTranslation(e,t)},t.interpolate=function(e,t){t=this.prepareOptions(t);var n,i,o,r,s=e.match(this.placeholder);if(!s)return e;for(var i;s.length;)n=s.shift(),o=n.replace(this.placeholder,"$1"),i=this.isSet(t[o])?t[o].toString().replace(/\$/gm,"_#$#_"):o in t?this.nullPlaceholder(n,e):this.missingPlaceholder(n,e),r=new RegExp(n.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),e=e.replace(r,i);return e.replace(/_#\$#_/g,"$")},t.pluralize=function(e,t,n){n=this.prepareOptions(n);var i,o,r,s,a;if(i=t instanceof Object?t:this.lookup(t,n),!i)return this.missingTranslation(t,n);for(o=this.pluralization.get(n.locale),r=o(e);r.length;)if(s=r.shift(),this.isSet(i[s])){a=i[s];break}return n.count=String(e),this.interpolate(a,n)},t.missingTranslation=function(e,t){if("guess"==this.missingBehaviour){var n=e.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+n.replace("_"," ").replace(/([a-z])([A-Z])/g,function(e,t,n){return t+" "+n.toLowerCase()})}var i=this.getFullScope(e,t),o=[this.currentLocale(),i].join(this.defaultSeparator);return'[missing "'+o+'" translation]'},t.missingPlaceholder=function(e){return"[missing "+e+" value]"},t.nullPlaceholder=function(){return t.missingPlaceholder.apply(t,arguments)},t.toNumber=function(e,t){t=this.prepareOptions(t,this.lookup("number.format"),r);var n,i,o=0>e,s=Math.abs(e).toFixed(t.precision).toString(),a=s.split("."),c=[],u=t.format||"%n",l=o?"-":"";for(e=a[0],n=a[1];e.length>0;)c.unshift(e.substr(Math.max(0,e.length-3),3)),e=e.substr(0,e.length-3);return i=c.join(t.delimiter),t.strip_insignificant_zeros&&n&&(n=n.replace(/0+$/,"")),t.precision>0&&n&&(i+=t.separator+n),u=t.sign_first?"%s"+u:u.replace("%n","%s%n"),i=u.replace("%u",t.unit).replace("%n",i).replace("%s",l)},t.toCurrency=function(e,t){return t=this.prepareOptions(t,this.lookup("number.currency.format"),this.lookup("number.format"),s),this.toNumber(e,t)},t.localize=function(e,t,n){switch(n||(n={}),e){case"currency":return this.toCurrency(t);case"number":return e=this.lookup("number.format"),this.toNumber(t,e);case"percentage":return this.toPercentage(t);default:var i;return i=e.match(/^(date|time)/)?this.toTime(e,t):t.toString(),this.interpolate(i,n)}},t.parseDate=function(e){var t,n,i;if("object"==typeof e)return e;if(t=e.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var o=1;6>=o;o++)t[o]=parseInt(t[o],10)||0;t[2]-=1,i=t[7]?1e3*("0"+t[7]):null,n=t[8]?new Date(Date.UTC(t[1],t[2],t[3],t[4],t[5],t[6],i)):new Date(t[1],t[2],t[3],t[4],t[5],t[6],i)}else"number"==typeof e?(n=new Date,n.setTime(e)):e.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(n=new Date,n.setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" ")))):e.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/)?(n=new Date,n.setTime(Date.parse(e))):(n=new Date,n.setTime(Date.parse(e)));return n},t.strftime=function(e,n){var r=this.lookup("date"),s=t.meridian();r||(r={}),r=this.prepareOptions(r,o);var a=e.getDay(),c=e.getDate(),u=e.getFullYear(),l=e.getMonth()+1,d=e.getHours(),p=d,h=d>11?1:0,_=e.getSeconds(),f=e.getMinutes(),m=e.getTimezoneOffset(),g=Math.floor(Math.abs(m/60)),v=Math.abs(m)-60*g,y=(m>0?"-":"+")+(g.toString().length<2?"0"+g:g)+(v.toString().length<2?"0"+v:v);return p>12?p-=12:0===p&&(p=12),n=n.replace("%a",r.abbr_day_names[a]),n=n.replace("%A",r.day_names[a]),n=n.replace("%b",r.abbr_month_names[l]),n=n.replace("%B",r.month_names[l]),n=n.replace("%d",i(c)),n=n.replace("%e",c),n=n.replace("%-d",c),n=n.replace("%H",i(d)),n=n.replace("%-H",d),n=n.replace("%I",i(p)),n=n.replace("%-I",p),n=n.replace("%m",i(l)),n=n.replace("%-m",l),n=n.replace("%M",i(f)),n=n.replace("%-M",f),n=n.replace("%p",s[h]),n=n.replace("%S",i(_)),n=n.replace("%-S",_),n=n.replace("%w",a),n=n.replace("%y",i(u)),n=n.replace("%-y",i(u).replace(/^0+/,"")),n=n.replace("%Y",u),n=n.replace("%z",y)},t.toTime=function(e,t){var n=this.parseDate(t),i=this.lookup(e);return n.toString().match(/invalid/i)?n.toString():i?this.strftime(n,i):n.toString()},t.toPercentage=function(e,t){return t=this.prepareOptions(t,this.lookup("number.percentage.format"),this.lookup("number.format"),a),this.toNumber(e,t)},t.toHumanSize=function(e,t){for(var n,i,o=1024,r=e,s=0;r>=o&&4>s;)r/=o,s+=1;return 0===s?(n=this.t("number.human.storage_units.units.byte",{count:r}),i=0):(n=this.t("number.human.storage_units.units."+c[s]),i=r-Math.floor(r)===0?0:1),t=this.prepareOptions(t,{unit:n,precision:i,format:"%n%u",delimiter:""}),this.toNumber(r,t)},t.getFullScope=function(e,t){return t=this.prepareOptions(t),e.constructor===Array&&(e=e.join(this.defaultSeparator)),t.scope&&(e=[t.scope,e].join(this.defaultSeparator)),e},t.t=t.translate,t.l=t.localize,t.p=t.pluralize,t}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var i=0;if(arguments.length>1&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&1/0!=i&&i!=-1/0&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=n)return-1;for(var o=i>=0?i:Math.max(n-Math.abs(i),0);n>o;o++)if(o in t&&t[o]===e)return o;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;
if(null==this)throw new TypeError("this is null or not defined");var o=Object(this),r=o.length>>>0;if("[object Function]"!=={}.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(n=t),i=0;r>i;){var s;Object.prototype.hasOwnProperty.call(o,i)&&(s=o[i],e.call(n,s,i,o)),i++}}),Array.prototype.some||(Array.prototype.some=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=arguments.length>=2?arguments[1]:void 0,o=0;n>o;o++)if(o in t&&e.call(i,t[o],o,t))return!0;return!1}),function(e){"undefined"!=typeof module&&module.exports?e(require("i18n")):"function"==typeof define&&define.amd?define(["i18n"],e):e(this.I18n)}(function(e){"use strict";e.translations={en:{aca:{marketing_claim:{html:"A study recently published in <i>PLOS ONE</i> found that papers uploaded to Academia.edu receive a 69% boost in citations over 5 years.",text:"A study recently published in PLOS ONE found that papers uploaded to Academia.edu receive a 69% boost in citations over 5 years."},marketing_claim_with_link:{html:'A <a class="%{link_classes}" href="http://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu">study</a> recently published in <i>PLOS ONE</i> found that papers uploaded to Academia receive a 69% boost in citations over 5 years.'},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},activerecord:{errors:{messages:{record_invalid:"Validation failed: %{errors}",restrict_dependent_destroy:{many:"Cannot delete record because dependent %{record} exist",one:"Cannot delete record because a dependent %{record} exists"}}}},added_by:"Added by",affiliation_editor:{company_or_institution_is_required:"Company or Institution is required",department_required:"Department is required",templates:{affiliation_edit:{adjunct:"Adjunct",alumnus_alumna:"Alumnus/Alumna",cancel:"CANCEL",company_or_institution:"Company or Institution",department:"Department",emeritus_emerita:"Emeritus/Emerita",faculty_member:"Faculty Member",female:"Female",gender:"Gender",graduate_student:"Graduate Student",male:"Male",no:"No",other:"Other",position:"Position",post_doctorate:"Post Doctorate",primary_affiliation:"Primary Affiliation",save:"SAVE",undergraduate:"Undergraduate",university:"University",yes:"Yes"}},university_is_required:"University is required"},date:{abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],formats:{"default":"%Y-%m-%d","long":"%B %d, %Y","short":"%b %d"},month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],order:["year","month","day"]},datetime:{distance_in_words:{about_x_hours:{one:"about 1 hour",other:"about %{count} hours"},about_x_months:{one:"about 1 month",other:"about %{count} months"},about_x_years:{one:"about 1 year",other:"about %{count} years"},almost_x_years:{one:"almost 1 year",other:"almost %{count} years"},half_a_minute:"half a minute",less_than_x_minutes:{one:"less than a minute",other:"less than %{count} minutes"},less_than_x_seconds:{one:"less than 1 second",other:"less than %{count} seconds"},over_x_years:{one:"over 1 year",other:"over %{count} years"},x_days:{one:"1 day",other:"%{count} days"},x_minutes:{one:"1 minute",other:"%{count} minutes"},x_months:{one:"1 month",other:"%{count} months"},x_seconds:{one:"1 second",other:"%{count} seconds"}},prompts:{day:"Day",hour:"Hour",minute:"Minute",month:"Month",second:"Seconds",year:"Year"}},department_search:{create_new:"Or create a new department..."},errors:{format:"%{attribute} %{message}",messages:{accepted:"must be accepted",blank:"can't be blank",confirmation:"doesn't match %{attribute}",empty:"can't be empty",equal_to:"must be equal to %{count}",even:"must be even",exclusion:"is reserved",greater_than:"must be greater than %{count}",greater_than_or_equal_to:"must be greater than or equal to %{count}",in_between:"must be in between %{min} and %{max}",inclusion:"is not included in the list",invalid:"is invalid",less_than:"must be less than %{count}",less_than_or_equal_to:"must be less than or equal to %{count}",not_a_number:"is not a number",not_an_integer:"must be an integer",odd:"must be odd",other_than:"must be other than %{count}",present:"must be blank",taken:"has already been taken",too_long:{one:"is too long (maximum is 1 character)",other:"is too long (maximum is %{count} characters)"},too_short:{one:"is too short (minimum is 1 character)",other:"is too short (minimum is %{count} characters)"},wrong_length:{one:"is the wrong length (should be 1 character)",other:"is the wrong length (should be %{count} characters)"}}},helpers:{page_entries_info:{more_pages:{display_entries:"Displaying %{entry_name} <b>%{first}&nbsp;-&nbsp;%{last}</b> of <b>%{total}</b> in total"},one_page:{display_entries:{one:"Displaying <b>1</b> %{entry_name}",other:"Displaying <b>all %{count}</b> %{entry_name}",zero:"No %{entry_name} found"}}},select:{prompt:"Please select"},submit:{create:"Create %{model}",submit:"Save %{model}",update:"Update %{model}"}},mailers:{coauthors:{approve_tag:"Approve Tag",ignore_tag:"Ignore",invite_external_coauthor:{approve_tag_text:"To approve this tag, please visit the link below:",click_here:"click here",if_you_dont_know:"if you don't know %{tagger_name}.",ignore_tag_text:"To ignore this invitation, visit this link:",please:"Please",tagged_you_days_ago_html:"<b>%{tagger_link}</b> tagged you as a co-author %{days_ago} days ago.",tagged_you_days_ago_text:"%{tagger_name} tagged you as a co-author %{days_ago} days ago on:",tagged_you_html:"<b>%{tagger_link}</b> tagged you as a co-author on a paper.",tagged_you_text:"%{tagger_name} tagged you as a co-author on:"},name_pending_subject:"%{tagger_name}'s co-author tag is pending your approval",view_paper:"View Paper",waiting_confirmation_subject:"%{tagger_name}'s co-author tag is waiting for your confirmation"},external_mailer:{related_papers_nag:{downloaded_paper_body:"Here is a paper you downloaded on Academia.edu on %{download_date}.",from:"%{recipient} at Academia",salutation:"Hi %{recipient},",subject:"My download",view_paper_button:"VIEW PAPER"}}},number:{currency:{format:{delimiter:",",format:"%u%n",precision:2,separator:".",significant:!1,strip_insignificant_zeros:!1,unit:"$"}},format:{delimiter:",",precision:3,separator:".",significant:!1,strip_insignificant_zeros:!1},human:{decimal_units:{format:"%n %u",units:{billion:"Billion",million:"Million",quadrillion:"Quadrillion",thousand:"Thousand",trillion:"Trillion",unit:""}},format:{delimiter:"",precision:3,significant:!0,strip_insignificant_zeros:!0},storage_units:{format:"%n %u",units:{"byte":{one:"Byte",other:"Bytes"},gb:"GB",kb:"KB",mb:"MB",tb:"TB"}}},percentage:{format:{delimiter:"",format:"%n%"}},precision:{format:{delimiter:""}}},reg_path:{coauthor:{added_you:"%{tagger_name} added you as a co-author:",already_have_account:"Already have an Academia.edu account?",approve_and_join:"Approve Tag & Join",by_joining_you_agree_html:"By joining %{tagger_name} on Academia.edu, you agree to our",looking_for_papers:"Looking for more papers you authored",sign_in_to_approve:"Sign in to approve",terms_of_use:"Terms of Use",you_accepted:"You've accepted %{@invitingCoauthor}'s request! Please take a moment to confirm your other papers.",you_accepted_no_name:"You've accepted your co-author's request! Please take a moment to confirm your other papers."},combined_claim:{opt_in_checkbox:{label_text:"Include co-authors not yet on Academia",popover_info_text:"Including co-authors allows you to invite them to Academia."}},name_only_coauthors:{coauthor_email_input:{placeholder:"Enter an email address"},coauthor_info:{email_confirmed:"Email confirmed",no_email:"No email found"},control_bar:{add_emails_for_remaining:{one:"Add an email for the remaining 1 Co-Author",other:"Add emails for the remaining {{count}} Co-Authors"}},header:{google_alert_message:{autofilled_x_coauthors:{one:"1 co-author email found!",other:"{{count}} co-author emails found!"},clicked:"Authenticating with Google...",connected:"Connected. Autofilling emails...","default":"We were unable to confirm the contact details of some of your co-authors",unable_to_autofill:"We were unable to autofill any emails; please enter in emails for your co-authors to allow them to access your works on Academia."},google_connect_button_text:"AUTOFILL FROM CONTACTS",subtitle:"Allow your co-authors to access your works on Academia"}},templates:{coauthor_review_page:{confirm_your_co_authors:"Confirm Your Co-Authors",none_of_these_are:"None of these are correct"},combined_claim_control_bar:{numcoauthors_co_authors:"%{numCoauthors} Co-Authors",select_all:"Select All"},combined_claim_footer:{confirm_allclaimed:"Confirm All",confirm_selectedclaimed:"Confirm Selected",skip:"Skip"},combined_claim_page:{next_page_title:"Thanks! We Were Able To Find %{numCoauthors} Additional Co-Authors",subtitle:"We found papers you wrote with %{numCoauthors} more co-authors. If you both confirm co-authorship, your co-authored papers will appear on both profiles.",title:"Confirm Your Other Co-Authors and Papers"},discover_research_follow_interest:{followers:"Followers"},discover_research_follow_user:{independent_researcher:"Independent Researcher"},discover_research_page:{back:"  BACK",discover_more_research:"Discover More Research",find_colleagues_friends:"FIND COLLEAGUES & FRIENDS",follow:{one:"FOLLOW (1)",other:"FOLLOW ({{count}})",zero:"FOLLOW (0)"},follow_researchers_and_interests:"Follow researchers and interests to find the latest papers in your field.",researchers_interests:"RESEARCHERS & INTERESTS",skip:"SKIP"},discover_research_suggestions_none:{sorry_we_couldn_t:"Sorry, we couldn't find any suggestions for you.",try_connecting_another_account:"Try connecting another account to help us find your friends, colleagues, and research interests on Academia.edu."},suggested_coauthor:{papers:{one:"1 paper",other:"{{count}} papers"}},suggested_coauthor_with_works:{show_more_papers:"Show More Papers",wrote_papers:{one:"%{name} wrote 1 paper with you",other:"%{name} wrote {{count}} papers with you"}},verify_account:{enter_password:"Enter a password",google_button:"CONNECT WITH GOOGLE",hr_heading_text:"or enter a password",retype_password:"Retype your password",subtitle:"Connect with Google or enter a password to verify your account.",verify_account:"VERIFY ACCOUNT",verify_your_account:"Verify Your Account",yahoo_button:"CONNECT WITH YAHOO",yahoo_subtitle:"Connect with Yahoo or enter a password to verify your account."}}},registration_path:{current_position_grid:{adjunct:"Adjunct",alumn:"Alumn",emerita_or_emeritus:"Emerita or Emeritus",graduate_student:"Graduate Student",i_m_not_a:"I'm Not a Researcher",independent_researcher:"Independent Researcher",other:"Other",post_doc:"Post-Doc",private_sector:"Private Sector",professor:"Professor",undergraduate:"Undergraduate",what_best_describes_your:"What best describes your current position?"}},support:{array:{last_word_connector:", and ",two_words_connector:" and ",words_connector:", "}},time:{am:"am",formats:{"default":"%a, %d %b %Y %H:%M:%S %z","long":"%B %d, %Y %H:%M","short":"%d %b %H:%M"},pm:"pm"},uploaded_by:"Uploaded by",views:{pagination:{first:"&laquo; First",last:"Last &raquo;",next:"Next &rsaquo;",previous:"&lsaquo; Prev",truncate:"&hellip;"}}},es:{added_by:"A\xf1adido por",affiliation_editor:{company_or_institution_is_required:"Empresa o instituci\xf3n obligatoria",department_required:"Departamento obligatorio",templates:{affiliation_edit:{adjunct:"Adjunto",alumnus_alumna:"Alumno",cancel:"CANCELAR",company_or_institution:"Empresa o instituci\xf3n",department:"Departamento",emeritus_emerita:"Em\xe9rito",faculty_member:"Miembro de la facultad",female:"Mujer",gender:"Sexo",graduate_student:"Estudiante graduado",male:"Hombre",no:"No",other:"Otros",position:"Puesto",post_doctorate:"Postdoctorado",primary_affiliation:"Afiliaci\xf3n principal",save:"GUARDAR",undergraduate:"Estudiante de grado",university:"Universidad",yes:"S\xed"}},university_is_required:"Universidad obligatoria"},department_search:{create_new:"O crea un nuevo departamento..."},mailers:{coauthors:{approve_tag:"Aceptar etiqueta",ignore_tag:"Caso omiso",invite_external_coauthor:{approve_tag_text:"Para aceptar esta etiqueta, vaya al siguiente enlace.",click_here:"haz clic aqu\xed",if_you_dont_know:"si no conoces el %{tagger_name}.",ignore_tag_text:"Para hacer caso omiso de esta invitaci\xf3n, visita este enlace:",please:"Por favor",tagged_you_days_ago_html:"<b>%{tagger_link}</b> te ha marcado como coautor hace %{days_ago} d\xedas.",tagged_you_days_ago_text:"%{tagger_name} te ha marcado como coautor hace %{days_ago} d\xedas en:",tagged_you_html:"<b>%{tagger_link}</b> te ha marcado como coautor en una publicaci\xf3n.",tagged_you_text:"%{tagger_name} te ha marcado como coautor en:"},name_pending_subject:"La etiqueta del coautor de %{tagger_name} est\xe1 pendiente de aprobaci\xf3n.",view_paper:"Ver publicaci\xf3n",waiting_confirmation_subject:"La marca de coautor\xeda de %{tagger_name} espera tu confirmaci\xf3n."}},reg_path:{coauthor:{added_you:"%{tagger_name} te ha a\xf1adido como coautor:",already_have_account:"\xbfYa tienes una cuenta de Academia.edu?",approve_and_join:"Aprobar etiqueta y unirte",by_joining_you_agree_html:"Al unirte a %{tagger_name} en Academia.edu, aceptas nuestros",looking_for_papers:"Buscando m\xe1s publicaciones con tu autor\xeda",looking_for_papers_not_coauthor:"Buscando publicaciones con tu autor\xeda",sign_in_to_approve:"Inicia sesi\xf3n para aprobar",terms_of_use:"T\xe9rminos de uso",you_accepted:"\xa1Has aceptado la solicitud de %{@invitingCoauthor}! Dedica unos instantes a confirmar tus otras publicaciones.",you_accepted_no_name:"\xa1Has aceptado la solicitud de tu coautor! Dedica unos instantes a confirmar tus otras publicaciones."},combined_claim:{opt_in_checkbox:{label_text:"Incluir coautores que a\xfan no est\xe1n en Academia",popover_info_text:"Incluir coautores te permite invitarlos a Academia."}},name_only_coauthors:{coauthor_email_input:{placeholder:"Introduce una direcci\xf3n de correo electr\xf3nico"},coauthor_info:{email_confirmed:"Direcci\xf3n de correo confirmada",no_email:"No se ha encontrado ninguna direcci\xf3n de correo electr\xf3nico"},control_bar:{add_emails_for_remaining:{one:"A\xf1ade una direcci\xf3n para el coautor restante",other:"A\xf1ade direcciones para los {{count}} coautores restantes"}},header:{google_alert_message:{autofilled_x_coauthors:{one:"\xa1Se ha encontrado una direcci\xf3n de coautor!",other:"\xa1Se han encontrado {{count}} direcciones de coautor!"},clicked:"Autenticando con Google...",connected:"Conectado. Autocompletando direcciones de correo...","default":"No hemos podido confirmar los datos de contacto de algunos de los coautores",unable_to_autofill:"No hemos podido autocompletar ninguna direcci\xf3n de correo electr\xf3nico; introduce las direcciones de los coautores para que puedan acceder a tus trabajos en Academia."},google_connect_button_text:"AUTOCOMPLETAR DESDE CONTACTOS",subtitle:"Permitir a los coautores acceder a tus trabajos en Academia"}},templates:{add_tags_page:{add_research_interests_so:"A\xf1ade intereses de investigaci\xf3n para que podamos divulgar con m\xe1s amplitud tu trabajo y marcar coautores para compartir m\xe9ritos.",add_your_co_authors:"A\xf1adir a tus coautores",loading_your_papers:"Cargando tus publicaciones..."},add_tags_work:{authors:"Autores",back:"VOLVER",paper_currentcollectionindex_of_workscount1:"Publicaci\xf3n %{currentCollectionIndex} de %{worksCount1}",research_interests:"Intereses de investigaci\xf3n",title:"T\xedtulo"},cluster_review_page:{confirm_your_papers:"Confirmar tus publicaciones",confirmed:"Confirmado ",none_of_these_are:"Ninguna es m\xeda",papers_claimed_and_uploaded:'Las publicaciones reivindicadas y subidas a Academia.edu reciben un 83% m\xe1s<sup><a href="https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu" target="_blank">*</a></sup> de citas en un plazo de 5 a\xf1os.',select_all:"Seleccionar todo"},coauthor_review_page:{confirm_your_co_authors:"Confirmar a tus coautores",none_of_these_are:"Ninguno es correcto"},combined_claim_control_bar:{numcoauthors_co_authors:"%{numCoauthors} coautores",select_all:"Seleccionar todos"},combined_claim_footer:{confirm_allclaimed:"Confirmar Todo",confirm_selectedclaimed:"Confirmar Seleccionado",skip:"Omitir"},combined_claim_page:{next_page_title:"\xa1Gracias! Hemos podido encontrar a %{numCoauthors} coautores adicionales.",subtitle:"Hemos encontrado publicaciones escritas con %{numCoauthors} coautores m\xe1s. Si ambos confirman la coautor\xeda, esas publicaciones aparecer\xe1n en ambos perfiles.",title:"Confirma a tus otros coautores y publicaciones"},discover_research_follow_interest:{followers:"Seguidores"},discover_research_follow_user:{independent_researcher:"Investigador independiente"},discover_research_page:{back:"VOLVER",discover_more_research:"Descubrir m\xe1s investigaci\xf3n",find_colleagues_friends:"BUSCAR COLEGAS Y AMIGOS",follow:{one:"SEGUIR (1)",other:"SEGUIR ({{count}})"},follow_researchers_and_interests:"Sigue a investigadores e intereses para encontrar las publicaciones m\xe1s recientes en tu campo.",researchers_interests:"INVESTIGADORES E INTERESES",skip:"OMITIR"},discover_research_suggestions_none:{sorry_we_couldn_t:"Lo sentimos, no hemos encontrado ninguna sugerencia.",try_connecting_another_account:"Prueba a conectarte con otra cuenta para ayudarnos a encontrar a tus amigos, colegas e intereses de investigaci\xf3n en Academia.edu."},no_suggested_coauthors:{no_remaining_co_authors:"No hay m\xe1s coautores"},suggested_coauthor:{papers:{one:"1 publicaci\xf3n",other:"{{count}} publicaciones"}},suggested_coauthor_with_works:{show_more_papers:"Mostrar m\xe1s publicaciones",wrote_papers:{one:"%{name} escribi\xf3 1 publicaci\xf3n contigo",other:"%{name} escribi\xf3 {{count}} publicaciones contigo"}},sutd_download:{continue_to_your_profile:"CONTINUAR A TU PERFIL",your_download_is_ready:"Tu descarga est\xe1 lista para:"},upload_papers_page:{back:"VOLVER",i_don_t_have:"No tengo ninguno",save:"GUARDAR",you_can_also_drag:"Tambi\xe9n puedes arrastrar y soltar varios archivos aqu\xed."},upload_papers_paper_row:{title:"T\xedtulo"},verify_account:{enter_password:"Introduce una contrase\xf1a",google_button:"CONECTAR CON GOOGLE",hr_heading_text:"o introduce una contrase\xf1a",retype_password:"Vuelve a escribir tu contrase\xf1a",subtitle:"Con\xe9ctate con Google o introduce una contrase\xf1a para verificar tu cuenta.",verify_account:"VERIFICAR CUENTA",verify_your_account:"Verifica tu cuenta",yahoo_button:"CONECTAR CON YAHOO",yahoo_subtitle:"Con\xe9ctate con Yahoo o introduce una contrase\xf1a para verificar tu cuenta."}}},registration_path:{current_position_grid:{adjunct:"Adjunto",alumn:"Alumno",emerita_or_emeritus:"Em\xe9rito",graduate_student:"Estudiante graduado",i_m_not_a:"No soy investigador",independent_researcher:"Investigador independiente",other:"Otro",post_doc:"Postdoctoral",private_sector:"Sector privado",professor:"Profesor",undergraduate:"Estudiante de grado",what_best_describes_your:"\xbfQu\xe9 describe mejor tu puesto actual?"}},uploaded_by:"Subido por"},fr:{added_by:"Ajout\xe9 par",affiliation_editor:{company_or_institution_is_required:"Soci\xe9t\xe9 ou institution requise",department_required:"D\xe9partement requis",templates:{affiliation_edit:{adjunct:"Assistant",alumnus_alumna:"Ancien \xe9l\xe8ve",cancel:"ANNULER",company_or_institution:"Soci\xe9t\xe9 ou institution",department:"D\xe9partement",emeritus_emerita:"\xc9m\xe9rite",faculty_member:"Membre de la facult\xe9",female:"Femme",gender:"Sexe",graduate_student:"Dipl\xf4m\xe9(e)",male:"Homme",no:"Non",other:"Autres",position:"Position",post_doctorate:"En 3e cycle",primary_affiliation:"Principale affiliation",save:"ENREGISTRER",undergraduate:"\xc9tudiant(e)",university:"Universit\xe9",yes:"Oui"}},university_is_required:"Universit\xe9 requise"},department_search:{create_new:"Ou cr\xe9ez un nouveau d\xe9partement"},mailers:{coauthors:{approve_tag:"Accepter le tag",ignore_tag:"Ignorer",invite_external_coauthor:{approve_tag_text:"Pour accepter ce tag, veuillez visiter le lien ci-dessous\xa0:",click_here:"cliquer ici",if_you_dont_know:"si vous ne connaissez pas %{tagger_name}.",ignore_tag_text:"Pour ignorer cette invitation, cliquez sur ce lien :",please:"Veuillez",tagged_you_days_ago_html:"<b>%{tagger_link}</b> a indiqu\xe9 il y a %{days_ago} jours que vous \xeates co-auteur.",tagged_you_days_ago_text:"%{tagger_name} a indiqu\xe9 il y a %{days_ago} jours que vous \xeates co-auteur de :",tagged_you_html:"<b>%{tagger_link}</b> a indiqu\xe9 que vous \xeates co-auteur d'un article.",tagged_you_text:"%{tagger_name} a indiqu\xe9 que vous \xeates co-auteur de:"},name_pending_subject:"Le tag de co-auteur de %{tagger_name} attend votre accord",view_paper:"Voir l'article",waiting_confirmation_subject:"Le tag de co-auteur de %{tagger_name} attend votre confirmation"}},reg_path:{coauthor:{added_you:"%{tagger_name} vous a ajout\xe9(s) comme co-auteur de\xa0:",already_have_account:"Vous avez d\xe9j\xe0 un compte Academia.edu\xa0?",approve_and_join:"Approuver le tag et rejoindre",by_joining_you_agree_html:"En rejoignant %{tagger_name} sur Academia.edu, vous acceptez nos",looking_for_papers:"Recherche d'autres articles dont vous \xeates l'auteur en cours",looking_for_papers_not_coauthor:"Recherche d'articles dont vous \xeates l'auteur en cours",sign_in_to_approve:"Connectez-vous pour accepter",terms_of_use:"Conditions d'Utilisation",you_accepted:"Vous avez accept\xe9 la demande de %{@invitingCoauthor}\xa0! Merci de prendre quelques instants pour confirmer vos autres articles.",you_accepted_no_name:"Vous avez accept\xe9 une demande de co-auteur\xa0! Merci de prendre quelques instants pour confirmer vos autres articles."},combined_claim:{opt_in_checkbox:{label_text:"Inclure les co-auteurs non encore inscrits sur Academia",popover_info_text:"Inclure les co-auteurs vous permet de les inviter \xe0 rejoindre Academia."}},name_only_coauthors:{coauthor_email_input:{placeholder:"Saisissez une adresse e-mail"},coauthor_info:{email_confirmed:"E-mail confirm\xe9",no_email:"Aucun e-mail trouv\xe9"},control_bar:{add_emails_for_remaining:{one:"Ajoutez un e-mail pour le co-auteur restant",other:"Ajoutez un e-mail pour les {{count}} co-auteurs restants"}},header:{google_alert_message:{autofilled_x_coauthors:{one:"1 co-auteur trouv\xe9\xa0!",other:"{{count}} co-auteurs trouv\xe9s\xa0!"},clicked:"Authentification avec Google",connected:"Connect\xe9. Population des e-mails...","default":"Nous n'avons pas pu confirmer les informations de contact de certains de vos co-auteurs",unable_to_autofill:"Nous n'avons pas pu peupler les e-mails."},google_connect_button_text:"PEUPLER DEPUIS LES CONTACTS",subtitle:"Permettez \xe0 vos co-auteurs d'acc\xe9der \xe0 vos travaux sur Academia"}},templates:{add_tags_page:{add_research_interests_so:"Ajoutez des int\xe9r\xeats de recherche pour que nous puissions distribuer vos travaux plus largement et identifiez vos co-auteurs pour partager le m\xe9rite.",add_your_co_authors:"Ajouter vos co-auteurs",loading_your_papers:"Chargement de vos articles..."},add_tags_work:{authors:"Auteurs",back:"RETOUR",paper_currentcollectionindex_of_workscount1:"Article %{currentCollectionIndex} sur %{worksCount1}",research_interests:"Int\xe9r\xeats de recherche",title:"Titre"},cluster_review_page:{confirm_your_papers:"Confirmer vos articles",confirmed:"Confirm\xe9 ",none_of_these_are:"Aucun n'est \xe0 moi",papers_claimed_and_uploaded:'Les articles que vous dites avoir r\xe9dig\xe9s ou que vous chargez sur Academia.edu re\xe7oivent 83\xa0% de citations en plus<sup><a href="https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu" target="_blank">*</a></sup> sur 5 ans.',select_all:"Tout s\xe9lectionner"},coauthor_review_page:{confirm_your_co_authors:"Confirmer vos co-auteurs",none_of_these_are:"Aucun n'est correct"},combined_claim_control_bar:{numcoauthors_co_authors:"%{numCoauthors} co-auteurs",select_all:"Tout s\xe9lectionner"},combined_claim_footer:{confirm_allclaimed:"Confirmer Tout",confirm_selectedclaimed:"Confirmer le tag s\xe9lectionn\xe9",skip:"Passer"},combined_claim_page:{next_page_title:"Merci ! Nous avons trouv\xe9 %{numCoauthors} co-auteurs suppl\xe9mentaires",subtitle:"Nous avons trouv\xe9 des articles que vous avez r\xe9dig\xe9s avec %{numCoauthors} autres co-auteurs. Si vous confirmez tous les articles, ils appara\xeetront sur tous vos profils.",title:"Confirmer vos autres co-auteurs et articles"},discover_research_follow_interest:{followers:"Abonn\xe9s"},discover_research_follow_user:{independent_researcher:"Chercheur ind\xe9pendant"},discover_research_page:{back:"RETOUR",discover_more_research:"D\xe9couvrir plus de recherches",find_colleagues_friends:"TROUVER DES COLL\xc8GUES ET DES AMIS",follow:{one:"SUIVRE (1)",other:"SUIVRE ({{count}})"},follow_researchers_and_interests:"Suivez des chercheurs et des int\xe9r\xeats pour d\xe9couvrir les derniers articles dans votre domaine.",researchers_interests:"CHERCHEURS ET INT\xc9R\xcaTS",skip:"PASSER"},discover_research_suggestions_none:{sorry_we_couldn_t:"Malheureusement, nous n'avons aucune suggestion pour vous.",try_connecting_another_account:"Essayez de connecter un autre compte pour nous aider \xe0 trouver vos amis, vos coll\xe8gues et vos int\xe9r\xeats de recherche sur Academia.edu."},no_suggested_coauthors:{no_remaining_co_authors:"Aucun co-auteur restant"},suggested_coauthor:{papers:{one:"1 article",other:"{{count}} articles"}},suggested_coauthor_with_works:{show_more_papers:"Montrer plus d'articles",wrote_papers:{one:"%{name} a r\xe9dig\xe9 1 article avec vous",other:"%{name} a r\xe9dig\xe9 {{count}} articles avec vous"}},sutd_download:{continue_to_your_profile:"CONTINUER VERS VOTRE PROFIL",your_download_is_ready:"Votre t\xe9l\xe9chargement est pr\xeat pour\xa0:"},upload_papers_page:{back:"RETOUR",i_don_t_have:"Aucun",save:"ENREGISTRER",you_can_also_drag:"Vous pouvez aussi faire glisser plusieurs fichiers ici."},upload_papers_paper_row:{title:"Titre"},verify_account:{enter_password:"Saisissez un mot de passe",google_button:"CONNEXION AVEC GOOGLE",hr_heading_text:"ou saisissez un mot de passe",retype_password:"R\xe9p\xe9tez le mot de passe",subtitle:"Connectez-vous avec Google ou saisissez un mot de passe pour v\xe9rifier votre compte.",verify_account:"V\xc9RIFIER LE COMPTE",verify_your_account:"V\xe9rifiez votre compte",yahoo_button:"CONNEXION AVEC YAHOO",yahoo_subtitle:"Connectez-vous avec Yahoo ou saisissez un mot de passe pour v\xe9rifier votre compte."}}},registration_path:{current_position_grid:{adjunct:"Assistant",alumn:"Ancien \xe9l\xe8ve",emerita_or_emeritus:"\xc9m\xe9rite",graduate_student:"Dipl\xf4m\xe9(e)",i_m_not_a:"Je ne suis pas chercheur",independent_researcher:"Chercheur ind\xe9pendant",other:"Autres",post_doc:"En 3e cycle",private_sector:"Secteur priv\xe9",professor:"Professeur",undergraduate:"\xc9tudiant(e)",what_best_describes_your:"Quelle est votre poste actuellement\xa0?"}},uploaded_by:"T\xe9l\xe9charg\xe9 par"},id:{mailers:{external_mailer:{related_papers_nag:{downloaded_paper_body:"Ini adalah makalah yang Anda unduh di Academia.edu pada tanggal %{download_date}.",from:"%{recipient} di Academia",salutation:"Hai %{recipient},",subject:"Unduhan saya",view_paper_button:"LIHAT MAKALAH"}}}},it:{added_by:"Aggiunto da",affiliation_editor:{company_or_institution_is_required:"La societ\xe0 o l'istituzione sono obbligatori",department_required:"Il dipartimento \xe8 obbligatorio",templates:{affiliation_edit:{adjunct:"Assistente",alumnus_alumna:"Alunno",cancel:"ANNULLA",company_or_institution:"Societ\xe0 o istituzione",department:"Dipartimento",emeritus_emerita:"Emerito",faculty_member:"Membro di facolt\xe0",female:"Donna",gender:"Sesso",graduate_student:"Studente laureato",male:"Uomo",no:"No",other:"Altro",position:"Posizione",post_doctorate:"Post Dottorato",primary_affiliation:"Affiliazione principale",save:"SALVA",undergraduate:"Studente universitario",university:"Universit\xe0",yes:"S\xec"}},university_is_required:"L'universit\xe0 \xe8 obbligatoria"},department_search:{create_new:"O crea un nuovo dipartimento..."},mailers:{coauthors:{approve_tag:"Accetta tag",ignore_tag:"Ignora",invite_external_coauthor:{approve_tag_text:"Per accettare questa tag, visita il link in basso:",click_here:"clicca qui",if_you_dont_know:"se non conosci %{tagger_name}.",ignore_tag_text:"Per ignorare questo invito, collegati all'indirizzo seguente:",please:"Per favore",tagged_you_days_ago_html:"<b>%{tagger_link}</b> ti ha taggato come co-autore %{days_ago} giorni fa.",tagged_you_days_ago_text:"%{tagger_name}ti ha taggato come co-autore %{days_ago} giorni fa, il:",tagged_you_html:"<b>%{tagger_link}</b> ti ha taggato come co-autore di un documento.",tagged_you_text:"%{tagger_name} ti ha taggato come co-autore di:"},name_pending_subject:"La tag del co-autore di %{tagger_name} \xe8 in attesa della tua approvazione",view_paper:"Visualizza il documento",waiting_confirmation_subject:"La tag come co-autore aggiunta da %{tagger_name} \xe8 in attesa della tua conferma"}},reg_path:{coauthor:{added_you:"%{tagger_name} ti ha taggato come co-autore:",already_have_account:"Possiedi gi\xe0 un account di Academia.edu?",approve_and_join:"Approva tag e unisciti",by_joining_you_agree_html:"Unendoti a %{tagger_name} su Academia.edu, acconsenti alle",looking_for_papers:"Ricerca degli altri documenti di cui sei autore",looking_for_papers_not_coauthor:"Ricerca dei documenti di cui sei autore",sign_in_to_approve:"Accedi per approvare",terms_of_use:"condizioni di utilizzo",you_accepted:"Hai accettato la richiesta di %{@invitingCoauthor}! Dedica un minuto a confermare i tuoi altri documenti",you_accepted_no_name:"Hai accettato la richiesta del tuo co-autore! Dedica un minuto a confermare i tuoi altri documenti"},combined_claim:{opt_in_checkbox:{label_text:"Includi co-autori che non usano ancora Academia",popover_info_text:"Includendo i co-autori, puoi invitarli ad usare Academia."}},name_only_coauthors:{coauthor_email_input:{placeholder:"Inserisci un indirizzo e-mail"},coauthor_info:{email_confirmed:"E-mail confermata",no_email:"Nessuna e-mail trovata"},control_bar:{add_emails_for_remaining:{one:"Aggiungi l'e-mail dell'altro co-autore",other:"Aggiungi l'indirizzo e-mail degli altri {{count}} autori"}},header:{google_alert_message:{autofilled_x_coauthors:{one:"1 indirizzo email di co-autore trovato!",other:"{{count}} indirizzi email di co-autori trovati!"},clicked:"Autenticazione con Google in corso...",connected:"Connesso. Riempimento email automatico...","default":"Non siamo riusciti a confermare i dettagli di contatto di alcuni tuoi co-autori",unable_to_autofill:"Non abbiamo potuto riempire automaticamente alcuna email. Inserisci le email dei tuoi co-autori per consentire loro di accedere ai tuoi lavori su Academia."},google_connect_button_text:"RIEMPI AUTOMATICAMENTE DAI CONTATTI",subtitle:"Permetti ai tuoi co-autori di accedere ai tuoi lavori su Academia"}},templates:{add_tags_page:{add_research_interests_so:"Aggiungi interessi di ricerca in modo da permetterci di distribuire il tuo lavoro in maniera pi\xf9 ampia e di taggare co-autori per condividere i crediti.",add_your_co_authors:"Aggiungi i tuoi co-autori",loading_your_papers:"Caricamento dei tuoi documenti in corso..."},add_tags_work:{authors:"Autori",back:"INDIETRO",paper_currentcollectionindex_of_workscount1:"Documento %{currentCollectionIndex} di %{worksCount1}",research_interests:"Interessi della ricerca",title:"Titolo"},cluster_review_page:{confirm_your_papers:"Conferma i tuoi documenti",confirmed:"Confermato/i ",none_of_these_are:"Nessuno di questi \xe8 mio",papers_claimed_and_uploaded:'I documenti rivendicati e caricati su Academia.edu ricevono l\'83% in pi\xf9 <sup><a href="https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu" target="_blank">*</a></sup> di citazioni nell\'arco di 5 anni.',select_all:"Seleziona tutto"},coauthor_review_page:{confirm_your_co_authors:"Conferma i tuoi co-autori",none_of_these_are:"Nessuno di questi \xe8 corretto"},combined_claim_control_bar:{numcoauthors_co_authors:"%{numCoauthors} co-autori",select_all:"Seleziona tutti"},combined_claim_footer:{confirm_allclaimed:"Conferma Tutti",confirm_selectedclaimed:"Conferma Selezionati",skip:"Salta"},combined_claim_page:{next_page_title:"Grazie! Abbiamo trovato altri %{numCoauthors} co-autori",subtitle:"Abbiamo trovato documenti scritti da te insieme ad altri %{numCoauthors} co-autori. Se entrambi confermate la collaborazione, i documenti scritti insieme saranno inclusi in entrambi i profili.",title:"Conferma i tuoi co-autori e i tuoi documenti"},discover_research_follow_interest:{followers:"Seguaci"},discover_research_follow_user:{independent_researcher:"Ricercatore indipendente"},discover_research_page:{back:" INDIETRO",discover_more_research:"Scopri altre ricerche",find_colleagues_friends:"TROVA COLLEGHI E AMICI",follow:{one:"SEGUI (1)",other:"SEGUI ({{count}})"},follow_researchers_and_interests:"Segui ricercatori ed interessi per trovare gli ultimi documenti nel tuo campo.",researchers_interests:"RICERCATORI ED INTERESSI",skip:"SALTA"},discover_research_suggestions_none:{sorry_we_couldn_t:"Siamo spiacenti, non abbiamo trovato alcuna proposta per te.",try_connecting_another_account:"Prova a collegarti ad un altro account per assisterci nella ricerca dei tuoi amici, colleghi ed interessi di ricerca su Academia.edu."},no_suggested_coauthors:{no_remaining_co_authors:"Nessun co-autore rimasto"},suggested_coauthor:{papers:{one:"1 documento",other:"{{count}} documenti"}},suggested_coauthor_with_works:{show_more_papers:"Mostra altri documenti",wrote_papers:{one:"%{name} ha scritto 1 documento con te",other:"%{name} ha scritto {{count}} documenti con te"}},sutd_download:{continue_to_your_profile:"CONTINUA PER ACCEDERE AL TUO PROFILO",your_download_is_ready:"Il tuo download \xe8 pronto per:"},upload_papers_page:{back:"INDIETRO",i_don_t_have:"Non ne ho",save:"SALVA",you_can_also_drag:"Puoi anche trascinare e rilasciare qui pi\xf9 file."},upload_papers_paper_row:{title:"Titolo"},verify_account:{enter_password:"Inserisci una password",google_button:"COLLEGATI CON GOOGLE",hr_heading_text:"o inserisci una password",retype_password:"Digita nuovamente la tua password",subtitle:"Collegati con Google oppure inserisci una password per verificare il tuo account.",verify_account:"VERIFICA IL TUO ACCOUNT",verify_your_account:"Verifica il tuo account",yahoo_button:"COLLEGATI CON YAHOO",yahoo_subtitle:"Collegati con Yahoo oppure inserisci una password per verificare il tuo account."}}},registration_path:{current_position_grid:{adjunct:"Assistente",alumn:"Alunno",emerita_or_emeritus:"Emerito",graduate_student:"Studente laureato",i_m_not_a:"Non sono un ricercatore",independent_researcher:"Ricercatore indipendente",other:"Altro",post_doc:"Post dottorato",private_sector:"Settore privato",professor:"Professore",undergraduate:"Studente universitario",what_best_describes_your:"Come descriveresti al meglio il tuo ruolo attuale?"}},uploaded_by:"Caricato da"},pt:{added_by:"Adicionado por",affiliation_editor:{company_or_institution_is_required:"O nome da Empresa ou Institui\xe7\xe3o \xe9 obrigat\xf3rio",department_required:"O nome do Departamento \xe9 obrigat\xf3rio",templates:{affiliation_edit:{adjunct:"Adjunto",alumnus_alumna:"Ex-aluno",cancel:"CANCELAR",company_or_institution:"Empresa ou Institui\xe7\xe3o",department:"Departamento",emeritus_emerita:"Jubilado",faculty_member:"Membro do corpo docente",female:"Feminino",gender:"Sexo",graduate_student:"Aluno de p\xf3s-gradua\xe7\xe3o",male:"Masculino",no:"N\xe3o",other:"Outros",position:"Posi\xe7\xe3o",post_doctorate:"P\xf3s-doutorado",primary_affiliation:"Afilia\xe7\xe3o principal",save:"SALVAR",undergraduate:"Aluno de gradua\xe7\xe3o",university:"Universidade",yes:"Sim"}},university_is_required:"O nome da Universidade \xe9 obrigat\xf3rio"},department_search:{create_new:"Ou crie um novo departamento..."},mailers:{coauthors:{approve_tag:"Aceitar Marca\xe7\xe3o",ignore_tag:"Ignorar",invite_external_coauthor:{approve_tag_text:"Para aceitar esta marca\xe7\xe3o, por favor, acesse o link abaixo:",click_here:"clique aqui",if_you_dont_know:"se voc\xea n\xe3o conhece o(a) %{tagger_name}.",ignore_tag_text:"Para ignorar este convite, acesse o link:",please:"Por favor,",tagged_you_days_ago_html:"<b>%{tagger_link}</b> marcou voc\xea como coautor %{days_ago} dias atr\xe1s.",tagged_you_days_ago_text:"%{tagger_name} marcou voc\xea como coautor %{days_ago}dias atr\xe1s em:",tagged_you_html:"<b>%{tagger_link}</b> marcou voc\xea como um coautor em um artigo.",tagged_you_text:"%{tagger_name} marcou voc\xea como um coautor em:"},name_pending_subject:"A marca\xe7\xe3o de coautoria de %{tagger_name} est\xe1 aguardando a sua aprova\xe7\xe3o",view_paper:"Ver artigo",waiting_confirmation_subject:"A marca\xe7\xe3o de coautoria de %{tagger_name} est\xe1 aguardando a sua confirma\xe7\xe3o"}},reg_path:{coauthor:{added_you:"%{tagger_name} adicionou voc\xea como coautor:",already_have_account:"J\xe1 tem uma conta da Academia.edu?",approve_and_join:"Aprove a marca\xe7\xe3o e participe",by_joining_you_agree_html:"Ao juntar-se a %{tagger_name} na Academia.edu, voc\xea concorda com os nossos",looking_for_papers:"Procurando mais artigos de sua autoria",looking_for_papers_not_coauthor:"Procurando artigos de sua autoria",sign_in_to_approve:"Entre para aprovar",terms_of_use:"Termos de Uso",you_accepted:"Voc\xea aceitou o pedido do(a) %{@invitingCoauthor}! Por favor, pare um instante para confirmar seus outros artigos.",you_accepted_no_name:"Voc\xea aceitou o pedido de coautoria! Por favor, pare um instante para confirmar seus outros artigos."},combined_claim:{opt_in_checkbox:{label_text:"Inclua coautores que ainda n\xe3o est\xe3o no site Academia",popover_info_text:"A inclus\xe3o de coautores permite que voc\xea os convide para o site Academia."}},name_only_coauthors:{coauthor_email_input:{placeholder:"Digite um endere\xe7o de e-mail"},coauthor_info:{email_confirmed:"E-mail confirmado",no_email:"Nenhum e-mail encontrado"},control_bar:{add_emails_for_remaining:{one:"Adicione o e-mail do coautor restante",other:"Adicione os e-mails dos\xa0{{count}}\xa0coautores restantes"}},header:{google_alert_message:{autofilled_x_coauthors:{one:"1 e-mail de coautor encontrado!",other:"{{count}}\xa0e-mails de coautores encontrados!"},clicked:"Autenticando junto ao Google...",connected:"Conectado. Preenchendo automaticamente os e-mails...","default":"N\xe3o foi poss\xedvel confirmar os detalhes de contato de alguns de seus coautores",unable_to_autofill:"N\xe3o foi poss\xedvel preencher automaticamente nenhum e-mail. Por favor, digite os e-mails de seus coautores para permitir que eles acessem seus trabalhos no site Academia."},google_connect_button_text:"PREENCHER AUTOMATICAMENTE A PARTIR DOS CONTATOS",subtitle:"Permita que seus coautores acessem seus trabalhos no site Academia"}},templates:{add_tags_page:{add_research_interests_so:"Adicione interesses de pesquisa para que possamos distribuir seu trabalho mais amplamente e marque os coautores para compartilhar o cr\xe9dito.",add_your_co_authors:"Adicione seus coautores",loading_your_papers:"Carregando seus artigos..."},add_tags_work:{authors:"Autores",back:"VOLTAR",paper_currentcollectionindex_of_workscount1:"Artigo %{currentCollectionIndex} de %{worksCount1}",research_interests:"Interesses de pesquisa",title:"T\xedtulo"},cluster_review_page:{confirm_your_papers:"Confirme seus artigos",confirmed:"Confirmados ",none_of_these_are:"Nenhum desses \xe9 meu",papers_claimed_and_uploaded:'Artigos reivindicados e carregados no Academia.edu recebem 83% mais <sup><a href="https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu" target="_blank"></a></sup> cita\xe7\xf5es ao longo de 5 anos.',select_all:"Selecionar todos"},coauthor_review_page:{confirm_your_co_authors:"Confirme seus coautores",none_of_these_are:"Nenhum destes est\xe1 correto"},combined_claim_control_bar:{numcoauthors_co_authors:"%{numCoauthors} coautores",select_all:"Selecionar todos"},combined_claim_footer:{confirm_allclaimed:"Confirmar Todos",confirm_selectedclaimed:"Confirmar item selecionado",skip:"Pular"},combined_claim_page:{next_page_title:"Obrigado! Conseguimos encontrar %{numCoauthors} coautores adicionais",subtitle:"Encontramos artigos que voc\xea escreveu com mais %{numCoauthors} coautores. Se ambos confirmarem autoria, os artigos desenvolvidos em conjunto aparecer\xe3o em ambos os perfis.",title:"Confirme seus outros coautores e artigos"},discover_research_follow_interest:{followers:"Seguidores"},discover_research_follow_user:{independent_researcher:"Pesquisador independente"},discover_research_page:{back:"VOLTAR",discover_more_research:"Descubra mais pesquisas",find_colleagues_friends:"ENCONTRE COLEGAS E AMIGOS",follow:{one:"SEGUIR (1)",other:"SEGUIR ({{count}})"},follow_researchers_and_interests:"Siga pesquisadores e interesses para encontrar os mais recentes artigos na sua \xe1rea.",researchers_interests:"PESQUISADORES E INTERESSES",skip:"PULAR"},discover_research_suggestions_none:{sorry_we_couldn_t:"Desculpe, n\xe3o conseguimos encontrar nenhuma sugest\xe3o para voc\xea.",try_connecting_another_account:"Tente conectar com outra conta para nos ajudar a encontrar seus amigos, colegas e interesses de pesquisa em Academia.edu."},no_suggested_coauthors:{no_remaining_co_authors:"Nenhum coautor restante"},suggested_coauthor:{papers:{one:"1 artigo",other:"{{count}} artigos"}},suggested_coauthor_with_works:{show_more_papers:"Mostrar mais artigos",wrote_papers:{one:"%{name} escreveu 1 artigo com voc\xea",other:"%{name} escreveu {{count}} artigos com voc\xea"}},sutd_download:{continue_to_your_profile:"CONTINUAR PARA O SEU PERFIL",your_download_is_ready:"Seu download est\xe1 pronto para:"},upload_papers_page:{back:"VOLTAR",i_don_t_have:"N\xe3o tenho nenhum",save:"SALVAR",you_can_also_drag:"Voc\xea tamb\xe9m pode arrastar e soltar v\xe1rios arquivos aqui."},upload_papers_paper_row:{title:"T\xedtulo"},verify_account:{enter_password:"Insira uma senha",google_button:"CONECTAR COM O GOOGLE",hr_heading_text:"ou insira uma senha",retype_password:"Reinsira a sua senha",subtitle:"Conecte-se com o Google ou insira uma senha para verificar a sua conta.",verify_account:"VERIFICAR CONTA",verify_your_account:"Verifique a sua conta",yahoo_button:"CONECTAR COM O YAHOO",yahoo_subtitle:"Conecte-se com o Yahoo ou insira uma senha para verificar a sua conta."}}},registration_path:{current_position_grid:{adjunct:"Adjunto",alumn:"Ex-aluno",emerita_or_emeritus:"Jubilado",graduate_student:"Aluno de p\xf3s-gradua\xe7\xe3o",i_m_not_a:"N\xe3o sou pesquisador",independent_researcher:"Pesquisador independente",other:"Outros",post_doc:"Aluno de p\xf3s-doutorado",private_sector:"Setor privado",professor:"Professor",undergraduate:"Aluno de gradua\xe7\xe3o",what_best_describes_your:"Quais das op\xe7\xf5es melhor descreve sua posi\xe7\xe3o atual?"}},uploaded_by:"Carregado por"}}
}),function(){"use strict";var e=function(e){var t=this;t.mainContainer=null,t.selector=null,t.settings=$.extend({elements:"[data-scroll-scope]",forcedElements:'[data-scroll-scope="force"]',events:"DOMMouseScroll mousewheel scroll touchstart touchmove"},e&&(e.elements||e.forcedElements||e.events)?e:{}),t.getTargetedElements=function(){return t.mainContainer.find(t.selector)},t.getSelector=function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&e[n].length&&t.push(e[n]);return t.length?t.join(", "):null},t.normalizeJqueryObject=function(e){return e?e instanceof jQuery?e:$(e):null},t.killScrolling=function(e,t){return t||"touchmove"!==e.type&&"touchstart"!==e.type?(e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1):void 0},t.onScroll=function(e){if(e.isLegitScroll)return!0;var n=$(this),i=t.settings.forcedElements&&n.is(t.settings.forcedElements),o=this.scrollHeight,r=n.outerHeight(),s=o-r-this.scrollTop;if(r>=o)return i&&"touchstart"!==e.type?t.killScrolling(e,i):!0;var a=e.originalEvent.wheelDelta;i&&"undefined"==typeof a&&"touchstart"===e.type&&(this.scrollTop<=0?n.scrollTop(1):0>=s&&n.scrollTop(o-r-1));var c=a>0;return!c&&-a>s?(n.scrollTop(this.scrollHeight),t.killScrolling(e,i)):c&&a>this.scrollTop?(n.scrollTop(0),t.killScrolling(e,i)):(e.isLegitScroll=!0,!0)},t.unbind=function(){return t.mainContainer&&t.mainContainer.off(t.settings.events,t.selector,t.onScroll),t},t.bind=function(e){return e=t.normalizeJqueryObject(e),e&&t.unbind(),t.mainContainer=e,t.mainContainer.on(t.settings.events,t.selector,t.onScroll),t},t.settings.elements=t.getSelector([t.settings.elements]),t.settings.forcedElements=t.getSelector([t.settings.forcedElements]),t.selector=t.getSelector([t.settings.elements,t.settings.forcedElements])};"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:(window.ScrollScope=e,jQuery&&!function(t){t.fn.scrollScope=function(t){var n=new e(t);return n.bind(this),n.mainContainer}}(jQuery))}();